查询支付
==========

2022-12-01 08:40

POST /v1/payments/inquiryPayment

此API用于查询支付状态。

使用**inquiryPayment** API查询先前提交的支付请求的信息，或接受支付的异步处理结果。

结构
====

消息由头部和主体组成。以下部分专注于主体结构。头部结构请参考：

*   [请求头](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [响应头](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)

**注意**：除数组外，每个字段的数据类型应设置为String。这意味着字段值必须用双引号（" "）括起来。例如：

*   如果字段的数据类型是Integer，其值为20，应设置为"20"。
*   如果字段的数据类型是Boolean，其值为true，应设置为"true"。

### 请求参数

#### paymentRequestId 字符串

商家为支付请求分配的唯一标识。_paymentRequestId_ 和 _paymentId_ 不能都为 null。如果同时指定了 _paymentRequestId_ 和 _paymentId_，_paymentId_ 优先。

关于此字段的更多信息：

*   最大长度：64 个字符

#### paymentId 字符串 

支付宝为支付分配的唯一标识。_paymentRequestId_ 和 _paymentId_ 不能都为 null。_paymentId_ 与 _paymentRequestId_ 之间存在一对一对应关系。如果同时指定了 _paymentRequestId_ 和 _paymentId_，_paymentId_ 优先。

关于此字段的更多信息：

*   最大长度：64 个字符

### 响应参数

显示全部

#### result Result 对象 

请求结果包含状态和错误代码等信息。

注意：此字段不表示支付结果。此字段仅表示调用 inquiryPayment 接口是否成功。

显示子参数

#### 支付状态 String

表示支付宝支付的最终状态。有效值包括：

*   `SUCCESS`：表示交易成功。
*   `FAIL`：表示交易失败。
*   `PROCESSING`：表示交易处理中。
*   `CANCELLED`：表示交易已取消。

#### 支付结果码 String

支付结果代码

关于此字段的更多信息：

*   最大长度：64 个字符

#### 支付结果信息 String

支付结果信息

关于此字段的更多信息：

*   最大长度：256 个字符

#### 支付请求ID String

商家为标识支付请求而分配的唯一ID。

关于此字段的更多信息：

*   最大长度：64 个字符

#### 支付ID String

支付宝为标识支付分配的唯一ID。

关于此字段的更多信息：

*   最大长度：64 个字符

#### 支付金额 Amount 对象 必需

商家在订单中请求接收的支付金额，以订单货币表示。

显示子参数

#### authExpiryTime Datetime 

授权过期时间。

关于此字段的更多信息：

*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。

#### paymentCreateTime Datetime 

支付创建的时间。

关于此字段的更多信息：

*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。

#### paymentTime Datetime 

支付达到最终成功或失败状态的日期和时间。

关于此字段的更多信息：

*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。

#### pspCustomerInfo PspCustomerInfo 对象

客户信息在支付宝+多渠道支付系统中的应用

注意：支付宝+多渠道支付（MPP）是指参与支付宝+核心服务或其他与蚂蚁集团成员合作，为用户提供或发行方提供支付服务的移动支付伙伴。

显示子参数

#### redirectActionForm RedirectActionForm 对象

提供有关重定向操作的信息。

显示子参数

#### transactions Array<Transaction> 对象

交易的相关信息。

关于此字段的更多信息：

*   最大尺寸：无限制

显示子参数

#### grossSettlementAmount Amount 对象

总结算金额，等于交易金额乘以_settlementQuote_的值。

注意：当结算货币与交易货币相同时，此字段为空。

显示子参数

#### settlementQuote Quote 对象

交易时的结算货币与交易货币之间的汇率，仅在锁定汇率的情况下提供。

注意：当结算货币与交易货币相同时，此字段为空。

显示子参数

API 探索器

### 请求

URL

北美地区

https://open-na-global.alipay.com/ams/api/v1/payments/inquiryPayment

请求体

复制

1

2

3

{
"paymentId": "2019060811401080010018882020035XXXX"
}

请注意，这里没有提供嵌套的markdown语法，也没有JSON键需要翻译。提供的代码片段是一个JSON对象，包含一个键"paymentId"和对应的值。在翻译过程中，已保留所有空白行以保持markdown格式正确，并确保语句通顺。

### 响应

情况

成功的支付

响应体

复制

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

{  
"result": {  
"resultCode": "SUCCESS",  
"resultStatus": "S",  
"resultMessage": "成功"  
},  
"paymentStatus": "SUCCESS",  
"paymentRequestId": "pay\_1089760038715669\_10277574507XXXX",  
"paymentId": "2019060811401080010018882020035XXXX",  
"paymentAmount": {  
"value": "500",  
"currency": "USD"  
},  
"paymentCreateTime": "2019-06-01T12:01:01+08:30",  
}

请注意，JSON键未翻译，以保持原始数据的完整性。翻译已按照markdown格式要求完成，保留了空白行，并确保语句通顺。

"paymentTime": "2099-06-01T12:01:01+08:30",
"transactions": null

请注意，这是一个JSON对象，包含两个键值对：
1. "paymentTime"：表示支付时间，值为 "2019-06-01T12:01:01+08:30"，这是一个遵循ISO 8601标准的日期时间格式，表示的是北京时间2019年6月1日中午12点01分01秒。
2. "transactions"：表示交易记录，值为 "null"，意味着在这个例子中没有具体的交易信息。

更多信息
-----------------

本节提供有关关键参数的额外信息。请参阅以下详细列表：

*   **支付时间（paymentTime）**:
    支付宝成功执行支付的时间，即支付达到最终成功或失败状态的日期和时间。此值用作后续可撤销和可退款时间的起始时间。例如，如果退款期限为6个月，那么接受退款的最终截止时间为 _paymentTime_ 加上6个月。
*   **支付ID（paymentId）**:
    唯一的支付处理ID。对于轮询同一笔支付，此字段必须唯一；对于轮询不同的支付，此字段必须不同。此值可用于进一步的操作，如查询、取消或退款。
*   **支付请求ID（paymentRequestId）** 或 **支付ID（paymentId）**:
    决定何时使用 _paymentRequestId_ 或 _paymentId_，遵循以下规则：

    *   如果调用 **pay** 接口成功，商家可以使用 _paymentId_ 或 _paymentRequestId_ 查询原始支付。
    *   如果调用 **pay** 接口返回未知异常或超时，商家只能使用 _paymentRequestId_ 查询支付结果。
    *   如果调用 **cancel** 接口返回未知异常或超时，商家可以使用原始支付的 _paymentId_ 或 _paymentRequestId_ 查询取消结果。
    *   如果调用退款接口返回未知异常或超时，商家可以使用原始支付的 _paymentId_ 或 _paymentRequestId_ 查询退款结果。但不支持使用 _refundRequestId_。

结果处理逻辑
------------------

对于不同的请求结果，需要执行不同的操作。详细信息如下：

*   如果`_result.resultStatus_`的值为`S`，则支付结果查询成功。
*   如果`_result.resultStatus_`的值为`F`，则支付查询失败。
*   如果`_result.resultStatus_`的值为`U`，请求结果未知。使用相同的请求参数重试查询请求。

### 结果/错误代码

| 代码 | 值 | 消息 | 进一步操作 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 接口调用成功。通过`paymentStatus`获取订单状态。 |
| ORDER\_NOT\_EXIST | F | 订单不存在。 | 检查`paymentId`是否正确。 |
| CLIENT\_INVALID | F | 客户端无效。 | 检查`clientId`是否正确。 |
| METHOD\_NOT\_SUPPORTED | F | 服务器未实现请求的HTTP方法。 | 检查HTTP方法是否正确。 |
| MEDIA\_TYPE\_NOT\_ACCEPTABLE | F | 服务器不支持客户端可接受的媒体类型。 | 检查媒体类型是否正确。 |

| 错误代码 | 状态码 | 错误信息 | 处理建议 |
| --- | --- | --- | --- |
| USER\_KYC\_NOT\_QUALIFIED | F | 由于用户的KYC状态导致支付失败。用户可能未完成KYC认证，或者KYC状态不满足此交易要求（例如，支付金额限制或产品信息限制）。 | 提示用户完成KYC认证。 |

要查看文档的最新更新，请访问[发行说明](https://global.alipay.com/docs/releasenotes)。

![图片3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 支付宝 [法律信息](https://global.alipay.com/docs/ac/platform/membership)

#### 这个页面是否有帮助？