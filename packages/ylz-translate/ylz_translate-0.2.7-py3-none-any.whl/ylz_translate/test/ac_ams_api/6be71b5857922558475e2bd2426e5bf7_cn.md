查询支付 | 产品API | 支付宝文档
==================

[![图片1：中国领先的第三方在线支付解决方案 - 支付宝](./img_m_a52690f40beef33d7d37f1bda6f48c27.svg)![图片2：中国领先的第三方在线支付解决方案 - 支付宝](./img_m_d70d46fd32b98952674df01c03131d87.svg)](/docs/)

[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Fpaymentri_online)

[返回首页](../../)

产品API

[支付宝API](/docs/ac/ams/api)

在线支付

授权

安全存储

支付

[咨询（结账支付）](/docs/ac/ams/consult)

[pay（结账支付）](/docs/ac/ams/payment_cashier)

[createPaymentSession（结账支付）](/docs/ac/ams/session_cashier)

[capture（结账支付）](/docs/ac/ams/capture)

[pay（自动扣款）](/docs/ac/ams/payment_agreement)

创建支付会话 (EasySafePay)
==========================

[通知支付](/docs/ac/ams/paymentrn_online)

[通知捕获 (结账支付)](/docs/ac/ams/notify_capture)

[查询支付](/docs/ac/ams/paymentri_online)

[取消支付](/docs/ac/ams/paymentc_online)

订阅
----

争议
----

退款
----

申报
----

店内支付
-------

查询支付
========

2024-05-22 08:45

POST /v1/payments/inquiryPayment

使用此API查询先前提交的支付请求的交易状态和其他信息。

结构
====

消息由头部和主体组成。以下部分专注于主体结构。头部结构请参阅：

*   [请求头](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [响应头](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)

**注意**: 除数组外，每个字段的数据类型应设置为字符串。这意味着字段值必须用双引号（" "）括起来。例如：

*   如果字段的数据类型是整数，其值为20，应设置为"20"。
*   如果字段的数据类型是布尔值，其值为true，应设置为"true"。

### 请求参数

#### paymentRequestId 字符串

商家为标识支付请求分配的唯一ID。_paymentRequestId_ 和 _paymentId_ 不能都为null。如果同时指定了 _paymentRequestId_ 和 _paymentId_，则 _paymentId_ 优先。

关于此字段的更多信息：

*   最大长度：64个字符

#### paymentId 字符串

支付宝为标识支付分配的唯一ID。_paymentRequestId_ 和 _paymentId_ 不能都为null。_paymentId_ 与 _paymentRequestId_ 之间存在一对一的对应关系。如果同时指定了 _paymentRequestId_ 和 _paymentId_，则 _paymentId_ 优先。

更多关于此字段的信息

*   最大长度：64 个字符

#### merchantAccountId 字符串

用于唯一标识商家账户的ID。

当您在多个地点使用同一个客户端ID时，需要指定此参数。

更多关于此字段的信息

*   最大长度：32 个字符

### 响应参数

显示全部

#### result Result 对象 **必需**

请求调用结果的信息。

注意：此字段不表示支付结果。它仅表示`inquiryPayment`接口是否调用成功。

显示子参数

#### paymentStatus 字符串

指示支付结果。有效值包括：

*   `SUCCESS`：表示支付成功。
*   `FAIL`：表示支付失败。
*   `PROCESSING`：表示支付处理中。
*   `CANCELLED`：表示支付已取消。
*   `PENDING`：表示支付已完成。等待最终的支付结果。

注意：当API调用成功（result.resultStatus的值为`S`）时，此字段会被返回。

#### paymentResultCode 字符串

不同支付状态的结果代码。可能的支付结果代码列在此页面的“支付结果代码”表中。

注意：当API调用成功（result.resultStatus的值为`S`）时，此字段会被返回。

关于此字段的更多信息：

*   最大长度：64个字符

#### paymentResultMessage 字符串

解释支付结果代码的结果消息。

注意：当API调用成功（result.resultStatus的值为`S`）时，此字段会被返回。

关于此字段的更多信息：

*   最大长度：256个字符

#### paymentRequestId 字符串

商家为标识支付请求而分配的唯一ID。

注意：当API调用成功（result.resultStatus的值为`S`）时，此字段会被返回。

关于此字段的更多信息

*   最大长度: 64 个字符

#### paymentId 字符串

支付宝为识别一次支付分配的唯一ID。

注意: 当API调用成功（result.resultStatus 的值为 `S`）时，此字段会被返回。

更多关于此字段的信息

*   最大长度: 64 个字符

#### paymentAmount 金额对象

商家在订单货币中请求收取的支付金额。

显示子参数

#### paymentCreateTime 日期时间

支付创建的日期和时间。

注意: 当API调用成功（_result.resultStatus_ 的值为 `S`）时，此字段会被返回。

更多关于此字段的信息

*   值遵循 [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) 标准格式。例如, "2019-11-27T12:01:01+08:00"。

#### paymentTime 日期时间

支付达到最终成功状态的日期和时间。

注意：此字段仅在支付达到最终成功状态（_paymentStatus_ 的值为 `SUCCESS`）时返回。

关于此字段的更多信息：

*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。

#### pspCustomerInfo PspCustomerInfo 对象

Alipay+ MPP 的客户信息。

注意：当Alipay+ MPP可以提供相关信息时，此字段将返回。

显示子参数

#### redirectActionForm RedirectActionForm 对象

重定向操作的信息。

注意：当 _paymentResultCode_ 的值为 `PAYMENT_IN_PROCESS` 时，此字段将返回。

显示子参数

#### acquirerReferenceNo 字符串

非支付宝收单方为交易分配的唯一ID。

关于此字段的更多信息：

*   最大长度：64 个字符

#### transactions Array<Transaction> 对象

关于交易的后续操作信息。

当交易存在退款或扣款时，此参数会被返回。

更多关于此字段的信息：

*   最大尺寸：无限制

显示子参数

#### customsDeclarationAmount Amount 对象

海关申报的总额。

注意：此字段仅在支付成功且钱包为 AlipayCN 时返回。

显示子参数

#### grossSettlementAmount Amount 对象

此字段的值等于交易金额乘以 `_settlementQuote` 的值。当货币兑换预先确定且交易时汇率被锁定时，此字段会被返回。

显示子参数

#### settlementQuote Quote 对象

结算货币与交易货币之间的汇率。当 `_grossSettlementAmount` 返回时，此字段也会被返回。

显示子参数

#### paymentResultInfo PaymentResultInfo 对象

支付结果信息。

当调用[**pay**](https://global.alipay.com/docs/ac/ams/payment_cashier) API 时，如果`paymentMethodType`的值为`CARD`、`GRABPAY_MY`或`GRABPAY_SG`，且`paymentStatus`的值为`SUCCESS`或`FAIL`，则返回此参数。

选择场景

#### authExpirytime Datetime 

授权支付的过期时间。超过此时间后，无法捕获支付。

当调用**pay (Checkout Payment)** API 时，如果`paymentMethodType`的值为`CARD`，则返回此参数。

关于此字段的更多信息：

*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。

#### promotionResult Array <PromotionResult> object 

促销结果。

当买家在下单时使用了促销活动时，返回此参数。

显示子参数

API 探索器

示例代码在沙箱中运行

### 请求

URL

北美

开放北美全球蚂蚁金服支付查询API

请求体

Copy

1

2

3

{
"paymentId": "2019060811401080010018882020035\*\*\*\*"
}

请注意，此API用于查询支付状态。在请求体中，"paymentId" 是支付的唯一标识符，具体值应替换为实际的支付ID。请确保在调用API时提供正确的支付ID以获取相关支付信息。

### 响应

情况

支付成功

响应体

Copy

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

{  
"result": {  
"resultCode": "SUCCESS",  
"resultStatus": "S",  
"resultMessage": "成功"  
},  
"paymentStatus": "SUCCESS",  
"paymentRequestId": "pay\_1089760038715669\_10277574507XXXX",  
"paymentId": "2019060811401080010018882020035XXXX",  
"paymentAmount": {  
"value": "500",  
"currency": "USD"  
},  
"paymentCreateTime": "2019-06-01T12:01:01+08:30",  
}

请注意，JSON键未翻译，以保持数据的原始格式。翻译已按照markdown格式要求完成，确保了语句通顺和空白行的保留。

"paymentTime": "2099-06-01T12:01:01+08:30",
"transactions": null

请注意，这是一个JSON对象，包含两个键值对：
1. "paymentTime"：表示支付时间，值为 "2019-06-01T12:01:01+08:30"，这是一个遵循ISO 8601标准的日期时间格式，表示的是北京时间2019年6月1日中午12点01分01秒。
2. "transactions"：表示交易记录，值为 "null"，意味着在这个例子中没有具体的交易信息。

更多信息
-----------------

本节提供有关关键参数的额外信息。请参阅以下详细列表：

*   _支付时间_ : 支付宝成功执行此支付的时间，即支付达到最终成功状态的日期和时间。这个值用作后续可取消和可退款时间的起始时间。例如，如果退款期限为6个月，那么接受退款的最终截止时间是 _支付时间_ 加上6个月。
*   关于何时使用 _paymentRequestId_ 或 _paymentId_ ，遵循以下规则：

    *   如果 **pay** API 调用成功返回，使用 _paymentId_ 或 _paymentRequestId_ 查询支付结果。
    *   如果 **pay** API 调用返回未知异常或超时，使用 _paymentRequestId_ 查询支付结果。
    *   如果 **cancel** API 调用返回未知异常或超时，使用原始支付的 _paymentId_ 或 _paymentRequestId_ 查询取消结果。

结果处理逻辑
------------------

对于不同的请求结果，需要执行不同的操作。详细信息如下：

*   如果`result.resultStatus`的值为`S`，则**inquiryPayment** API调用成功。您可以从API响应的`paymentStatus`字段获取支付结果。
*   如果`result.resultStatus`的值为`F`，则**inquiryPayment** API调用失败。无法从API响应中获取支付结果。
*   如果`result.resultStatus`的值为`U`，**inquiryPayment** API调用的状态未知。使用相同的请求参数重试**inquiryPayment** API。

### 结果/错误代码

|代码| 值| 消息| 进一步操作|
|---|---|---|---|
|SUCCESS| S| 成功| 接口调用成功。通过_paymentStatus_获取订单状态。|
|ACCESS_DENIED| F| 访问被拒绝| 请咨询支付宝技术支持以获取详细原因。|
|INVALID_API| F| 调用的API无效或未激活| 请咨询支付宝技术支持解决问题。|

| 错误代码 | 错误类型 | 错误描述 | 解决方案 |
| --- | --- | --- | --- |
| KEY\_NOT\_FOUND | F | 未找到支付宝或商家的私钥或公钥。 | 检查私钥或公钥是否存在。如果不存在，请在支付宝开发者中心上传私钥。 |

| NO\_INTERFACE\_DEF | F | API 未定义。 | 检查 URL 是否正确。请参考 API 文档中的端点。 |

| ORDER\_NOT\_EXIST | F | 订单不存在。 | 检查 _paymentId_ 是否正确。如果正确，请联系支付宝技术支持以了解具体原因。 |

| PARAM\_ILLEGAL | F | 必需参数未传递，或存在非法参数。例如，非数字输入、无效日期，或参数长度和类型错误。 | 检查并验证当前 API 的必需请求字段（包括头部字段和正文字段）是否正确传递并有效。 |

| 状态 | 类型 | 描述 | 处理方式 |
| --- | --- | --- | --- |
| PAYMENT\_IN\_PROCESS | U | 支付正在处理中。 | 对于收银台支付，您发起的请求具有与已存在交易相同的 _paymentRequestId_，这可能是成功或处理中的交易。检查响应中是否返回了\_redirectActionForm.redirectUrl。如果返回，将用户重定向到redirectUrl指定的地址以完成支付。如果没有返回，支付可能已经完成。详细结果处理逻辑请参阅相关文档。对于自动扣款，支付正在处理中。等待异步通知或调用查询支付接口来查询最终支付状态。 |
| PROCESS\_FAIL | F | 发生了一般业务错误。 | 不要重试，通常需要人工干预。建议联系支付宝技术支持以解决问题。 |
| SYSTEM\_ERROR | F | 系统错误发生。 | 不要重试，联系支付宝技术支持获取更多详细信息。 |

| 错误代码 | 类型 | 描述 | 解决方案 |
| --- | --- | --- | --- |
| REQUEST\_TRAFFIC\_EXCEED\_LIMIT | U | 请求流量超过限制。 | 重新调用接口以解决问题。如果问题未解决，请联系支付宝技术支持。 |

| UNKNOWN\_EXCEPTION | U | 由于未知原因，API调用失败。 | 重新调用接口以解决问题。如果问题未解决，请联系支付宝技术支持。 |

### 支付结果代码

| 代码 | 值 | 消息 | 进一步操作 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 支付成功，无需进一步操作。 |

| ACCESS\_DENIED | F | 访问被拒绝。 | 联系支付宝技术支持获取详细原因。 |

| CURRENCY\_NOT\_SUPPORT | F | 货币不支持。 | 联系支付宝技术支持获取详细原因。 |

| FRAUD\_REJECT | F | 由于风险控制，交易无法进一步处理。如果用户已支付交易，交易将被退款。 | 当满足以下任一条件时联系支付宝技术支持：

*   您想要申诉。
*   用户在两周内未收到退款。 |

| 错误代码 | 错误类型 | 错误描述 | 解决方案 |
| --- | --- | --- | --- |
| INVALID\_API | F | 调用的API无效或未激活。 | 联系支付宝技术支持解决此问题。 |

| INVALID\_CARD | F | 卡片无效。可能是信用卡号无法识别，卡片没有对应的发卡银行，或者卡号格式错误。 | 使用新卡发起支付或联系发卡银行。 |

| INVALID\_EXPIRY\_DATE\_FORMAT | F | expiryYear或expiryMonth的格式错误。 | 检查传递的参数\_expiryYear\_和\_expiryMonth\_的格式。 |

| ISSUER\_REJECTS\_TRANSACTION | F | 发卡银行拒绝交易。 | 使用新卡发起支付或联系发卡银行。 |

| INVALID\_ACCESS\_TOKEN | F | 访问令牌已过期、被撤销或不存在。 | 检查\_accessToken\_是否过期、被撤销或不存在。重新签署合同并重新发起授权签名流程。 |

| 错误代码 | 类型 | 描述 | 解决方案 |
| --- | --- | --- | --- |
| INVALID\_MERCHANT\_STATUS | F | 商户状态异常，存在限制。 | 请咨询支付宝技术支持以获取详细原因。 |
| KEY\_NOT\_FOUND | F | 找不到支付宝或商户的私钥或公钥。 | 检查私钥或公钥是否存在。如果不存在，请在支付宝开发者中心上传私钥。 |
| MERCHANT\_KYB\_NOT\_QUALIFIED | F | 由于商户的KYB状态，支付失败。商户可能未完成KYB，或者KYB状态不满足此交易要求。 | 请咨询支付宝技术支持以获取详细原因。 |
| NO\_INTERFACE\_DEF | F | API未定义。 | 检查URL是否正确。请参考API文档中的端点信息。 |
| NO\_PAY\_OPTIONS | F | 无可用的支付选项。 | 请咨询Antom技术支持以获取详细原因。 |

请确保在处理这些错误时，按照提供的解决方案进行检查和联系相应的技术支持。

| 错误代码 | 类型 | 描述 | 解决方案 |
| --- | --- | --- | --- |
| ORDER\_IS\_CLOSED | F | 您发起的请求具有与已存在交易相同的paymentRequestId，而该交易已关闭。 | 使用新的_paymentRequestId_重新发起支付。 |

| PARAM\_ILLEGAL | F | 必需参数未传递，或存在非法参数。例如，非数字输入，无效日期，或参数的长度和类型错误。 | 检查并确认当前API所需的请求字段（包括头部字段和正文字段）是否正确传递并有效。 |

| PAYMENT\_AMOUNT\_EXCEED\_LIMIT | F | 支付金额超过了合同或支付方式允许的最大金额。 | 检查支付金额是否超出限制，或使用较低金额重试。联系支付宝技术支持了解具体限制。 |

| 错误代码 | 错误类型 | 错误描述 | 解决建议 |
| --- | --- | --- | --- |
| PAYMENT\_COUNT\_EXCEED\_LIMIT | F | 支付次数超过支付方式所设定的限制。 | 请咨询支付宝技术支持了解具体限制。 |
| PAYMENT\_NOT\_QUALIFIED | F | 商家未达到支付条件，可能是因为未注册、未签订自动扣款协议或被禁止支付。 | 请咨询支付宝技术支持获取详细原因。 |
| PROCESS\_FAIL | F | 发生了一般的业务处理失败。 | 不建议重试，通常需要人工干预。建议联系支付宝技术支持解决问题。 |
| RISK\_REJECT | F | 由于风险控制，交易无法继续处理。如果用户已支付，交易将被退款。 | 如用户在两周内未收到退款，请联系支付宝技术支持。 |

| 错误代码 | 类型 | 描述 | 解决方案 |
| --- | --- | --- | --- |
| SUSPECTED\_CARD | F | 该卡涉嫌欺诈，例如可能被盗或受限。 | 使用新卡发起支付或联系发卡银行。 |
| SUSPECTED\_RISK | F | 由于疑似安全问题，交易无法进一步处理。可在工作日后一天重试交易。如果交易不安全且用户已付款，交易将被退款。 | 当满足以下任一条件时，联系支付宝技术支持：

*   重试后交易仍无法处理。
*   用户在两周内未收到退款。 |

| SYSTEM\_ERROR | F | 发生系统错误。 | 不要重试，联系支付宝技术支持获取更多详细信息。 |
| USER\_AMOUNT\_EXCEED\_LIMIT | F | 支付金额超过用户支付限额。 | 创建一个金额小于或等于账户可用余额的新支付，或联系支付宝技术支持。 |

| 错误代码 | 类型 | 描述 | 解决方案 |
| --- | --- | --- | --- |
| USER\_BALANCE\_NOT\_ENOUGH | F | 由于对应支付方式的用户余额不足，无法完成支付。 | 请充值账户或选择其他支付方式。 |
| USER\_KYC\_NOT\_QUALIFIED | F | 支付失败，因为用户的KYC状态不达标。用户可能未完成KYC认证，或者KYC状态不满足此交易要求（例如，支付金额或产品信息的限制）。 | 首先完成KYC验证。 |
| USER\_PAYMENT\_VERIFICATION\_FAILED | F | 用户在支付方式端被限制支付。 | 联系支付宝技术支持了解具体原因。 |
| USER\_STATUS\_ABNORMAL | F | 用户在支付方式端的状态异常。 | 联系支付宝技术支持了解具体原因。 |

| 支付处理中 | U | 支付正在处理。 | 对于收银台支付，您发起的请求具有与已存在交易相同的 _paymentRequestId_，这可能是成功或处理中的交易。检查响应中是否返回了 _redirectActionForm.redirectUrl_。如果返回，将用户重定向到 redirectUrl 指定的地址以完成支付。如果没有返回，支付可能已经完成。详细信息请参阅结果处理逻辑。对于自动扣款，支付正在处理中。等待异步通知或调用查询支付接口来查询最终的支付状态。

 |
| 未知异常 | U | 由于未知原因，API 调用失败。 | 对于收银台支付，使用新的 _paymentRequestId_ 重新调用支付接口来解决问题。如果问题未解决，请联系支付宝技术支持。 |

对于自动扣款，再次调用支付接口或调用查询支付接口以查询最终的支付状态。如果问题仍未解决，请联系支付宝技术支持。

|
| CARD\_NOT\_SUPPORTED | F | 交易中使用的卡片不被支持。 | 

使用另一张卡片进行支付。

|
| INVALID\_EXPIRATION\_DATE | F | paymentMethod.paymentMethodMetaData.expiryYear 或 paymentMethod.paymentMethodMetaData.expiryDate 的值无效。 | 

检查 _paymentMethod.paymentMethodMetaData.expiryYear_ 或 _paymentMethod.paymentMethodMetaData.expiryDate_ 的值是否正确：

*   如果不正确，请传入正确的值。
*   如果正确，请联系支付宝技术支持以获取详细原因。

|
| INVALID\_CARD\_NUMBER | F | 交易中使用的卡片号无效。 | 

检查 _paymentMethod.paymentMethodMetaData.cardno_ 的值是否正确：

* 如果不正确，请输入正确的值并重试。
* 如果正确，此卡片不支持该交易，请使用另一张卡片支付。

---

### 交易结果代码

| 代码 | 值 | 消息 | 进一步行动 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 接口调用成功。从 `_refundStatus_` 获取退款状态。 |
| ACCESS\_DENIED | F | 访问被拒绝 | 请咨询支付宝技术支持以获取详细原因。 |
| INVALID\_API | F | 调用的API无效或未激活 | 请咨询支付宝技术支持解决问题。 |
| CLIENT\_INVALID | F | 客户端ID无效。支付宝对客户端ID有限制 | 检查客户端ID是否正确，或联系支付宝技术支持获取详细原因。 |
| KEY\_NOT\_FOUND | F | 支付宝或商家的私钥或公钥未找到 | 检查私钥或公钥是否存在。如果不存在，请在支付宝开发者中心上传私钥。 |

| 错误代码 | 类型 | 错误信息 | 解决方案 |
| --- | --- | --- | --- |
| NO\_INTERFACE\_DEF | F | API未定义。 | 请检查URL是否正确。参考API文档中的端点信息。 |

| ORDER\_NOT\_EXIST | F | 订单不存在。 | 15秒后再次调用接口。如果三次重试后仍无结果，说明订单未创建。 |

| PARAM\_ILLEGAL | F | 必需参数未传递，或存在非法参数。例如，非数字输入，无效日期，或参数长度和类型错误。 | 检查并验证当前API所需的请求字段（包括头部字段和正文字段）是否正确传递并有效。 |

| PROCESS\_FAIL | F | 发生了一般业务错误。 | 不要重试，通常需要人工干预。建议联系支付宝技术支持以解决问题。 |

| SYSTEM\_ERROR | F | 系统错误。 | 不要重试，联系支付宝技术支持获取更多详细信息。 |

| 错误代码 | 类型 | 描述 | 解决方案 |
| --- | --- | --- | --- |
| REQUEST\_TRAFFIC\_EXCEED\_LIMIT | U | 请求流量超过限制。 | 重新调用接口以解决问题。如果问题未解决，请联系支付宝技术支持。 |
| UNKNOWN\_EXCEPTION | U | 由于未知原因，API调用失败。 | 重新调用接口以解决问题。如果问题未解决，请联系支付宝技术支持。 |

| 支付处理中 | U | 支付正在处理。 | 对于收银台支付，您发起的请求具有与已存在交易相同的 _paymentRequestId_，这可能是已完成或正在处理的交易。检查响应中是否返回了 _redirectActionForm.redirectUrl_。如果返回了，将用户重定向到redirectUrl指定的地址以完成支付。如果没有返回，支付可能已经完成。详细信息请参阅结果处理逻辑。对于自动扣款，支付正在处理中。等待异步通知或调用查询支付接口来查询最终的支付状态。

 |
| 需要验证 | F | 需要3D安全验证。 | 重新发起支付并引导用户进行3D Secure验证。

 |
| 支付禁止 | F | 由于商品在该国家禁止销售，无法处理支付。 | 您无权对此交易提出申诉。

| 错误代码 | 类型 | 描述 | 解决方案 |
| --- | --- | --- | --- |
| INVALID\_AMOUNT | F | 交易被发卡银行拒绝，原因可能多样，例如指定的金额无效或超过最大金额限制。 | 请咨询支付宝技术支持以获取详细原因。 |

要查看文档的最新更新，请访问[发行说明](https://global.alipay.com/docs/releasenotes)。

![图片3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 支付宝 [法律信息](https://global.alipay.com/docs/ac/platform/membership)

#### 这个页面是否有帮助？