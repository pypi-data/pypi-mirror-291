幂等性 | 产品API | 支付宝文档
===============

[![支付宝，中国领先的第三方在线支付解决方案](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![支付宝，中国领先的第三方在线支付解决方案](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)
[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Fidempotency)
[返回首页](../../)

产品API
[支付宝API](/docs/ac/ams/api)
[概述](/docs/ac/ams/api_fund)
[幂等性](/docs/ac/ams/idempotency)
[消息编码](/docs/ac/ams/me)
[请求签名与验签](/docs/ac/ams/digital_signature)
[API变更历史](/docs/ac/ams/changehistory)

在线支付
店内支付
幂等性
===========

2023-03-27 06:20
支付宝API支持幂等性，允许多次重试请求，但只会执行一次操作。这有助于在发生错误和重试时避免不必要的重复。

如果之前请求中发生了瞬时错误或超时，操作未完成，后续的重试会推动操作完成。如果操作已经完成，那么该操作只执行一次，并在重试过程中返回相同的结果。所有支付宝支付相关的API都是幂等的。下表列出了最常用的API及其幂等性规则。

幂等性字段
==================

下表列出了API的幂等性字段。有关每个幂等性字段的详细信息，请参阅相应的API章节。

| **API名称** | **幂等性字段** | **规则** |
| --- | --- | --- |
| 支付 | paymentRequestId | 商户使用*paymentRequestId*字段进行幂等性控制。对于使用相同*paymentRequestId*发起并达到最终状态（`S`或`F`）的支付请求，应返回相同的请求结果。注意：此API会检查一些关键请求参数，如*paymentRequestId*、*paymentAmount*和（如果适用）*paymentMethodId*的一致性。如果任何关键值与先前请求不同，将返回错误`REPEAT_REQ_INCONSISTENT`。 |
| 退款 | refundRequestId | 商户使用*refundRequestId*字段进行幂等性控制。对于使用相同*refundRequestId*发起并达到最终状态（`S`或`F`）的退款请求，应返回相同的请求结果。注意：如果*refundAmount*的值与先前请求不同，将返回错误`REPEAT_REQ_INCONSISTENT`。 |
| 扣款 | captureRequestId | 商户使用*captureRequestId*字段进行幂等性控制。对于使用相同*captureRequestId*发起并达到最终状态（`S`或`F`）的扣款请求，应返回相同的请求结果。注意：如果*captureAmount*的值与先前请求不同，将返回错误`REPEAT_REQ_INCONSISTENT`。 |
| 注册 | registrationRequestId | 商户使用*registrationRequestId*字段进行幂等性控制。对于使用相同*registrationRequestId*发起并达到最终状态（`S`或`F`）的注册请求，应返回相同的请求结果。 |
| 初始化认证 | authenticationRequestId | 商户使用*authenticationRequestId*字段进行幂等性控制。对于使用相同*authenticationRequestId*发起并达到最终状态（`S`或`F`）的初始化认证请求，应返回相同的请求结果。 |
表1.幂等性字段及相应的处理规则

要查看文档的最新更新，请访问[发行说明](https://global.alipay.com/docs/releasenotes)。

![图片3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 蚂蚁金服 [法律信息](https://global.alipay.com/docs/ac/platform/membership)

#### 这个页面是否有帮助？

#### 在这个页面上

[幂等性字段](#aQ2Bz "幂等性字段")