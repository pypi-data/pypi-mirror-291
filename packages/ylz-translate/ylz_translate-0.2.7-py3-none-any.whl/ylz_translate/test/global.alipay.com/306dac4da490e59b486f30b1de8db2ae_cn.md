取消 | 产品API | 支付宝文档
==================

[![图片1：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![图片2：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Fpaymentc)  
[返回首页](../../)

产品API  
[支付宝API](/docs/ac/ams/api)  
在线支付  
店内支付  
支付  
[支付（用户出示模式支付）](/docs/ac/ams/upm)  
[支付（订单码支付）](/docs/ac/ams/oc)  
[支付（入口码支付）](/docs/ac/ams/ec)  
[通知支付](/docs/ac/ams/paymentrn)  
[查询支付](/docs/ac/ams/paymentri)  
[取消](/docs/ac/ams/paymentc)  
退款  
注册  
取消
======  
2023年11月9日 09:33  
POST /v1/payments/cancel  
使用**取消** API 可以在支付结果长时间未返回时取消支付，或者在授权完成后取消支付授权。

在调用此API之前需要注意：
要取消支付，您必须提供以下参数之一：
*   _paymentId_：要取消的原始支付请求的ID，由支付宝在商家发起原始支付时生成。
*   _paymentRequestId_：要取消的原始支付请求的ID。

结构
====

消息由头部和主体组成。以下部分专注于主体结构。头部结构请参阅：
*   [请求头部](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [响应头部](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)
**注意**: 将每个字段（不包括数组）的数据类型设置为字符串。这意味着字段值必须用双引号（" "）括起来。例如：

*   如果字段的数据类型为整数，其值为20，应表示为"20"。
*   如果字段的数据类型为布尔值，其值为true，应表示为"true"。
### 请求参数  
#### paymentId 字符串  
支付宝为标识一次支付分配的唯一ID。_paymentId_ 和 _paymentRequestId_ 不能同时为空。_paymentId_ 与 _paymentRequestId_ 之间存在一一对应的关系。  
关于此字段的更多信息：  
*   最大长度：64 个字符  
#### paymentRequestId 字符串  
商家为标识支付请求分配的唯一ID。_paymentRequestId_ 和 _paymentId_ 不能同时为空。如果同时提供了 _paymentRequestId_ 和 _paymentId_，则 _paymentId_ 优先。  
关于此字段的更多信息：  
*   最大长度：64 个字符
### 响应参数  
显示全部  
#### result 结果对象 **必需**  
请求结果包含状态和错误代码等信息。  
显示子参数  
#### paymentId 字符串  
支付宝为识别一笔支付而分配的唯一ID。  
关于此字段的更多信息：  
*   最大长度：64个字符  
#### paymentRequestId 字符串  
商家为识别支付请求而分配的唯一ID。  
关于此字段的更多信息：  
*   最大长度：64个字符  
#### cancelTime 日期时间  
支付取消操作的实际完成时间，即支付取消成功的日期和时间。只有在取消成功时，此参数才会返回。  
关于此字段的更多信息：  
*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。  
API 探索器
### 请求  
URL  
北美地区  
https://open-na-global.alipay.com/ams/api/v1/payments/cancel  

请求体  
复制  
1  
2  
3  
{  
"paymentId": "2019061218401080010018882020035XXXX"  
}  

请注意，以上内容是一个请求示例，用于取消支付。URL 是北美地区的蚂蚁金服开放平台接口，请求体中包含了一个支付ID（paymentId），这个ID是特定支付的标识符，需要替换为实际的支付ID以发起取消请求。其余的星号（XXXXXXXXXXXXXXXXXXXXXXXX...）代表文档中可能存在的其他信息或保密内容，这部分在实际使用时需要根据具体情况进行填充或替换。
### 响应  
响应体  
复制  
1  
2  
3  
4  
5  
6  
7  
8  
9  
10  
{  
"result": {  
"resultCode": "SUCCESS",  
"resultStatus": "S",  
"resultMessage": "success"  
},  
"paymentRequestId": "pay\_2089760038715669\_20277574507XXXX",  
"paymentId": "2019061218401080010018882020035XXXX",  
"cancelTime": "2019-06-12T19:07:11+08:00"  
}  
处理结果逻辑
--------------------

对于不同的请求结果，需要执行不同的操作。具体如下：

1.  如果`result.resultStatus`的值为`S`，取消操作成功。
2.  如果`result.resultStatus`的值为`F`，取消操作失败。请查看返回的错误代码并据此采取进一步行动。
3.  如果`result.resultStatus`的值为`U`，取消结果未知。请使用相同的请求参数重试取消请求。
4.  如果没有收到响应，也请使用相同的请求参数重试取消请求。
### 结果/错误代码  
| 代码 | 值 | 消息 | 进一步操作 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 订单已取消。商家需要将收据状态设置为取消。 |
| CANCEL\_WINDOW\_EXCEED | F | 取消日期超出了支持取消的期限，该期限在合同中约定。 | 交易无法再取消。对交易发起退款。 |
| CLIENT\_INVALID | F | 客户端无效。 | 检查\_clientId 是否正确。 |
| ORDER\_NOT\_EXIST | F | 订单不存在。 | 检查\_paymentId 是否正确。 |
| ORDER\_STATUS\_INVALID | F | 由于订单状态无效，交易无法进一步处理。 | 检查交易的订单状态，或联系支付宝技术支持获取详细原因。 |
| MEDIA\_TYPE\_NOT\_ACCEPTABLE | F | 服务器不支持客户端可接受的媒体类型。 | 检查媒体类型是否正确。 |
| METHOD\_NOT\_SUPPORTED | F | 服务器不实现请求的HTTP方法。 | 检查HTTP方法是否正确。 |
| MERCHANT\_BALANCE\_NOT\_ENOUGH | F | 商家余额不足。 | 商家余额充足后再次调用接口。 |

要查看文档的最新更新，请访问 [版本说明](https://global.alipay.com/docs/releasenotes)。

![图片 3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片 4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 支付宝 [法律信息](https://global.alipay.com/docs/ac/platform/membership)  

#### 这个页面有帮助吗？