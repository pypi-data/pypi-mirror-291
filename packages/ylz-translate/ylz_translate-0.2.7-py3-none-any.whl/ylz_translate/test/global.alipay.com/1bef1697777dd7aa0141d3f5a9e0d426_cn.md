退款 | 产品API | 支付宝文档
==================

[![图片1：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![图片2：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Frefund_online)

[返回首页](../../)

产品API
[支付宝API](/docs/ac/ams/api)
在线支付
授权
安全存储
支付
订阅
争议
退款
[退款](/docs/ac/ams/refund_online)
[通知退款](/docs/ac/ams/notify_refund)
[查询退款](/docs/ac/ams/ir_online?pageVersion=14)
声明
店内支付
退款
==========
2024-04-10 03:24
POST /v1/payments/refund
使用此API对成功支付发起退款，退款可以是全额或部分。只要总退款金额小于或等于原始交易金额，一个交易可以有多次退款。如果退款请求超出合同中确定的退款窗口期，退款请求将被拒绝。

**注意**：在超时或返回_resultStatus_为U时，使用相同的_refundRequestId_字段重试退款。_refundRequestId_字段设计为幂等的。

结构
==========

消息由头部和主体组成。以下部分专注于主体结构。对于头部结构，请参阅：
*   [请求头部](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [响应头部](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)

**注意**：将每个字段（除数组外）的数据类型设置为字符串。这意味着必须使用双引号（" "）包围字段值。示例：
*   如果字段的数据类型为Integer，其值为20，设置为"20"。
*   如果字段的数据类型为Boolean，其值为true，设置为"true"。
### 请求参数  
显示全部  
#### refundRequestId 字符串  必需  
商家为退款请求分配的唯一标识ID。  
关于此字段的更多信息：  
*   此字段是API幂等性字段。商家使用refundRequestId字段进行幂等性控制。对于使用相同refundRequestId值发起且达到最终状态（S或F）的支付请求，应返回相同的结果。
*   最大长度：64个字符  
#### paymentId 字符串  必需  
支付宝为原始支付分配的唯一ID，需要退款。  
关于此字段的更多信息：  
*   最大长度：64个字符  
#### referenceRefundId 字符串  
商家直接向客户提供商品或服务时，为退款分配的唯一ID。  
注意：如果需要内部使用或对账，请指定此字段。  
关于此字段的更多信息：  
*   最大长度：64个字符  
#### refundAmount Amount对象  必需  
商家发起的退款金额。  
显示子参数  
#### refundReason 字符串  
退款原因。  
注意：如果要向用户和支付方式提供退款原因，请指定此字段。  
关于此字段的更多信息：  
*   最大长度：256个字符  
#### refundNotifyUrl 字符串  
接收退款结果通知的URL。URL必须在请求中指定或在Antom仪表板中设置。  
注意：如果要接收退款结果的异步通知，请指定此字段。如果请求和Antom仪表板中都指定了退款通知URL，则请求中指定的值优先。  
关于此字段的更多信息：  
*   最大长度：1024个字符
### 响应参数  
显示全部  
#### result 结果对象 **必需**  
指示此 API 调用是否成功。如果 API 调用成功，退款也成功。  
显示子参数  
#### refundRequestId 字符串  
商家为标识退款请求而分配的唯一 ID。  
注意：当退款成功（_result.resultStatus_ 的值为 `S`）时，此字段返回。  
关于此字段的更多信息  
*   最大长度：64 个字符  
#### refundId 字符串  
支付宝为标识退款分配的唯一 ID。_refundId_ 与 _refundRequestId_ 之间存在一对一对应关系。  
注意：当退款成功（_result.resultStatus_ 的值为 `S`）时，此字段返回。  
关于此字段的更多信息  
*   最大长度：64 个字符  
#### paymentId 字符串  
原始支付的支付宝分配的唯一 ID，需要退款。  
注意：当退款成功（_result.resultStatus_ 的值为 `S`）时，此字段返回。  
关于此字段的更多信息  
*   最大长度：64 个字符  
#### acquirerReferenceNo 字符串  
非支付宝收单方为交易分配的唯一 ID。  
关于此字段的更多信息  
*   最大长度：64 个字符  
#### refundAmount 金额对象  
付款人因退款而收取的退款金额。  
注意：当退款成功（_result.resultStatus_ 的值为 `S`）时，此字段返回。  
显示子参数  
#### refundTime 日期时间  
退款达到成功、失败或未知状态的日期和时间。  
关于此字段的更多信息  
*   值遵循 [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) 标准格式。例如，"2019-11-27T12:01:01+08:00"。  
#### grossSettlementAmount 金额对象  
退款结算金额，等于退款金额乘以 _settlementQuote_ 的值。当货币兑换在交易时预先确定且汇率被锁定时，此字段返回。  
显示子参数  
#### settlementQuote 报价对象  
结算货币与交易货币之间的汇率。当 _grossSettlementAmount_ 返回时，此字段返回。  
显示子参数  
API 探索器  
示例代码在沙箱中运行
### 请求  
URL  
北美地区  
https://open-na-global.alipay.com/ams/api/v1/payments/refund  

请求体  
复制  
1  
2  
3  
4  
5  
6  
7  
8  
{  
"paymentId": "20181129190741010007000000XXXX",  
"refundRequestId": "20181129190741020007000000XXXX",  
"refundAmount": {  
"value": "100",  
"currency": "USD"  
}  
}  

请注意，以上内容为示例，实际请求中"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"部分应替换为具体的支付ID和退款请求ID。
### 响应  
案例  
成功  
响应体  
复制  
1  
2  
3  
4  
5  
6  
7  
8  
9  
10  
11  
12  
13  
14  
15  
{  
"result": {  
"resultCode": "SUCCESS",  
"resultStatus": "S",  
"resultMessage": "成功"  
},  
"refundAmount": {  
"value": "100",  
"currency": "USD"  
},  
"refundTime": "2020-10-10T12:01:01+08:30",  
"paymentId": "20181129190741010007000000XXXX",  
"refundRequestId": "20181129190741020007000000XXXX",  
"refundId": "40181129190741020007000000XXXX"  
}  
（此处的“הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה
### 结果/错误代码  
| 代码 | 值 | 消息 | 进一步行动 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 退款成功，无需进一步操作。 |
| ACCESS\_DENIED | F | 访问被拒绝。 | 联系支付宝技术支持获取详细原因。 |
| INVALID\_API | F | 调用的API无效或未激活。 | 联系支付宝技术支持解决问题。 |
| CURRENCY\_NOT\_SUPPORT | F | 货币不支持。 | 联系支付宝技术支持获取详细原因。 |
| INVALID\_MERCHANT\_STATUS | F | 商户状态异常，存在限制。 | 联系支付宝技术支持获取详细原因。 |
| KEY\_NOT\_FOUND | F | 支付宝或商户的私钥或公钥未找到。 | 检查私钥或公钥是否存在。如不存在，请在蚂蚁开放平台后台上传私钥。 |
| MERCHANT\_BALANCE\_NOT\_ENOUGH | F | 商户余额不足。 | 商户余额充足后重新调用接口。重试时需更改_refundRequestId_字段。 |
| MULTIPLE\_REFUNDS\_NOT\_SUPPORTED | F | 合同限制不支持多次退款。 | 检查是否存在多次退款。不要再调用退款接口，每次退款仅调用一次接口。 |
| NO\_INTERFACE\_DEF | F | API未定义。 | 检查URL是否正确。请参考API文档中的端点。 |
| ORDER\_IS\_CLOSED | F | 您发起的请求具有与已关闭交易相同的paymentRequestId。 | 使用新的_paymentRequestId_重新发起退款。 |
| ORDER\_NOT\_EXIST | F | 订单不存在。 | 检查_paymentId_是否正确。如果正确，请联系支付宝技术支持获取具体原因。 |
| ORDER\_STATUS\_INVALID | F | 订单状态无效。交易处理中或交易失败。 | 检查订单状态并采取相应行动。交易处理中时请等待，交易失败时不要发起退款。联系支付宝技术支持获取具体原因。 |
| PARAM\_ILLEGAL | F | 必要参数未传递，或存在非法参数。例如，非数字输入、无效日期或参数长度和类型错误。 | 检查并验证当前API的必要请求字段（包括头部字段和主体字段）是否正确传递并有效。 |
| PROCESS\_FAIL | F | 业务处理失败。 | 不要重试，通常需要人工干预。建议联系支付宝技术支持解决问题。 |
| REFUND\_AMOUNT\_EXCEED | F | 退款总额超过支付金额。 | 确认退款总额是否超过支付金额。创建新的退款，金额小于或等于支付金额，或联系支付宝技术支持。 |
| REFUND\_WINDOW\_EXCEED | F | 退款日期超过合同约定的退款期限。 | 确认退款日期是否超过退款期限。查看合同中的退款期限，或联系支付宝技术支持获取具体退款期限。 |
| REPEAT\_REQ\_INCONSISTENT | F | 金额或货币与先前请求不同。 | 确保所有请求字段相同，或使用新的_paymentRequestId_重新发起退款。 |
| SYSTEM\_ERROR | F | 系统错误。 | 不要重试，联系支付宝技术支持获取更多详情。 |
| REFUND\_IN\_PROCESS | U | 退款处理中。 | 等待异步通知或调用**inquiryRefund**接口查询最终退款状态。不要重试退款请求。 |
| REFUND\_NOT\_SUPPORTED | F | 该交易不支持退款。 | 检查交易状态和合同中的退款政策。如果交易成功且合同允许退款，请联系支付宝技术支持。 |
| REQUEST\_TRAFFIC\_EXCEED\_LIMIT | U | 请求流量超过限制。 | 重新调用接口解决问题。如未解决，请联系支付宝技术支持。 |
| PARTIAL\_REFUND\_NOT\_SUPPORTED | F | 该交易不支持部分退款。 | 进行全额退款或与买家协商线下退款。 |
| PAYMENT\_METHOD\_NOT\_SUPPORTED | F | 支付方式不支持成功状态下的取消或退款。 | 不要重试，联系支付宝技术支持获取更多信息。 |
| ORDER\_IS\_CANCELED | F | 交易已取消。 | 交易已取消，无法退款。 |
| UNKNOWN\_EXCEPTION | U | 由于未知原因，API调用失败。 | 重新调用接口解决问题。如未解决，请联系支付宝技术支持。 |

要查看文档的最新更新，请访问 [版本更新日志](https://global.alipay.com/docs/releasenotes)。

![图片3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 支付宝 [法律信息](https://global.alipay.com/docs/ac/platform/membership)  

#### 这个页面有帮助吗？