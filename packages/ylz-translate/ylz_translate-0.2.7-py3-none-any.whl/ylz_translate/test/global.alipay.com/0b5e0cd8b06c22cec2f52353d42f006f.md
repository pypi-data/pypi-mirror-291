create | Product APIs | Alipay Docs
===============
                        

[![Image 1: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![Image 2: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[Log In](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Fcreate_sub)

[Go to Homepage](../../)

Product APIs

[Alipay APIs](/docs/ac/ams/api)

Online payments

Authorization

Vault

Payment

Subscription

[create](/docs/ac/ams/create_sub)

[notifySubscription](/docs/ac/ams/notify_sub)

[notifyPayment](/docs/ac/ams/notify_subpayment)

[change](/docs/ac/ams/change_sub)

[cancel](/docs/ac/ams/cancel_sub)

Dispute

Refund

Declaration

In-store payments

create
======

2024-04-10 03:24

POST /v1/subscriptions/create

Use the **create** API to initiate a subscription creation request. After this API is called successfully, you can get the authorization URL and redirect the user to the URL to authorize the subscription. After the user authorizes the subscription successfully, Alipay initiates an automatic deduction in each subscription period and notifies you of the payment result.

Structure
=========

A message consists of a header and body. The following sections are focused on the body structure. For the header structure, see：

*   [Request header](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [Response header](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)  
    

**Note**: Set the data type of each field (except array) as String. This means that you must use double quotation marks (" ") to enclose the field value. Examples:

*   If the data type of a field is Integer and its value is 20, set it as "20".
*   If the data type of a field is Boolean and its value is true, set it as "true".  

### Request parameters

Show all

#### subscriptionRequestId String  REQUIRED

The unique ID assigned by a merchant to identify a subscription request. Alipay uses this field for idempotency control.

More information about this field

*   This field is an API idempotency field.For subscription requests that are initiated with the same value of subscriptionRequestId and reach a final status of S or F, the same result is to be returned for the request.
*   Maximum length: 64 characters

#### subscriptionDescription String  REQUIRED

The description of the subscription, used for displaying user consumption records and other actions.

More information about this field

*   Maximum length: 256 characters

#### subscriptionRedirectUrl URL  REQUIRED

The merchant page URL that the user is redirected to after authorizing the subscription.

More information about this field

*   Maximum length: 2048 characters

#### subscriptionStartTime Datetime  REQUIRED

The date and time when the subscription becomes active.

More information about this field

*   The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard format. For example, "2019-11-27T12:01:01+08:00".

#### subscriptionEndTime Datetime  

The date and time when the subscription ends.

Specify this parameter when you want to designate the subscription end time.

More information about this field

*   The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard format. For example, "2019-11-27T12:01:01+08:00".

#### periodRule PeriodRule object REQUIRED

The subscription period rule, used to define a subscription's billing period.

Show child parameters

#### subscriptionExpiryTime Datetime  

A specific date and time after which the created subscription expires. When the subscription expires, the order must be terminated. The default value of this parameter is 30 minutes after the subscription creation request is sent.

Specify this parameter if you want to designate the subscription creation expiration time. The specified payment expiration time must be less than 48 hours after the subscription request is sent.

More information about this field

*   The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard format. For example, "2019-11-27T12:01:01+08:00".

#### paymentMethod PaymentMethod object REQUIRED

The payment method that is used to collect the payment by the merchant or acquirer.

Show child parameters

#### subscriptionNotificationUrl URL  

The URL that is used to receive the subscription result notification.

You can also configure the subscription notification URL in Antom Dashboard. If you specify this URL in both this API and Antom Dashboard, the URL configured in the API takes precedence.

> Only one subscription notification URL can be configured in Antom Dashboard.

More information about this field

*   Maximum length: 2048 characters

#### paymentNotificationUrl URL  

The URL that is used to receive the payment result notification for each subscription period.

You can also configure the subscription notification URL in [Antom Dashboard](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fopen%2Fconsole%2Fdeveloper%2Fapp%2Flist&from_site=MERCHANT&terminal_type=pc&loginScene=MERCHANT&locale=cn&loginId=&_route=QK). If you specify this URL in both this API and Antom Dashboard, the URL configured in the API takes precedence.

> You can only configure one subscription notification URL in Antom Dashboard.

More information about this field

*   Maximum length: 2048 characters

#### orderInfo OrderInfo object REQUIRED

The order information for the subscription. This field is used for different purposes:

*   During the payment process, this field is mainly used by Alipay for risk control or anti-money laundering.
*   After the payment is completed, this field is used for recording and reporting purposes such as purchase tracking and regulatory reporting. 

Show child parameters

#### paymentAmount Amount object REQUIRED

The payment amount charged to the user per subscription period.

Show child parameters

#### settlementStrategy SettlementStrategy object REQUIRED

The settlement strategy for the payment request.

Show child parameters

#### env Env object REQUIRED

Information about the environment where the order is placed, such as the device information.

Show child parameters

#### trials Array<Trial> object 

The list of trial information of a subscription.

Specify this parameter if the subscription includes any trial periods.

More information about this field

*   Maximum size: Unlimited

Show child parameters

### Response parameters

Show all

#### result Result object REQUIRED

Indicates whether this API is called successfully. If this API is successfully called, the subscription authorization URL is returned.

Show child parameters

#### schemeUrl URL  

The URL scheme that redirects users to open an app in an Android or iOS system when the target app is installed.

When the value of _result.resultCode_ is `S`, at least one of _schemeUrl_, _applinkUrl,_ and _normalUrl_ is to be returned.

More information about this field

*   Maximum length: 2048 characters

#### applinkUrl URL  

The URL that redirects users to open an app when the target app is installed, or to open a WAP page when the target app is not installed. For Android, the URL is a Native App Link. For iOS, the URL is a Universal Link.

When the value of _result.resultCode_ is `S`, at least one of _schemeUrl_, _applinkUrl,_ and _normalUrl_ is to be returned.

More information about this field

*   Maximum length: 2048 characters

#### normalUrl URL  

The URL that redirects users to a WAP or Web page in the default browser or the embedded WebView.

When the value of _result.resultCode_ is `S`, at least one of _schemeUrl_, _applinkUrl,_ and _normalUrl_ is to be returned.

More information about this field

*   Maximum length: 2048 characters

#### appIdentifier URL  

An Android package name, which is used for Android app to open a cashier page.

This field is returned when _result.resultCode_ is `S` and _terminalType_ is `APP` or `WAP`.

More information about this field

*   Maximum length: 128 characters

API Explorer

Sample CodesRun in Sandbox

### Request

URL

North America

https://open-na-global.alipay.com/ams/api/v1/subscriptions/create

Case

Subscription creation

Request Body

Copy

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21

22

23

24

25

26

27

28

29

30

31

32

33

34

35

{

"paymentMethod": {

"paymentMethodType": "CARD",

"paymentMethodId": "paymentMethodId\_paymentMethodId"

},

"env": {

"osType": "ANDROID",

"terminalType": "WAP"

},

"paymentAmount": {

"currency": "PHP",

"value": "1100"

},

"paymentNotificationUrl": "https://www.alipay.com",

"periodRule": {

"periodType": "YEAR",

"periodCount": 1

},

"settlementStrategy": {

"settlementCurrency": "USD"

},

"subscriptionDescription": "Subscription test",

"subscriptionEndTime": "2024-08-09T14:55:16+08:00",

"subscriptionExpiryTime": "2023-08-09T14:55:16+08:00",

"subscriptionNotificationUrl": "https://www.alipay.com",

"orderInfo": {

"orderAmount": {

"currency": "PHP",

"value": "1100"

}

},

"subscriptionRedirectUrl": "https://www.alipay.com",

"subscriptionRequestId":

      "merchant\_subscription\_2100000123456789\_21200000987654321",

"subscriptionStartTime": "2023-08-09T14:30:16+08:00"

}

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

### Response

Response Body

Copy

1

2

3

4

5

6

7

8

9

10

11

{

"result": {

"resultStatus": "S",

"resultCode": "SUCCESS",

"resultMessage": "success."

},

"applinkUrl": "http://xmock.inc.alipay.net/applinkUrl/test/url.htm",

"normalUrl": "http://xmock.inc.alipay.net/normalUrl/test/url.htm",

"schemeUrl": "http://xmock.inc.alipay.net/schemeUrl/test/url.htm",

"appIdentifier": "http://xmock.inc.alipay.net/appIdentifier/test/url.htm"

}

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Result process logic
--------------------

For different request results, different actions are to be performed. See the following list for details:

*   If the value of _result.resultStatus_ is `S`, the authorization URL is successfully returned by the _schemeUrl_, _applinkUrl,_ or _normalUrl_ field in the response. You can redirect the user to this URL to authorize the subscription payment.
*   If the value of _result.resultStatus_ is `U`, the API call status is unknown. You can call this API again to retry the process.
*   If the value of _result.resultStatus_ is `F`, the authorization URL failed to be returned. Generally, this case is caused by system defects or system failure. Check the error codes and take the corresponding actions or contact Alipay technical support. 

### Result/Error codes

| Code | Value | Message | Further action |
| --- | --- | --- | --- |
| SUCCESS | S | Success | 
The interface is called successfully. Obtain _schemeUrl_, _applinkUrl,_ or _normalUrl_ from the response.

 |
| ACCESS\_DENIED | F | Access is denied. | 

Contact Alipay Technical Support for detailed reasons.

 |
| CLIENT\_FORBIDDEN\_ACCESS\_API | F | Access is denied. | 

Contact Alipay Technical Support for detailed reasons.

 |
| INVALID\_API | F | The called API is invalid or not active. | 

Contact Alipay Technical Support to resolve the issue.

 |
| INVALID\_CLIENT\_STATUS | F | The client status is invalid. | Contact Alipay Technical Support for detailed reasons.

 |
| INVALID\_SIGNATURE | F | The signature is not validated. The private key used to sign a request does not match the public key of Antom Dashboard. | 

Check whether the private key used to sign a request matches the public key of Antom Dashboard. The following signature references are useful:

*   The [signature](https://global.alipay.com/docs/ac/ams/api_fund) field in a request header
*   How to [calculate a signature](https://global.alipay.com/docs/ac/ams/digital_signature)  



 |
| KEY\_NOT\_FOUND | F | The private key or public key of Alipay or the merchant is not found. | 

Check whether the private key or public key exists. If not, upload the private key in Antom Dashboard.



 |
| MERCHANT\_NOT\_REGISTERED | F | The merchant is not registered. | 

Please register the merchant by using the registration interface. Contact Alipay Technical Support if failed to call the registration interface.

 |
| OAUTH\_FAILED | F | OAuth process failed. | 

Contact Alipay Technical Support for detailed reasons.

 |
| PARAM\_ILLEGAL | F | The required parameters are not passed, or illegal parameters exist. For example, a non-numeric input, an invalid date, or the length and type of the parameter are wrong. | 

Check and verify whether the required request fields (including the header fields and body fields) of the current API are correctly passed and valid.

 |
| PAYMENT\_NOT\_QUALIFIED | F | The merchant is not qualified to pay because the merchant is not registered, does not have a contract for Auto Debit payment, or is forbidden to make a payment. | 

Contact Alipay Technical Support for detailed reasons.

 |
| PROCESS\_FAIL | F | A general business failure occurred. | 

Do not retry. Human intervention is usually needed. It is recommended that you contact Alipay Technical Support to troubleshoot the issue.

 |
| RISK\_REJECT | F | The transaction cannot be further processed because of risk control. If the user has already paid for the transaction, the transaction will be refunded. | 

If the user does not receive the refund within two weeks, contact Alipay Technical Support.

 |
| UNKNOWN\_CLIENT | F | The client is unknown. | Contact Alipay Technical Support for detailed reasons.

 |
| REQUEST\_TRAFFIC\_EXCEED\_LIMIT | U | The request traffic exceeds the limit. | Call the interface again to resolve the issue. If not resolved, contact Alipay Technical Support.

 |
| UNKNOWN\_EXCEPTION | U | An API call has failed, which is caused by unknown reasons. | 

Call the interface again to resolve the issue. If not resolved, contact Alipay Technical Support.

 |
| REPEAT\_REQ\_INCONSISTENT | F | The amount or currency is different from the previous request. | 

Ensure all the fields in the requests are the same or use a new _subscriptionRequestId_ to initiate the payment again.

 |

To view the latest updates to the documentation, visit [Release notes](https://global.alipay.com/docs/releasenotes).

![Image 3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png)![Image 4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 Alipay [Legal Information](https://global.alipay.com/docs/ac/platform/membership)

#### Is this page helpful?