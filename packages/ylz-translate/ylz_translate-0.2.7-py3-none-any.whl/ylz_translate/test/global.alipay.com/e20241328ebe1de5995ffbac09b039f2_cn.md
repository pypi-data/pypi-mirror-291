退款 | 产品API | 支付宝文档
==================

[![图片1：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![图片2：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Frefund)  
[返回首页](../../)

产品API  
[支付宝API](/docs/ac/ams/api)  
在线支付  
店内支付  
支付  
退款  
[退款](/docs/ac/ams/refund)  
[查询退款](/docs/ac/ams/ir)  
注册  
退款
======  
2023-11-09 09:33  
POST /v1/payments/refund  
使用**退款** API 对成功支付进行同步或异步退款。

结构
======

消息由头部和主体组成。以下部分专注于主体结构。头部结构请参见：

*   [请求头](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [响应头](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)

**注意**：除数组外，每个字段的数据类型应设置为字符串。这意味着必须使用双引号（" "）包围字段值。示例：

*   如果字段的数据类型为Integer，其值为20，设置为"20"。
*   如果字段的数据类型为Boolean，其值为true，设置为"true"。
### 请求参数  
显示全部  
#### refundRequestId 字符串  必需  
商家为退款请求分配的唯一标识ID。  
关于此字段的更多信息：  
*   这是一个API幂等性字段。商家使用refundRequestId字段进行幂等性控制。对于使用相同refundRequestId值发起并达到最终状态（S或F）的支付请求，应返回相同的结果。
*   最大长度：64个字符  
#### paymentId 字符串  必需  
支付宝为原始支付分配的唯一标识ID。  
关于此字段的更多信息：  
*   最大长度：64个字符  
#### referenceRefundId 字符串  
商家直接向客户提供商品或服务时，为退款分配的唯一标识ID。  
关于此字段的更多信息：  
*   最大长度：64个字符  
#### refundAmount Amount对象  必需  
商家发起的退款金额。  
显示子参数  
#### refundReason 字符串  
退款原因  
关于此字段的更多信息：  
*   最大长度：256个字符
### 响应参数  
显示全部  
#### result 结果对象 **必需**  
请求结果，包含状态和错误代码信息。  
显示子参数  
#### refundRequestId 字符串  
商家为识别退款请求而分配的唯一ID。  
关于此字段的更多信息：  
*   最大长度：64个字符  
#### refundId 字符串  
支付宝为识别退款分配的唯一ID。_refundId_ 与 _refundRequestId_ 之间存在一对一对应关系。  
关于此字段的更多信息：  
*   最大长度：64个字符  
#### paymentId 字符串  
原始支付的支付宝分配的唯一ID，即将被退款。  
关于此字段的更多信息：  
*   最大长度：64个字符  
#### refundAmount 金额对象  
支付执行者为此次退款收取的退款金额。  
显示子参数  
#### refundTime 日期时间  
退款成功或失败的最终状态的日期和时间。  
关于此字段的更多信息：  
*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。  
#### grossSettlementAmount 金额对象  
总结算金额，等于交易金额乘以 _settlementQuote_ 的值。  
注意：当结算货币与交易货币相同时，此字段为空。  
显示子参数  
#### settlementQuote 汇率对象  
交易时结算货币与交易货币之间的汇率，仅在锁定汇率的情况下提供。  
注意：当结算货币与交易货币相同时，此字段为空。  
显示子参数  
API 探索器
### 请求  
URL  
北美地区  
https://open-na-global.alipay.com/ams/api/v1/payments/refund  

请求体  
复制  
1  
2  
3  
4  
5  
6  
7  
8  
{  
"paymentId": "20181129190741010007000000XXXX",  
"refundRequestId": "20181129190741020007000000XXXX",  
"refundAmount": {  
"value": "100",  
"currency": "USD"  
}  
}  

请注意，以上内容为示例，实际请求中请替换为真实数据。请求是向北美地区的支付宝开放平台发起一个退款请求，其中包含支付ID（paymentId）、退款请求ID（refundRequestId）以及退款金额（refundAmount），金额单位为美元（USD）。
### 响应  
响应体  
复制  
1  
2  
3  
4  
5  
6  
7  
8  
9  
10  
11  
12  
13  
14  
15  
{  
"result": {  
"resultCode": "SUCCESS",  
"resultStatus": "S",  
"resultMessage": "成功"  
},  
"refundAmount": {  
"value": "100",  
"currency": "USD"  
},  
"refundTime": "2020-10-10T12:01:01+08:30",  
"paymentId": "20181129190741010007000000XXXX",  
"refundRequestId": "20181129190741020007000000XXXX",  
"refundId": "40181129190741020007000000XXXX"  
}  
请注意：此文档的其余部分被省略，因为它是重复的示例数据或无关的填充内容。通常，这部分会包含有关关键参数的附加信息。例如：  
-----------------  
此部分提供了关于关键参数的更多详细信息。请参阅以下列表：  
*   _refundRequestId_: 退款请求ID，用于追踪退款操作。
退款可以是全额或部分退款。只要总退款金额小于或等于原始交易金额，一个交易可以有多次退款。如果超出退款时间窗口，退款请求将被拒绝。如果遇到超时或返回的_resultStatus_为U，可以使用相同的_refundRequestId_重试退款。

*   _refundId:_
    该参数可用于退款查询。

结果处理逻辑
--------------------

针对不同的请求结果，需要执行不同的操作。详细如下：

*   如果_result.resultStatus_的值为S，对于同步退款，退款成功。对于异步退款，退款请求已成功处理，商家可以调用[**inquiryPayment**](https://global.alipay.com/docs/ac/ams/paymentri)接口查询退款结果。
*   如果_result.resultStatus_的值为F，退款失败。通常，失败是因为在退款时间窗口之外发起退款（_result.resultCode_ = FREFUND_WINDOW_EXCEED）。如果仍需处理退款，需要人工介入。
*   如果_result.resultStatus_的值为U，结果未知。可能是由于系统或网络问题导致处理失败。商家可以使用相同的_refundRequestId_进行重试。
### 结果/错误代码  
| 代码 | 值 | 消息 | 进一步行动 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 退款成功，无需进一步操作。 |
| ACCESS\_DENIED | F | 访问被拒绝。 | 联系支付宝技术支持获取详细原因。 |
| CLIENT\_INVALID | F | 客户端无效。 | 检查\_clientId\_是否正确。 |
| CURRENCY\_NOT\_SUPPORT | F | 货币不支持。 | 使用合同中约定的货币。 |
| MEDIA\_TYPE\_NOT\_ACCEPTABLE | F | 服务器不支持客户端可接受的媒体类型。 | 检查媒体类型是否正确。 |
| MULTIPLE\_REFUNDS\_NOT\_SUPPORTED | F | 不支持多次退款。 | 检查是否存在多次退款。 |
| MERCHANT\_BALANCE\_NOT\_ENOUGH | F | 商户余额不足。 | 商户余额充足后再次调用接口。重试时需更改\_refundRequestId\_\_字段。 |
| METHOD\_NOT\_SUPPORTED | F | 服务器不支持请求的HTTP方法。 | 检查HTTP方法是否正确。 |
| ORDER\_IS\_CANCELED | F | 交易已取消。 | 交易已取消，无法退款。 |
| ORDER\_NOT\_EXIST | F | 订单不存在。 | 检查\_paymentId\_是否正确。 |
| ORDER\_STATUS\_INVALID | F | 订单状态无效。 | 检查订单状态。 |
| REFUND\_AMOUNT\_EXCEED | F | 退款总额超过支付金额。 | 确认退款总额是否超过支付金额。 |
| REFUND\_WINDOW\_EXCEED | F | 退款日期超过合同约定的退款期限。 | 确认退款日期是否超过退款期限。 |
| REPEAT\_REQ\_INCONSISTENT | F | 重复请求不一致。 | 使用唯一的\_refundRequestId\_重新发起退款。 |
要查看文档的最新更新，请访问[发行说明](https://global.alipay.com/docs/releasenotes)。  
![图片 3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片 4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)  
@2024 蚂蚁金服 [法律信息](https://global.alipay.com/docs/ac/platform/membership)  
#### 这个页面是否有帮助？