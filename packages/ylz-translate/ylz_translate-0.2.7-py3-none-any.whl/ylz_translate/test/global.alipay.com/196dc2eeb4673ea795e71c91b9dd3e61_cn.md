创建支付会话 (EasySafePay) | 产品API | 支付宝文档
==================

[![支付宝，中国领先的第三方在线支付解决方案](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg) ![支付宝，中国领先的第三方在线支付解决方案](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Fcreatepaymentsession_easypay)  
[返回首页](../../)

产品API  
[支付宝API](/docs/ac/ams/api)  
在线支付  
授权  
安全存储  
支付  
[咨询（结账支付）](/docs/ac/ams/consult?pageVersion=49)  
[支付（结账支付）](/docs/ac/ams/payment_cashier?pageVersion=179)  
[创建支付会话（结账支付）](/docs/ac/ams/session_cashier)  
[扣款（结账支付）](/docs/ac/ams/capture)  
[支付（自动扣款）](/docs/ac/ams/payment_agreement)  
[创建支付会话（EasySafePay）](/docs/ac/ams/createpaymentsession_easypay)  
[支付通知](/docs/ac/ams/paymentrn_online?pageVersion=69)  
[扣款通知（结账支付）](/docs/ac/ams/notify_capture)  
[查询支付](/docs/ac/ams/paymentri_online?pageVersion=74)  
[取消支付](/docs/ac/ams/paymentc_online?pageVersion=30)  
订阅  
争议  
退款  
申报  
店内支付  
创建支付会话 (EasySafePay)
==================================

2024-05-09 06:39  
POST /v1/payments/createPaymentSession  

**createPaymentSession** API 用于生成客户端SDK的支付会话。API响应提供加密的会话数据，可用于启动客户端SDK。这个SDK简化了支付流程，免去了手动调用多个API的麻烦。

结构
==========

消息由头和体组成。以下部分关注体的结构。头的结构请参考：
*   [请求头](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [响应头](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)  

**注意**：除数组外，每个字段的数据类型都设置为字符串。这意味着字段值必须用双引号（" "）括起来。例如：
*   如果字段的数据类型是Integer，值为20，应设置为"20"。
*   如果字段的数据类型是Boolean，值为`true`，应设置为"true"。
### 请求参数  
显示全部  
#### productCode 字符串  必需  
表示正在使用的支付产品。值固定为 `AGREEMENT_PAYMENT`。  
#### productScene 字符串  必需  
值固定为 `EASY_PAY`，表示易安付支付。  
关于此字段的更多信息  
*   最大长度：32 个字符  
#### paymentRequestId 字符串  必需  
商家为标识支付请求分配的唯一ID。  
关于此字段的更多信息  
*   最大长度：64 个字符  
#### order Order 对象  必需  
订单信息，如买家、商家、商品、金额、配送信息和购买环境。此字段用于以下目的：  
*   在支付过程中，主要用于支付宝的风险控制或反洗钱。
*   支付完成后，用于购买追踪和监管报告等记录和报告。  
显示子参数  
#### paymentAmount Amount 对象  必需  
商家在订单货币中请求收取的支付金额。  
显示子参数  
#### paymentMethod PaymentMethod 对象  必需  
商家或收单机构用于收取支付的支付方式。  
显示子参数  
#### paymentRedirectUrl URL  必需  
支付完成后，用户将被重定向到的商家页面URL。  
关于此字段的更多信息  
*   最大长度：2048 个字符  
#### paymentNotifyUrl URL  必需  
用于接收支付结果通知的URL。  
关于此字段的更多信息  
*   最大长度：2048 个字符  
#### settlementStrategy SettlementStrategy 对象  必需  
支付请求的结算策略。  
显示子参数  
#### env Env 对象  
订单创建环境的相关信息。  
显示子参数  
#### agreementInfo AgreementInfo 对象  
易安付支付的授权信息。  
仅在首次进行易安付支付时指定此参数以获取访问令牌。  
显示子参数  
#### paymentSessionExpiryTime 日期时间  
支付会话过期的具体日期和时间。默认过期时间为会话创建后1小时。例如，如果会话在2023-7-27T12:00:01+08:30创建，那么会话过期时间为2023-7-27T13:00:01+08:30。  
如果要使用不同于默认时间的支付会话过期时间，请指定此参数。指定的过期时间必须在会话创建后0到1小时之间。  
关于此字段的更多信息  
*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。
### 响应参数  
显示全部  
#### result 结果对象 **必需**  
API调用的结果。  
显示子参数  
#### paymentSessionId 字符串 **必需**  
由支付宝分配的用于标识支付会话的加密ID。  
关于此字段的更多信息  
*   最大长度：64个字符  
#### paymentSessionData 字符串 **必需**  
加密的支付会话数据。将数据传递给前端以启动客户端SDK。  
关于此字段的更多信息  
*   最大长度：4096个字符  
#### paymentSessionExpiryTime 日期时间 **必需**  
支付会话过期的日期和时间。  
关于此字段的更多信息  
*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。  
API探索器  
示例代码在沙箱中运行
### 请求  
URL  
北美地区  
https://open-na-global.alipay.com/ams/api/v1/payments/createPaymentSession  

场景  
授权成功后的支付  

请求体  
复制  
1  
2  
3  
4  
5  
6  
7  
8  
9  
10  
11  
12  
13  
14  
15  
16  
17  
18  
19  
20  
21  
22  
23  
24  
25  
26  
27  
28  
29  
30  
31  
32  
{  
"settlementStrategy": {  
"settlementCurrency": "USD"  
},  
"productCode": "AGREEMENT\_PAYMENT",  
"productScene": "EASY\_PAY",  
"paymentNotifyUrl": "http://debug1688017773824.test.alipay.net:9090/amsdemo  
/record/notify?env=main\_online&paymentMethodType=ALIPAY\_CN",  
"paymentRequestId": "paymentRequestId001",  
"paymentRedirectUrl": "http://debug1688017773824.test.alipay.net:9090/amsdemo  
/result",  
"paymentMethod": {  
"paymentMethodType": "ALIPAY\_CN"  
},  
"agreementInfo": {  
"authState": "authState001",  
"userLoginId": "userLoginId001"  
},  
"paymentAmount": {  
"currency": "CNY",  
"value": "100"  
},  
"order": {  
"orderAmount": {  
"currency": "CNY",  
"value": "100"  
},  
"referenceOrderId": "referenceOrderId001",  
"orderDescription": "orderDescription001",  
"buyer": {  
"referenceBuyerId": "referenceBuyerId001"  
}  
}  
}  

注：由于原文档中存在大量重复的“הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה
### 响应  
响应体  
复制  
1  
2  
3  
4  
5  
6  
7  
8  
9  
10  
{  
"paymentSessionData": "UNvjVWnWPXJA4BgW+vfjsQj7PbOraafHY19X+6EqMz6Kvvmsdk  
+akdLvoShW5avHX8e8J15P8uNVEf/PcCMyXg==&&SG&&111",  
"paymentSessionExpiryTime": "2023-04-06T03:28:49+08:00",  
"paymentSessionId": "UNvjVWnWPXJA4BgW+vfjsQj7PbOraafHY19X+6EqMz6Ikyj9FPVUOpv  
+DjiIZqMe",  
"result": {  
"resultCode": "SUCCESS",  
"resultMessage": "成功。",  
"resultStatus": "S"  
}  
}  
请注意：此文本为示例，实际内容已被替换为“XXXXXXXX”以保护隐私和安全。  
更多信息
----------------  
关于 `_order` 字段：支付宝不会验证 `_order` 字段中的金额与支付请求中的金额是否一致，也不会用于资金操作。该字段主要用于风险控制、监管、监管报告以及消费记录展示。如果需要支付宝提供的风险控制能力，请使用 `_env` 字段。  
_order_ 字段示例  
复制  
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
### 结果/错误代码  
| 代码 | 值 | 消息 | 进一步操作 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 支付会话创建成功。不需要进一步操作。 |
| PARAM\_ILLEGAL | F | 必需参数未传递，或存在非法参数。例如，非数字输入，无效日期，或参数长度和类型错误。 | 检查并确认当前API的必需请求字段（包括头部字段和正文字段）是否正确传递并有效。 |
| PROCESS\_FAIL | F | 发生了一般业务错误。 | 不要重试。通常需要人工干预。建议联系支付宝技术支持解决问题。 |
| UNKNOWN\_EXCEPTION | U | 由于未知原因，API调用失败。 | 重新调用接口以解决问题。如果未解决，联系支付宝技术支持。 |

![图片3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)  
@2024 支付宝 [法律信息](https://global.alipay.com/docs/ac/platform/membership)  
#### 这个页面有帮助吗？