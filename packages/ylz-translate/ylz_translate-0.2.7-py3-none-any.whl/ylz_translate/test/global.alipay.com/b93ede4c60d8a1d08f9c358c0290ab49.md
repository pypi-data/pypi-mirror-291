Web/WAP | Checkout Payment | Alipay Docs
===============
                        

[![Image 1: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![Image 2: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[Log In](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fcashierpay%2Fembeded_webwap_en)

[Go to Homepage](../../)

Checkout Payment

[Overview](/docs/ac/cashierpay/overview)

Accept payments

After payments

Payment methods

Other resources

Advanced features

[Pre-front solutionAPI](/docs/ac/cashierpay/prefront)

[Buy now pay laterAPI](/docs/ac/cashierpay/bnpl)

[Card vaultingAPI](/docs/ac/cashierpay/cv)

[Card vaultingSDK](/docs/ac/cashierpay/cvsdk)

[Card payment featuresAPISDK](/docs/ac/cashierpay/mf)

Web/WAP
=======

In this topic, you will learn how to integrate the embedded payment experience SDK into a web or WAP client, allowing you to render cashier pages in computer and mobile browsers.

Prerequisites

Before integrating the card payment SDK, familiarize yourself with the [Integration guide](https://global.alipay.com/docs/integration) and [Overview](https://global.alipay.com/docs/ac/ams/api_fund). This will enable you to understand the steps for integrating server APIs and notes for calling the APIs. Also, ensure that you have completed the following tasks:

*   Obtain a client ID in Antom Dashboard.
*   Configure keys properly in Antom Dashboard.
*   Install npm (Node Package Manager).
*   Properly handle compatibility issues: Provide corresponding polyfills for Internet Explorer and other old browser versions. We recommend that you use [babel-preset-env](https://babeljs.io/docs/en/babel-preset-env) to address browser compatibility issues when you build a project.
*   Use the following recommended browser versions:​
    *   For mobile browsers:
        *   iOS 11 and later
        *   Android 5.0 and later
    *   For computer browsers:



| [卡支付 SDK 集成](http://godban.github.io/browsers-support-badges/)**Edge** | [卡支付 SDK 集成](http://godban.github.io/browsers-support-badges/)**Firefox**Last 2 versions | [卡支付 SDK 集成](http://godban.github.io/browsers-support-badges/)**Chrome**Last 2 versions | [卡支付 SDK 集成](http://godban.github.io/browsers-support-badges/)**Safari**Last 2 versions | [卡支付 SDK 集成](http://godban.github.io/browsers-support-badges/)**Opera**Last 2 versions | [卡支付 SDK 集成](http://godban.github.io/browsers-support-badges/)**Electron**Last 2 versions |
| --- | --- | --- | --- | --- | --- |



Integration steps

Integrate the SDK by following steps:

1

Integrate the SDK package

Client side

You can use one of the following methods to add an SDK package:

*   Use the npm package manager: enter the install command in the command line interface.
*   Use CDN resources: use the <script> tag in an HTML file.

Add the SDK package by using npm.

Shell

1

npm install @alipay/ams\-checkout

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Add the SDK package by using CDN resources.

HTML

1

<script src\="https://sdk.marmot

    \-cloud.com/package/ams

    \-checkout/1.10.1/dist/umd

    /ams-checkout.min.js"

    \></script\>

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

2

Create an SDK instance by using the `AMSCashierPayment`:

Client side

1.  Create a _config_ object: Required. The object must contain all of the following configuration parameters:
    *   _locale_: Optional. String type. The merchant client recognizes the language type used by the user's browser and specifies the browser's multilingual information. The SDK provides corresponding language pages based on this information. Valid values are listed as follows. If any other values are specified, English will be used as the default language:
        *   `en_US`: English
            
        *   `pt_BR`: Portuguese
            
        *   `ko_KR`: Korean
            
        *   `es_ES`: Spanish
            
    *   _environment_: A Required string used to specify environmental information. Valid values are:
        *   `sandbox`: sandbox environment
        *   `prod`: production environment
    *   _analytics_: An optional object used to configure and analyze data and contains the following value:
        *   _enabled_: An optional Boolean. It defaults to `true`, which indicates that you allow the SDK to upload and analyze operational data to deliver a better service. If you do not allow the data to be uploaded and analyzed, set it as `false`.
    *   `onLog`: Optional. It is a callback method that is used to generate the error information about log and API exceptions during the execution of the SDK.
    *   `onEventCallback`: Optional. A callback function returns a specific event code when a payment event happens during SDK runtime, like payment result or a form submission error. For further information, please refer to the References.
    *   `onError`: Optional. Triggered when an error occurs during SDK usage (initialization exception, network timeout, etc.). Refer to the SDK error code for more details.
2.  Instantiate the `AMSCashierPayment` method.

**Note**: The environment set by _environment_ should be consistent with the environment in which you call the **createPaymentSession** API in step 3.

Obtain the browser language.

Javascript

1

2

let language \= navigator

    .language || navigator

    .userLanguage;

language \= language.replace("-",

    "\_"); // Replace "-" with

    "\_"

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Create an SDK instance for the npm and CDN package importing method:

npm

CDN

1

2

3

4

5

6

7

8

9

10

11

12

import { AMSCashierPayment }

    from '@alipay/ams-checkout'

    // Package management

const checkoutApp \= new

    AMSCashierPayment({

environment: "sandbox",

locale: "en\_US",

analytics: {

enabled: true

},

onLog: ({code, message})\=>{},

onEventCallback: ({code,

      result})\=>{},

onError: ({code, message}

      )\=>{}

});

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

3

Initiate a **createPaymentSession** request

Client side

For the buyer's unbound card payment and the token payment mode after the card has been bound, operate them separately as follows:

**Unbound card mode:**

If the buyer is not bound to a bank card, your client needs to monitor the buyer's card payment method selection event. After monitoring the buyer’s choice of card payment method, the merchant server initiates a [**createPaymentSession**](https://global.alipay.com/docs/ac/ams/session_cashier) request to the Alipay server.

Once the response to the **createPaymentSession** request is received, use the value of _paymentSessionData_ in Step 4.

**Card token mode**:

After the buyer selects the bound card payment method as the payment method, your client monitors the click event of the checkout button. When the buyer selects the payment method and clicks the card binding button, the merchant server initiates the **createPaymentSession** request to the Alipay server.

In card token mode, you need to specify the _paymentMethod.paymentMethodId_ field to the card token returned to you by Alipay after the buyer binds the card. Obtain the card token through the _paymentResultInfo.cardToken_ field in the payment result notification sent to you by Alipay or the response to actively query the payment result.

Once the response to the **createPaymentSession** request is received, use the value of _paymentSessionData_ in Step 4.

The following createPaymentSession request examples only include the required fields and some optional fields:

JSON: No card bound

JSON: Token payment

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21

22

23

24

25

26

27

28

29

30

31

32

33

34

35

36

37

38

39

40

41

42

43

44

45

46

47

48

49

50

51

52

53

54

{

"order": {

"buyer": {

"buyerName": {

"firstName": "\*\*\*\*\*",

"fullName": "D\*\*\*u",

"lastName": "Liu",

"middleName": "Skr"

},

"buyerRegistrationTime":

          "2022-01-01T09:30:00+08

          :00",

"referenceBuyerId": "tony.c"

},

"goods": \[{

"goodsBrand": "AMSDM",

"goodsCategory": "card/ssr

          /adc",

"goodsName": "Goods No.1",

"goodsQuantity": "1",

"goodsSkuName": "SKU1",

"goodsUnitAmount": {

"currency": "USD",

"value": "10000"

},

"goodsUrl": "HangZhou

          LeiFenTa",

"referenceGoodsId":

          "amsdm\_good\_tony\_c\_202302

          27\_095825\_922"

}\],

"orderAmount": {

"currency": "BRL",

"value": "2129"

},

"orderDescription":

        "AMSDM\_GIFT",

"referenceOrderId":

        "amsdmorder\_tony\_c\_20230227

        \_095825\_921"

},

"paymentAmount": {

"currency": "BRL",

"value": "2129"

},

"paymentFactor": {

"isAuthorization": true

},

"paymentMethod": {

"paymentMethodType": "CARD",

"paymentMethodMetaData":{

"paymentMethodRegion":"BR"

}

},

"paymentNotifyUrl": "https://www

      .google.com.sg",

"paymentRedirectUrl": "https

      ://www.baidu.com",

"paymentRequestId":

      "amsdmpayk\_tony\_c\_20230227\_09

      5825\_920\_532",

"productCode": "CASHIER\_PAYMENT",

"settlementStrategy": {

"settlementCurrency": "USD"

},

"enableInstallmentCollection"

      :"true"

}

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Response example for the createPaymentSession request:

JSON

1

2

3

4

5

6

7

8

9

10

{

"paymentSessionData":

      "UNvjVWnWPXJA4BgW

      +vfjsQj7PbOraafHY19X

      +6EqMz6Kvvmsdk

      +akdLvoShW5avHX8e8J15P8uNVEf

      /PcCMyXg==&&SG&&111",

"paymentSessionExpiryTime": "2023

      \-04-06T03:28:49Z",

"paymentSessionId":

      "UNvjVWnWPXJA4BgW

      +vfjsQj7PbOraafHY19X

      +6EqMz6Ikyj9FPVUOpv+DjiIZqMe"

      ,

"result": {

"resultCode": "SUCCESS",

"resultMessage": "success.",

"resultStatus": "S"

}

}

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

4

Create a payment element collection component using the `mountComponent` method in the instance object:

Client side

*   Create a configuration object using the _sessionData_ parameter: Specify the complete data of the _paymentSessionData_ field obtained in the response of the **createPaymentSession** request into the _sessionData_ parameter.
*   Call the `mountComponent` method in the instance object, returning `Promise` with the component instance object obtained using this method. The payment block DOM node renders the Binding Elements collection view based on the environment parameters and inserts it into the current page.
    *   _appearance_: Optional. Object type for customized appearance theme configuration, and it contains the following child parameters:
        *   _showLoading_: Optional. Boolean type. The default value is `true`, which shows the default loading animation. If you don't use the default loading animation, you need to specify this value as `false`.
        *   _showSubmitButton_: Optional. Boolean type. The default value is `false`, which indicates that the payment button for component rendering is not enabled. If the value is `false`, the `submit` method of the instance object should be called to trigger the submit button process.​
    *   _notRedirectAfterComplete_: Optional, Boolean type. The default value is `false`, which means it will redirect back to your page after the payment is completed. The same applies when the value is empty. `true` value means there will be no redirect after the payment is completed. You need to use the customer event code to control the card binding to complete the subsequent process. Note that the payment result event code returned by the client is only used as a reference for the redirect operation of the client page. For transaction status updates, refer to the results returned by the server's **notifyPayment** or **inquiryPayment** API.
*   Call the `submit` method triggers the card-binding submission process, and the return value is a `Promise` that returns a specific event code. These event codes are also returned by events such as `onError` or `onEventCallback`.
*   If you need to specify pre-collected billing address information for AVS validation, you can configure the following parameters to be specified via the `submit` method.
    *   _billingAddress_: Optional Object. Billing address information is used to identify and locate the user. It contains the following parameters:
        *   _region_: Required. String (2). [ISO 3166](https://www.iso.org/obp/ui/#search) compliant 2-digit country code.
        *   _state_: Optional. String (8). The name of the state, country, or province.
        *   _city_: Optional. String (32). Name of the city, region, suburb, town or village.
        *   _address1_: Optional. String (256). Address line 1, e.g., street address, P.O. Box, and company name.
        *   _address2_: Optional. String (256). Address line 2, e.g., apartment, suite, unit, and building information.
        *   _zipCode_: Optional. String (32). Zip code.
*   Recycle resources of the SDK component by calling the `unmount` method in the instance object. You need to call the method in the following cases:
    *   When the user switches views to exit the checkout page, free the component resources created in the **createPaymentSession**.
    *   When the user initiates multiple payments, free the component resources created in the previous **createPaymentSession**.
    *   When the user completes the payment and sets _notRedirectAfterComplete_ to `true`, free the component resources after obtaining specific payment result codes.

Call the createComponent:

JavaScript

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21

22

23

24

async function create

    (sessionData) {

await checkoutApp

      .mountComponent({

sessionData:sessionData,

appearance:{

showLoading: true, //

          Default is true,

          allowing

          configuration of

          whether to display a

          loading animation.

showSubmitButton: false,

          // Configure whether

          the payment button is

          rendered by the

          component.

},

notRedirectAfterComplete:

        true,

},'#ContainerNodeId');

}

// The user inputs address

    information and stores it

    in the billingAddress

    object for subsequent

    submissions.

const billingAddress \= {

region: '',

address1: '',

address2: '',

city: '',

state: '',

zipCode: ''

}

checkoutApp.submit

    ({billingAddress}).then

    (({code, message})\=>{})

// Free SDK component resources

checkoutApp.unmount();

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

References

The References offer callback event codes and integration key step code examples. For further details, please refer to the [References](https://global.alipay.com/docs/ac/cashierpay/references).

#### Is this page helpful?

To view the latest updates to the documentation, visit [Release notes](https://global.alipay.com/docs/releasenotes).

![Image 9](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png)![Image 10](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 Alipay [Legal Information](https://global.alipay.com/docs/ac/platform/membership)