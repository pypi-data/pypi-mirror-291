Capture | Checkout Payment | Alipay Docs
===============
                        

[![Image 1: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![Image 2: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[Log In](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fcashierpay%2Fcapture)

[Go to Homepage](../../)

Checkout Payment

[Overview](/docs/ac/cashierpay/overview)

Accept payments

After payments

Payment methods

Other resources

Advanced features

[Pre-front solutionAPI](/docs/ac/cashierpay/prefront)

[Buy now pay laterAPI](/docs/ac/cashierpay/bnpl)

[Card vaultingAPI](/docs/ac/cashierpay/cv)

[Card vaultingSDK](/docs/ac/cashierpay/cvsdk)

[Card payment featuresAPISDK](/docs/ac/cashierpay/mf)

Capture
=======

2024-04-07 11:37

By default, Alipay+ automatically handles funds capture for you. If you specify the value of _paymentFactor.captureMode_ to `MANUAL` when calling the [**pay**](https://global.alipay.com/docs/ac/ams/payment_cashier) API, you must capture the funds of the payment by calling the [**capture**](https://global.alipay.com/docs/ac/ams/capture) API.

*   **Automatic capture**: Alipay+ automatically captures funds immediately after the user authorizes the payment. The capture result is then communicated to you via an asynchronous notification. Automatic capture is activated when one of the following conditions is met:

*   You set the value of _paymentFactor.captureMode_ in the **pay** API to `AUTOMATIC`.
*   You leave the value of _paymentFactor.captureMode_ in the **pay** API empty or you do not pass in this parameter.

*   **Manual capture**: You must initiate fund capture by calling the **capture** API within seven days after successful authorization, otherwise Alipay+ automatically unfreezes the authorized funds of the payment. The total capture amount must be equal to the total authorized amount.

> **Note**: For card payments, it is recommended to confirm the successful capture result before shipping.

Manually initiate a capture request
-----------------------------------

The key request parameters in the **capture** API (**POST/v1/payments/capture**) are shown in the following table:



| **Parameter** | **Description** |
| --- | --- |
| captureRequestId | A unique identifier that you assign to a capture request. |
| paymentId | A unique identifier that Alipay+ assigns to an order. |
| captureAmount | The capture amount, which must be equal to the total authorized amount. |



Table 1. key parameters in the **capture** API

Obtain a capture result  

--------------------------

In the response returned through the **capture** API, the value of the _resultStatus_ parameter indicates the capture result.

*   `S`: The capture is successful.
*   `F`: The capture failed.
*   `U`: You need to obtain the capture result by receiving an asynchronous notification through the **notifyCapture** notification or inquiring about the capture result.

You can handle the response according to the logic shown in the following figure:

![Image 3: 9@3x.png](https://idocs-assets.marmot-cloud.com/storage/idocs87c36dc8dac653c1/1685588281433-62bee106-ef24-4f7c-89f1-c351ee7cbb00.png)

Figure 1. Values of _resultStatus_ in the response

### Asynchronous notification  

You can obtain the capture result by receiving an asynchronous notification through the [**notifyCapture**](https://global.alipay.com/docs/ac/ams/notify_capture) notification. When a final capture status is achieved (that is, when the capture is successful or failed), Alipay+ sends you the asynchronous notification through the **notifyCapture** notification. When you receive the notification, you must return a response as instructed in [Requirements](https://global.alipay.com/docs/ac/ams/paymentrn_online). Otherwise, Alipay+ resends the notification until a correct response is received.

**Key parameters in the asynchronous notification**:



| **Parameter** | **Description** |
| --- | --- |
| notifyType | The value is `CAPTURE_RESULT`. |
| paymentId | The unique identifier that Alipay+ assigns to an order. |
| result | The capture result. |
| acquirerReferenceNo | If you have integrated the capabilities of receiving card payments in Singapore or Hong Kong, the acquirer number is provided in the notification. |



Table 2. Key parameters in the **notifyCapture** notification

**Configure a notification receiving address:**

To receive the asynchronous notification, you must configure the notification address in either of the following two ways:

*   Specify _paymentNotifyUrl_ in the **pay** API.
*   Edit **Notification URL** in the **Integration Settings** tab of Antom Dashboard

#### Inquire about the capture status

The asynchronous notification and the synchronous redirection can both fail to be received or implemented. We recommend that you inquire about the capture status by calling the [**inquiryPayment**](https://global.alipay.com/docs/ac/ams/paymentri_online) API. In the response returned through the **inquiryPayment** API, _transactions_ indicates the capture status. See the following table for details:



| **Parameter** | **Description** |
| --- | --- |
| transactions.transationType | The value is `CAPTURE`. It indicates the capture status. |
| transactions.transactionResult | The capture result. |



Table 3. Key child parameters of _transactions_

The value of _transactions_ indicates the capture status. See the following code samples for details:

The capture is successful

The capture failed

The capture is being processed

copy

    {
        "transactions": [
            {
                "transactionType": "CAPTURE",
                "transactionStatus": "SUCCESS",
                "transactionRequestId": "test_test_test_XXXX",
                "transactionAmount": {
                    "currency": "BRL",
                    "value": "110"
                },
                "transactionId": "2022XXXXXXXX",
                "transactionResult": {
                    "resultStatus": "S",
                    "resultCode": "SUCCESS",
                    "resultMessage": "success"
                }
            }
        ]
    }

copy

    {
        "transactions": [
            {
                "transactionType": "CAPTURE",
                "transactionStatus": "FAIL",
                "transactionRequestId": "test_test_test_XXXX",
                "transactionAmount": {
                    "currency": "BRL",
                    "value": "110"
                },
                "transactionTime": "2022-09-29T07:13:50-07:00",
                "transactionId": "2022XXXXXXXX",
                "transactionResult": {
                    "resultStatus": "F",
                    "resultCode": "PROCESS_FAIL",
                    "resultMessage": "General business failure. No retry."
                }
            }
        ]
    }

copy

    {
        "transactions": [
            {
                "transactionType": "CAPTURE",
                "transactionStatus": "PROCESSING",
                "transactionRequestId": "test_test_test_XXXX",
                "transactionAmount": {
                    "currency": "BRL",
                    "value": "110"
                },
                "transactionId": "2022XXXXXXXX",
                "transactionResult": {
                    "resultStatus": "U",
                    "resultCode": "PAYMENT_IN_PROCESS",
                    "resultMessage": "payment in process"
                }
            }
        ]
    }
      

To view the latest updates to the documentation, visit [Release notes](https://global.alipay.com/docs/releasenotes).

![Image 4](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png)![Image 5](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 Alipay [Legal Information](https://global.alipay.com/docs/ac/platform/membership)

#### Is this page helpful?

#### On this page

[Manually initiate a capture request](#20MEH "Manually initiate a capture request")

[Obtain a capture result](#seO9b "Obtain a capture result")

[Asynchronous notification](#SNrlS "Asynchronous notification")

[Inquire about the capture status](#mlxp0 "Inquire about the capture status")