decide | Card Payment Protection | Alipay Docs
===============
                        

[![Image 1: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![Image 2: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[Log In](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Frisk_control%2Fdecide)

[Go to Homepage](../../)

Card Payment Protection

[Overview](/docs/ac/risk_control/overview)

Integration Guide

APIs

[decide](/docs/ac/risk_control/decide)

[sendPaymentResult](/docs/ac/risk_control/send_payment)

[sendRefundResult](/docs/ac/risk_control/send_refund)

[reportRisk](/docs/ac/risk_control/report_risk)

decide
======

2024-03-08 08:38

POST /v1/risk/payments/decide

Use this API to request Ant's real-time risk management decision of whether to accept or reject a transaction when a buyer pays on your client. This API can be used both before and after the card payment authorization.

Structure
=========

A message consists of a header and body. The following sections are focused on the body structure. For the header structure, see：

*   [Request header](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [Response header](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)

**Note**: Set the data type of each field (except array) as String. This means that you must use double quotation marks (" ") to enclose the field value. Examples:

*   If the data type of a field is Integer and its value is 20, set it as "20".
*   If the data type of a field is Boolean and its value is true, set it as "true".

### Request parameters

Show all

#### referenceTransactionId String  REQUIRED

The unique ID assigned by the merchant that directly provides services or goods to users, to identify a transaction.

More information about this field

*   Maximum length: 64 characters

#### authorizationPhase String  REQUIRED

Indicates the time when the API is called. Valid values are:

*   `PRE_AUTHORIZATION`: indicates that you initiate the **decide** request before the card payment authorization.
*   POST\_AUTHORIZATION : indicates that you initiate the **decide** request after the card payment authorization. 

More information about this field

*   Maximum length: 16 characters

#### orders Array<Order> object REQUIRED

The order information, such as merchant, goods, amount, and shipping information.

More information about this field

*   Maximum size: 10 elements

Show child parameters

#### buyer Buyer object REQUIRED

Buyer information, including the ID, name, phone number, and email of the buyer.

Show child parameters

#### actualPaymentAmount Amount object REQUIRED

Indicates the actual amount the buyer needs to pay after deducting the discount.

Show child parameters

#### paymentDetails Array<PaymentDetail> object REQUIRED

Indicates the details of the payment method, including the payment method type and card information.

More information about this field

*   Maximum size: 5 elements

Show child parameters

#### discountAmount Amount object 

The discounted amount of this transaction.

Providing this information helps to increase the accuracy of fraud detection and improve payment success rates.

Show child parameters

#### env Env object REQUIRED

Information about the environment where the order is placed, such as the device information.

Show child parameters

### Response parameters

Show all

#### decision string  REQUIRED

Risk management decision from Ant. Valid values are:

*   `ACCEPT`: Indicates that Ant advises to accept the payment.
*   `REJECT`: Indicates that Ant advises to reject the payment.

More information about this field

*   Maximum length: 16 characters

#### authenticationDecision String  

The authentication method recommended by Ant. Valid values are:

*   `3D`: 3D authentication is recommended for this transaction.
*   `NON_3D`: Non-3D authentication is recommended for this transaction. 

This parameter is returned when the value of _​decide_​ is ​`ACCEPT`​.

More information about this field

*   Maximum length: 16 characters

#### result Result object REQUIRED

The result of the API call.

Show child parameters

API Explorer

Sample CodesRun in Sandbox

### Request

URL

North America

https://open-na-global.alipay.com/ams/api/v1/risk/payments/decide

Request Body

Copy

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21

22

23

24

25

26

27

28

29

30

31

32

33

34

35

36

37

38

39

40

41

42

43

44

45

46

47

48

49

50

51

52

53

54

55

56

57

58

59

60

61

62

63

64

65

66

67

68

69

70

71

72

73

74

75

76

77

78

79

80

81

82

83

84

85

86

87

88

89

90

91

92

93

94

95

96

97

98

99

100

101

102

103

104

105

106

107

108

{

"referenceTransactionId": "0656237919440001",

"authorizationPhase": "PRE\_AUTHORIZATION",

"orders": \[

{

"orderAmount": {

"currency": "BRL",

"value": 30000

},

"orderDescription": "Cappuccino #grande (Mika's coffee shop)",

"referenceOrderId": "ORDER\_20221114141714891",

"merchant": {

"referenceMerchantId": "SM\_001"

},

"goods": \[

{

"referenceGoodsId": "383382011\_SGAMZ-904520356",

"goodsName": "\[3 Boxes\] Starbucks Cappuccino Milk Coffee Pods / Coffee

              Capsules by Nescafe Dolce Gusto",

"goodsUrl": "https://www.lazada.sg/products/3-boxes-starbucks

              \-cappuccino-milk-coffee-pods-coffee-capsules-by-nescafe-dolce

              \-gusto-i383382011-s904520356.html?clickTrackInfo=undefined&search

              \=1&source=search&spm=a2o42.searchlist.list.3",

"goodsCategory": "Digital Goods/Digital Vouchers/Food and

              Beverages",

"goodsUnitAmount": {

"currency": "BRL",

"value": 30000

},

"deliveryMethodType": "DIGITAL",

"goodsQuantity": "10"

}

\],

"shipping": {

"shippingName": {

"firstName": "Dehua",

"lastName": "Liu",

"fullName": "Dehua Skr Liu",

"middleName": "Skr"

},

"shippingAddress": {

"zipCode": "310000",

"address2": "Xihu",

"city": "Hangzhou",

"address1": "Wuchang road",

"state": "Zhejiang",

"region": "CN"

},

"shippingCarrier": "FedEx",

"shippingPhoneNo": "12345678912",

"shipToEmail": "test@gmail.com"

}

}

\],

"buyer": {

"referenceBuyerId": "test12345678",

"buyerPhoneNo": "12345678912",

"buyerEmail": "alipay@alipay.com",

"buyerName": {

"firstName": "Dehua",

"lastName": "Liu",

"fullName": "Dehua Skr Liu",

"middleName": "Skr"

},

"isAccountVerified": true,

"successfulOrderCount": 100

},

"actualPaymentAmount": {

"currency": "BRL",

"value": 29500

},

"paymentDetails": \[

{

"amount": {

"currency": "BRL",

"value": "30000"

},

"paymentMethod": {

"paymentMethodType": "CARD",

"paymentMethodId": "0656XXXXXXX0001",

"paymentMethodMetaData": {

"cpf": "02987654320",

"cardholderName": {

"firstName": "Tom",

"lastName": "Jay"

},

"expiryMonth": "12",

"billingAddress": {

"zipCode": "310000",

"address2": "Xihu",

"city": "Hangzhou",

"address1": "Wuchang road",

"state": "Zhejiang",

"region": "CN"

},

"expiryYear": "29",

"cardNo": "4117347806156383"

}

}

}

\],

"discountAmount": {

"currency": "BRL",

"value": 500

},

"env": {

"terminalType": "APP",

"clientIp": "112.80.248.78",

"deviceId": "eYOIkvFpZzztgO0Yu6USdprBQZCWxDhiUAHCiK8K/cH9mT6wMaMOzAKe",

"osType": "IOS",

"deviceLanguage": "zh\_CN"

}

}

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

### Response

Response Body

Copy

1

2

3

4

5

6

7

8

9

10

{

"decision": "ACCEPT",

"authenticationDecision": "NON\_3D",

"score": 5,

"result": {

"resultCode": "SUCCESS",

"resultMessage": "reviewed success",

"resultStatus": "S"

}

}

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

### Result/Error codes

| Code | Value | Message | Further action |
| --- | --- | --- | --- |
| SUCCESS | S | Success | The API is called successfully, no further action is needed.
 |
| ACCESS\_DENIED | F | Access is denied. | Contact Alipay Technical Support for detailed reasons.

 |
| INVALID\_API | F | The called API is invalid or not active. | Contact Alipay Technical Support to resolve the issue.

 |
| INVALID\_CONTRACT | F | The parameter values in the contract do not match those in the current transaction. | Check whether the parameter values in the contract match those in the current transaction. If the values match, contact Alipay Technical Support to troubleshoot the issue.

 |
| KEY\_NOT\_FOUND | F | The private key or public key of Alipay or the merchant is not found. | Check whether the private key or public key exists. If not, upload the private key in Alipay Developer Center.

 |
| MERCHANT\_KYB\_NOT\_QUALIFIED | F | The payment failed because of the merchant's KYB status. The merchant is either not KYB compliant, or the KYB status is not qualified for this transaction. | Contact Alipay Technical Support for detailed reasons.

 |
| MERCHANT\_NOT\_REGISTERED | F | The merchant is not registered. | Please register the merchant by using the registration interface. Contact Alipay Technical Support if failed to call the registration interface.

 |
| NO\_INTERFACE\_DEF | F | API is not defined. | Check whether the URL is correct. Please refer to the endpoint in the API documentation.

 |
| REQUEST\_TRAFFIC\_EXCEED\_LIMIT | U | The request traffic exceeds the limit. | Call the interface again to resolve the issue. If not resolved, contact Alipay Technical Support.

 |
| PARAM\_ILLEGAL | F | The required parameters are not passed, or illegal parameters exist. For example, a non-numeric input, an invalid date, or the length and type of the parameter are wrong. | Check and verify whether the required request fields (including the header fields and body fields) of the current API are correctly passed and valid.

 |
| SYSTEM\_ERROR | F | A system error occurred. | Do not retry, and contact Alipay Technical Support for more details.

 |
| UNKNOWN\_EXCEPTION | U | An API call has failed, which is caused by unknown reasons. | Call the interface again to resolve the issue. If not resolved, contact Alipay Technical Support.

 |

To view the latest updates to the documentation, visit [Release notes](https://global.alipay.com/docs/releasenotes).

![Image 3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png)![Image 4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 Alipay [Legal Information](https://global.alipay.com/docs/ac/platform/membership)

#### Is this page helpful?