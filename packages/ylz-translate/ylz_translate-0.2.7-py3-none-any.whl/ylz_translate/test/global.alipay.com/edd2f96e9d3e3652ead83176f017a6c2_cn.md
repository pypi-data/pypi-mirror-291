服务模拟 | 服务与工具 | 支付宝文档
===============

[![图片1：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)](/docs/) [![图片2：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Ftool%2Fmocking)  
[返回首页](../../)

服务与工具  
[沙箱环境](/docs/ac/tool/sandbox)  
[服务模拟](/docs/ac/tool/mocking)  
[iDiagnose](/docs/ac/tool/idiagnose)  
[iValidate](/docs/ac/tool/ivalidate)  
[密钥对生成与验证](/docs/ac/tool/key_pair)  
[小程序](/docs/ac/tool/miniapp)  

服务模拟
===============

2021-02-26 07:47

什么是模拟服务
----------------------

模拟服务提供不同支付结果的模拟，帮助您提前熟悉可能的支付场景。在沙箱环境中，您可以测试带有不同响应类型的失败支付流程，学习处理异常情况。模拟服务旨在优化您的异常和错误处理能力，从而提高支付宝集成的质量，降低成本并提升用户体验。

以前，许多异常场景难以或甚至无法模拟。使用模拟服务，您可以针对所有场景运行测试用例，检查响应是否符合预期。除了默认的模拟规则，您还可以根据业务需求自定义异常场景的模拟规则。目前，模拟服务支持支付、取消、退款和查询的流程。

如何使用模拟服务
-------------------------
在使用模拟服务之前，您需要拥有一个支付宝商户账户。请访问[支付宝门户](https://global.alipay.com/)进行注册。

以下视频解释了如何使用模拟服务：

1. 登录您的[sandbox测试环境](https://isandbox.alipaydev.com/user/intlAccountDetails.htm)，然后进入模拟服务部分。目前，模拟服务支持以下4个API：
   * `alipay.acquire.oversears.spot.pay`
   * `alipay.acquire.cancel`
   * `alipay.acquire.overseas.spot.refund`
   * `alipay.acquire.overseas.query`
   ![图片3：服务模拟](https://gw.alipayobjects.com/zos/rmsportal/CEXFojZmnShGsmigpPcH.png)
2. 通过指定模拟API请求和相应的响应来配置模拟规则。
   每个API有两种类型的模拟规则：默认规则和自定义规则。
   * 默认规则适用于所有沙箱测试账户。您无需进行任何配置即可使默认规则生效。
   * 自定义规则允许您根据业务需求指定条件和预期响应。
   ![图片4：服务模拟](https://gw.alipayobjects.com/zos/rmsportal/nKCSMVmySddKksEzhWdc.png)
3. 发送匹配指定模拟规则的API请求。您将收到相应的模拟响应，然后对其进行处理。例如，您可以使用以下模拟规则发送`alipay.acquire.overseas.spot.pay`请求。详细信息见下面的示例代码和对应的模拟响应。默认模拟规则：
   ![图片5：服务模拟](https://gw.alipayobjects.com/zos/rmsportal/lFKtselIDRqgeTVgpAJn.jpg)
4. 示例
   --------

请注意，由于这是一个Markdown格式的文档，实际的代码和响应可能需要在代码编辑器或API测试工具中正确格式化和执行。
### 样例请求  
`http://mapi.alipaydev.com/gateway.do?client_info=%7B%22client_ip%22%3A%2210.20.30.40%22%7D&identity_code_type=barcode&memo=nomemo&trans_amount=9901&sign_type=MD5&trans_name=xxxzgl&buyer_identity_code=288888888888888888&partner_trans_id=8567745904202380&password=SJV88po0XvIptqWGM4rxP5EQ&sendFormat=normal¤cy=USD&sign=6030aea30c96e01c6e5c709c9f66a7df&agreement_info=%7B%22agreement_no%22%3A%22123%22%7D&trans_currency=USD&biz_product=OVERSEAS_MBARCODE_PAY&service=alipay.acquire.overseas.spot.pay&format_type=xml&quantity=1&partner=2088621880270354`

这是一个示例的支付宝接口请求URL，用于海外扫码支付。以下是参数的中文解释：

- `client_info`: 客户端信息，这里包含客户端IP地址（`10.20.30.40`）。
- `identity_code_type`: 身份识别类型，这里是条形码。
- `memo`: 备注，这里没有备注（`nomemo`）。
- `trans_amount`: 交易金额，这里是9901。
- `sign_type`: 签名类型，使用MD5算法。
- `trans_name`: 交易名称，这里是`xxxzgl`。
- `buyer_identity_code`: 买家身份代码，这里是28位数字。
- `partner_trans_id`: 合作方交易ID，这里是`8567745904202380`。
- `password`: 密码，这里是`SJV88po0XvIptqWGM4rxP5EQ`。
- `sendFormat`: 返回格式，这里是普通格式（`normal`）。
- `currency`: 货币类型，这里是美元（`USD`）。
- `sign`: 签名值，用于验证请求的完整性，这里是`6030aea30c96e01c6e5c709c9f66a7df`。
- `agreement_info`: 协议信息，包含协议号（`123`）。
- `trans_currency`: 交易货币，这里是美元（`USD`）。
- `biz_product`: 业务产品，这里是海外扫码支付（`OVERSEAS_MBARCODE_PAY`）。
- `service`: 服务名称，这里是获取海外即时支付（`alipay.acquire.overseas.spot.pay`）。
- `format_type`: 数据格式类型，这里是XML。
- `quantity`: 商品数量，这里是1。
- `partner`: 合作伙伴ID，这里是`2088621880270354`。
### 示例响应
复制
```xml
<alipay>
<is_success>T</is_success>
<request>
<param name="client_info">{"client_ip":"10.20.30.40"}</param>
<param name="quantity">1</param>
<param name="biz_product">OVERSEAS_MBARCODE_PAY</param>
<param name="identity_code_type">barcode</param>
<param name="sign">6030aea30c96e01c6e5c709c9f66a7df</param>
<param name="memo">nomemo</param>
<param name="trans_name">xxxzgl</param>
<param name="trans_amount">9901</param>
<param name="sendFormat">normal</param>
<param name="partner_trans_id">8567745904202380</param>
<param name="password">SJV88po0XvIptqWGM4rxP5EQ</param>
<param name="format_type">xml</param>
<param name="trans_currency">USD</param>
<param name="partner">2088621880270354</param>
<param name="agreement_info">{"agreement_no":"123"}</param>
<param name="service">alipay.acquire.overseas.spot.pay</param>
<param name="currency">USD</param>
<param name="sign_type">MD5</param>
<param name="buyer_identity_code">288888888888888888</param>
</request>
<response>
<alipay>
<error>SYSTEM_ERROR</error>
<result_code>FAILED</result_code>
</alipay>
</response>
<sign>d0117413cdf375ab667329892ab7f890</sign>
<sign_type>MD5</sign_type>
</alipay>
```
要查看文档的最新更新，请访问[发行说明](https://global.alipay.com/docs/releasenotes)。

![图片 6](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片 7](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 蚂蚁金服 [法律信息](https://global.alipay.com/docs/ac/platform/membership)

#### 这个页面是否有帮助？

#### 本页内容
[什么是模拟服务](#4e324c6f "什么是模拟服务")  
[如何使用模拟服务](#3ed0e805 "如何使用模拟服务")  
[示例](#Samples "示例")  
[示例请求](#f3fd40c9 "示例请求")  
[示例响应](#12f475c0 "示例响应")