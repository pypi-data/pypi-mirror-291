pay (Auto Debit) | Product APIs | Alipay Docs
===============
                        

[![Image 1: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![Image 2: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[Log In](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Fpayment_agreement)

[Go to Homepage](../../)

Product APIs

[Alipay APIs](/docs/ac/ams/api)

Online payments

Authorization

Vault

Payment

[consult (Checkout Payment)](/docs/ac/ams/consult)

[pay (Checkout Payment)](/docs/ac/ams/payment_cashier)

[createPaymentSession (Checkout Payment)](/docs/ac/ams/session_cashier)

[capture (Checkout Payment)](/docs/ac/ams/capture)

[pay (Auto Debit)](/docs/ac/ams/payment_agreement)

[createPaymentSession (EasySafePay)](/docs/ac/ams/createpaymentsession_easypay)

[notifyPayment](/docs/ac/ams/paymentrn_online)

[notifyCapture (Checkout Payment)](/docs/ac/ams/notify_capture)

[inquiryPayment](/docs/ac/ams/paymentri_online)

[cancel](/docs/ac/ams/paymentc_online)

Subscription

Dispute

Refund

Declaration

In-store payments

pay (Auto Debit)
================

2024-04-24 07:05

POST /v1/payments/pay

After the user agrees to authorize, use this API to initiate an auto debit payment and process payment results according to the status and operation instructions returned by Alipay.

Structure
=========

A message consists of a header and body. The following sections are focused on the body structure. For the header structure, see：

*   [Request header](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [Response header](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)

**Note**: Set the data type of each field (except array) as String. This means that you must use double quotation marks (" ") to enclose the field value. Examples:

*   If the data type of a field is Integer and its value is 20, set it as "20". 
*   If the data type of a field is Boolean and its value is true, set it as "true". 

### Request parameters

Show all

#### productCode String  REQUIRED

Represents the payment product that is being used, which is stipulated in the contract. . For Auto Debit, the value is fixed as `AGREEMENT_PAYMENT`.

#### paymentRequestId String  REQUIRED

The unique ID that is assigned by a merchant to identify a payment request.

More information about this field

*   This field is an API idempotency field.The merchant uses the paymentRequestId field for idempotency control. For payment requests that are initiated with the same value of paymentRequestId and reach a final status (S or F), the same result is to be returned for the request.
*   Maximum length: 64 characters

#### order Order object REQUIRED

The order information, such as buyer, merchant, goods, amount, shipping information, and purchase environment. This field is used for different purposes:

*   During the payment process, this field is mainly used by Alipay for risk control or anti-money laundering. 
*   After the payment is completed, this field is used for recording and reporting purposes such as purchase tracking and regulatory reporting.

Show child parameters

#### paymentAmount Amount object REQUIRED

The transaction currency, which is a 3-letter currency code that follows the [ISO 4217](https://www.iso.org/iso-4217-currency-codes.html) standard.

Show child parameters

#### paymentMethod PaymentMethod object REQUIRED

The payment method that is used to collect the payment by the merchant or acquirer.

Show child parameters

#### paymentExpiryTime Datetime  

The payment expiration time is a specific time after which the payment will expire and the acquirer or merchant must terminate the order processing. A default payment expiration time is determined by the contract.

Notes:

*   Specify this field if you want to use a payment expiration time that differs from the default time. The specified payment expiration time must be less than one minute after the payment request is sent and must follow the correct format.
*   Usually for Auto Debit, the default payment expiration time in the contract is one minute after the payment request is sent. For example, the request is sent when the time is 2019-11-27T12:00:01+08:30, the payment expiration time is 2019-11-27T12:01:01+08:30.

More information about this field

*   The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard format. For example, "2019-11-27T12:01:01+08:00".

#### settlementStrategy SettlementStrategy object REQUIRED

The settlement strategy for the payment request

Show child parameters

#### creditPayPlan CreditPayPlan object 

The credit payment plan information for this payment.

Note: Specify this field if you want to support installment payment and contact Alipay technical support for details on how to offer installment payments.

Show child parameters

#### appId String  

The unique ID that is assigned by Alipay to identify the mini program app.

Note: Specify this field when _terminalType_ is `MINI_APP`.

More information about this field

*   Maximum length: 32 characters

#### paymentNotifyUrl URL  

The URL that is used to receive the payment result notification.

Note: Specify this field if you want to receive an asynchronous notification of the auto debit result. You can also set the URL to receive the payment result notification in Antom Dashoard. If the payment notification URL is specified in both the request and Antom Dashboard, the value specified in the request takes precedence.

More information about this field

*   Maximum length: 2048 characters

### Response parameters

Show all

#### result Result object REQUIRED

Indicates whether this API is called successfully. If this API is successfully called, an auto debit payment is completed successfully.

Show child parameters

#### paymentRequestId String  

The unique ID that is assigned by a merchant to identify a payment request.

Note: This field is returned when the API is called successfully.

More information about this field

*   Maximum length: 64 characters

#### paymentId String  

The unique ID that is assigned by Alipay to identify a payment.

Note: This field is returned when the API is called successfully.

More information about this field

*   Maximum length: 64 characters

#### paymentAmount Amount object 

The payment amount that the merchant requests to receive in the order currency.

Note: This field is returned when the API is called successfully.

Show child parameters

#### paymentTime Datetime  

The date and time when the payment reaches a final state of success.

Note: This field is returned when the API is called successfully.

More information about this field

*   The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard format. For example, "2019-11-27T12:01:01+08:00".

#### paymentCreateTime Datetime  

The date and time when the payment is created.

Note: This field is returned when the API is called successfully.

More information about this field

*   The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard format. For example, "2019-11-27T12:01:01+08:00".

#### pspCustomerInfo PspCustomerInfo object 

The customer information of Alipay+ Mobile Payment Provider (Alipay+ MPP).

Note: This field is returned when the Alipay+ MPP can provide the related information.

Show child parameters

#### grossSettlementAmount Amount object 

The value of this field equals to transaction amount multiplied by the value of _settlementQuote_. This field is returned when the currency exchange is predetermined and the exchange rate is locked at the time of transaction.

Show child parameters

#### settlementQuote Quote object 

The exchange rate between the settlement currency and transaction currency. This field is returned when _grossSettlementAmount_ is returned.

Show child parameters

API Explorer

Sample CodesRun in Sandbox

### Request

URL

North America

https://open-na-global.alipay.com/ams/api/v1/payments/pay

Request Body

Copy

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21

22

23

{

"settlementStrategy": {

"settlementCurrency": "USD"

},

"order": {

"orderAmount": {

"currency": "PHP",

"value": "1100"

},

"orderDescription": "Mika's coffee shop",

"referenceOrderId": "ORDER\_2020070316170XXXX"

},

"paymentAmount": {

"currency": "PHP",

"value": "1100"

},

"paymentMethod": {

"paymentMethodId":

        "28101003\_20200703duEWYqq9p9RSzGbOisAnJ4NCKygW3KQSMYouR73Vuqn088630526XXX

        X",

"paymentMethodType": "GCASH"

},

"paymentRequestId": "AGREEMENT\_PAYMENT\_REQUEST\_2020070316170XXXX",

"productCode": "AGREEMENT\_PAYMENT"

}

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

### Response

Response Body

Copy

1

2

3

4

5

6

7

8

9

10

11

12

13

14

{

"paymentAmount": {

"currency": "PHP",

"value": "1100"

},

"paymentCreateTime": "2020-07-03T01:17:50-07:00",

"paymentId": "2020070311401080010018840027964XXXX",

"paymentRequestId": "AGREEMENT\_PAYMENT\_REQUEST\_2020070316170XXXX",

"result": {

"resultCode": "SUCCESS",

"resultMessage": "Success",

"resultStatus": "S"

}

}

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

More information 
-----------------

This section gives additional information about other parameters. See the following list for details:

*   _order_: Alipay does not verify the consistency of the amount in the _order_ field and the amount in the payment request. The order information is not applied in fund operations either. This field is mainly used for risk control, supervision, regulatory reporting, and consumption records display. Use the _env_ field if the risk control capability provided by Alipay is needed.

Sample for the order field

Copy

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

*   _paymentTime_: The successful execution time of this payment by Alipay, that is, the date and time when the payment reaches a final state of success. This value is used as the start time of the subsequent cancellable and refundable time. For example, if the refundable time is 6 months, the final time to accept the refund is _paymentTime_ plus 6 months.

Result process logic
--------------------

For different request results, different actions are to be performed. See the following list for details:

*   If the value of _result.resultStatus_ is `S`, the payment succeeded.
*   If the value of _result.resultStatus_ is `F`, the payment failed.
*   If the value of _result.resultStatus_ is `U`, the payment status is unknown. You can wait for the asynchronous notification of the payment result and call the **inquiryPayment** interface to inquire about the payment result constantly until getting the final payment result. If you cannot receive the asynchronous notification or get a confirmative result (`S` or `F`) from the inquiryPayment response, terminate the transaction by calling the **cancel** API to keep the transaction status consistent between you and the user.

### Result/Error codes

| Code | Value | Message | Further action |
| --- | --- | --- | --- |
| SUCCESS | S | Success | The payment is successful, no further action is needed.
 |
| ACCESS\_DENIED | F | Access is denied. | Contact Alipay Technical Support for detailed reasons.

 |
| CURRENCY\_NOT\_SUPPORT | F | The currency is not supported. | Contact Alipay Technical Support for detailed reasons.

 |
| EXPIRED\_CODE | F | The payment code is expired. | The user needs to refresh the payment code.

 |
| INVALID\_ACCESS\_TOKEN | F | The access token is expired, revoked, or does not exist. | Check whether the access token is expired, revoked, or does not exist. Re-sign the contract and re-initiate the authorization signing process.

 |
| INVALID\_CONTRACT | F | The parameter values in the contract do not match those in the current transaction. | Check whether the parameter values in the contract match those in the current transaction. If the values match, contact Alipay Technical Support to troubleshoot the issue.

 |
| INVALID\_MERCHANT\_STATUS | F | The merchant status is abnormal because restrictions exist. | Contact Alipay Technical Support for detailed reasons.

 |
| INVALID\_PAYMENT\_CODE | F | The payment code cannot be accepted by Alipay+. | Choose other payment methods. Contact Alipay Technical Support if the payment method is supported.

 |
| INVALID\_PAYMENT\_METHOD\_META\_DATA | F | The payment method metadata is invalid. | Check whether payment method metadata is correct. If correct, contact Alipay Technical Support.

 |
| KEY\_NOT\_FOUND | F | The private key or public key of Alipay or the merchant is not found. | 

Check whether the private key or public key exists. If not, upload the private key in Antom Dashboard.



 |
| MERCHANT\_KYB\_NOT\_QUALIFIED | F | The payment failed because of the merchant's KYB status. The merchant is either not KYB compliant, or the KYB status is not qualified for this transaction. | Contact Alipay Technical Support for detailed reasons.

 |
| MERCHANT\_NOT\_REGISTERED | F | The merchant is not registered. | Please register the merchant by using the registration interface. Contact Alipay Technical Support if failed to call the registration interface.

 |
| NO\_INTERFACE\_DEF | F | API is not defined. | Check whether the URL is correct. Please refer to the endpoint in the API documentation.

 |
| NO\_PAY\_OPTIONS | F | No payment options are available. | 

Contact Antom Technical Support for detailed reasons.



 |
| ORDER\_IS\_CANCELED | F | The request you initiated has the same paymentRequestId as the previously paid transaction, which is canceled. | Use a new _paymentRequestId_ to initiate the payment again.

 |
| ORDER\_IS\_CLOSED | F | The request you initiated has the same paymentRequestId as that of the existed transaction, which is closed. | Use a new _paymentRequestId_ to initiate the payment again.

 |
| ORDER\_NOT\_EXIST | F | The order does not exist. | Check whether _paymentId_ is correct.

 |
| PARAM\_ILLEGAL | F | The required parameters are not passed, or illegal parameters exist. For example, a non-numeric input, an invalid date, or the length and type of the parameter are wrong. | Check and verify whether the required request fields (including the header fields and body fields) of the current API are correctly passed and valid.

 |
| PAYMENT\_AMOUNT\_EXCEED\_LIMIT | F | The payment amount is greater than the maximum amount allowed by the contract or wallet. | Check whether the payment amount exceeds the limit or use a lower amount and try again. Contact Alipay technical support to know the specific limitation.

 |
| PAYMENT\_COUNT\_EXCEED\_LIMIT | F | The maximum number of payments exceeds the limit that is specified by the wallet. | Contact Alipay Technical Support to know the specific limitation.

 |
| PAYMENT\_NOT\_QUALIFIED | F | The merchant is not qualified to pay because the merchant is not registered, does not have a contract for Auto Debit payment, or is forbidden to make a payment. | Contact Alipay Technical Support for detailed reasons.

 |
| PROCESS\_FAIL | F | A general business failure occurred. | Do not retry. Human intervention is usually needed. It is recommended that you contact Alipay Technical Support to troubleshoot the issue.

 |
| REPEAT\_REQ\_INCONSISTENT | F | The amount or currency is different from the previous request. | Ensure all the fields in the requests are the same or use a new _paymentRequestId_ to initiate the payment again.

 |
| RISK\_REJECT | F | The request is rejected because of the risk control. | Prompt the user that the request is rejected because the risk control failed.

 |
| SETTLE\_CONTRACT\_NOT\_MATCH | F | No matched settlement contract can be found. | Check the following for a solution:

*   Specify one settlement currency from the multiple currencies that the merchant signed up for.
*   Check if the settlement currency is specified in the settlement contracts.
*   The merchant didn't sign a settlement contract. Contact Alipay Technical Support. 

 |
| SYSTEM\_ERROR | F | A system error occurred. | Do not retry, and contact Alipay Technical Support for more details.

 |
| USER\_AMOUNT\_EXCEED\_LIMIT | F | The payment amount exceeds the user payment limit. | Create a new payment by using an amount less than or equal to the account's available balance, or contact Alipay Technical Support.

 |
| USER\_BALANCE\_NOT\_ENOUGH | F | The payment cannot be completed because the user balance in the corresponding payment method is not enough. | Please top up the account or choose other payment methods.

 |
| USER\_KYC\_NOT\_QUALIFIED | F | The payment failed because of the user's KYC status. The user is either not KYC compliant, or the KYC status is not qualified for this transaction (for example, limitations on the payment amount or product information). | Complete the KYC verification first.

 |
| USER\_NOT\_EXIST | F | The user does not exist on the wallet side. | Contact Alipay Technical Support for detailed reasons.

 |
| USER\_PAYMENT\_VERIFICATION\_FAILED | F | User fails to pass the payment verification in the methods like OTP, PIN, and so on. | Contact Alipay Technical Support to know the specific reasons.

 |
| USER\_STATUS\_ABNORMAL | F | The user status is abnormal on the wallet side. | Contact Alipay Technical Support to know the specific reasons.

 |
| PAYMENT\_IN\_PROCESS | U | The payment is being processed. | Wait for the asynchronous notification or call the inquiryPayment interface to query the final payment status.

 |
| REQUEST\_TRAFFIC\_EXCEED\_LIMIT | U | The request traffic exceeds the limit. | Call the interface again to resolve the issue. If not resolved, contact Alipay Technical Support.

 |
| UNKNOWN\_EXCEPTION | U | An API call has failed, which is caused by unknown reasons. | Call the inquiryPayment interface to query the final payment status. If the issue is not resolved, contact Alipay Technical Support.

 |
| VERIFY\_TIMES\_EXCEED\_LIMIT | F | The current verification code failed to pass the payment verification too many times. | The user must get a new verification code.

 |
| VERIFY\_UNMATCHED | F | The verification code is invalid. | The user must get a new verification code.

 |

To view the latest updates to the documentation, visit [Release notes](https://global.alipay.com/docs/releasenotes).

![Image 3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png)![Image 4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 Alipay [Legal Information](https://global.alipay.com/docs/ac/platform/membership)

#### Is this page helpful?