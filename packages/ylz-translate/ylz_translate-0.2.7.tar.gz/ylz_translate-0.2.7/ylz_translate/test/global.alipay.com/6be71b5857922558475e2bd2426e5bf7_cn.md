查询支付 | 产品API | 支付宝文档
==================

[![图片1：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![图片2：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Fpaymentri_online)  
[返回首页](../../)  

产品API  
[支付宝API](/docs/ac/ams/api)  
在线支付  
授权  
安全存储  
支付  
[咨询（结账支付）](/docs/ac/ams/consult)  
[支付（结账支付）](/docs/ac/ams/payment_cashier)  
[创建支付会话（结账支付）](/docs/ac/ams/session_cashier)  
[扣款（结账支付）](/docs/ac/ams/capture)  
[支付（协议支付）](/docs/ac/ams/payment_agreement)  
[创建支付会话（EasySafePay）](/docs/ac/ams/createpaymentsession_easypay)  
[支付通知](/docs/ac/ams/paymentrn_online)  
[扣款通知（结账支付）](/docs/ac/ams/notify_capture)  
[查询支付](/docs/ac/ams/paymentri_online)  
[取消支付](/docs/ac/ams/paymentc_online)  
订阅  
争议  
退款  
申报  
店内支付  

查询支付
==================  
2024-05-22 08:45  
POST /v1/payments/inquiryPayment  
使用此API查询先前提交的支付请求的交易状态和其他信息。  

结构
======

消息由头和正文组成。以下部分关注正文结构。关于头部结构，请参阅：
*   [请求头](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [响应头](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)  

**注意**：除数组外，每个字段的数据类型应设置为字符串。这意味着必须使用双引号（" "）包围字段值。例如：
*   若字段的数据类型为整数（Integer）且其值为20，设置为"20"。
*   若字段的数据类型为布尔值（Boolean）且其值为真（true），设置为"true"。
### 请求参数  
#### paymentRequestId 字符串  
商家为识别支付请求而分配的唯一ID。_paymentRequestId_ 和 _paymentId_ 不能都为null。如果两者都指定，_paymentId_ 优先。
关于此字段的更多信息：  
*   最大长度：64个字符  
#### paymentId 字符串  
支付宝为识别支付分配的唯一ID。_paymentRequestId_ 和 _paymentId_ 不能都为null。_paymentId_ 与 _paymentRequestId_ 之间存在一对一对应关系。如果两者都指定，_paymentId_ 优先。
关于此字段的更多信息：  
*   最大长度：64个字符  
#### merchantAccountId 字符串  
识别商家账户的唯一ID。
当您在多个地点使用单个客户端ID时，需要指定此参数。
关于此字段的更多信息：  
*   最大长度：32个字符
### 响应参数  
显示全部  
#### result 结果对象 **必需**  
请求调用结果的相关信息。  
注意：此字段不表示支付结果，仅表示调用查询支付接口是否成功。  
显示子参数  
#### paymentStatus 字符串  
表示支付结果的状态。有效值包括：  
*   `SUCCESS`: 支付成功。
*   `FAIL`: 支付失败。
*   `PROCESSING`: 支付处理中。
*   `CANCELLED`: 支付已取消。
*   `PENDING`: 支付完成，等待最终支付结果。  
注意：当API调用成功（result.resultStatus 的值为 `S`）时，此字段返回。  
#### paymentResultCode 字符串  
不同支付状态的结果代码。可能的支付结果代码如本页的“支付结果代码”表所示。  
注意：当API调用成功（result.resultStatus 的值为 `S`）时，此字段返回。  
关于此字段的更多信息：  
*   最大长度：64个字符  
#### paymentResultMessage 字符串  
解释支付结果代码的结果消息。  
注意：当API调用成功（result.resultStatus 的值为 `S`）时，此字段返回。  
关于此字段的更多信息：  
*   最大长度：256个字符  
#### paymentRequestId 字符串  
商家为识别支付请求而分配的唯一ID。  
注意：当API调用成功（result.resultStatus 的值为 `S`）时，此字段返回。  
关于此字段的更多信息：  
*   最大长度：64个字符  
#### paymentId 字符串  
支付宝为识别支付分配的唯一ID。  
注意：当API调用成功（result.resultStatus 的值为 `S`）时，此字段返回。  
关于此字段的更多信息：  
*   最大长度：64个字符
#### paymentAmount Amount 对象  
商家在订单货币中请求收取的支付金额。  
显示子参数  
#### paymentCreateTime Datetime  
支付创建的日期和时间。  
注意：仅当 API 调用成功（_result.resultStatus_ 的值为 `S`）时返回此字段。  
关于此字段的更多信息：  
*   值遵循 [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) 标准格式。例如，"2019-11-27T12:01:01+08:00"。  
#### paymentTime Datetime  
支付达到最终成功状态的日期和时间。  
注意：仅当支付达到最终成功状态（_paymentStatus_ 的值为 `SUCCESS`）时返回此字段。  
关于此字段的更多信息：  
*   值遵循 [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) 标准格式。例如，"2019-11-27T12:01:01+08:00"。  
#### pspCustomerInfo PspCustomerInfo 对象  
Alipay+ MPP 的客户信息。  
注意：仅当 Alipay+ MPP 可提供相关信息时返回此字段。  
显示子参数  
#### redirectActionForm RedirectActionForm 对象  
重定向操作的信息。  
注意：当 _paymentResultCode_ 的值为 `PAYMENT_IN_PROCESS` 时返回此字段。  
显示子参数  
#### acquirerReferenceNo 字符串  
非 Alipay 收单方为交易分配的唯一 ID。  
关于此字段的更多信息：  
*   最大长度：64 个字符  
#### transactions Array<Transaction> 对象  
针对交易的后续操作信息。  
当针对交易存在退款或扣款时，返回此参数。  
关于此字段的更多信息：  
*   最大大小：无限制  
显示子参数  
#### customsDeclarationAmount Amount 对象  
海关申报的总金额。
注意: 仅在支付成功且钱包为AlipayCN时返回此字段。
显示子参数
#### 结算金额（grossSettlementAmount） Amount 对象
此字段的值等于交易金额乘以_settlementQuote_的值。当货币兑换预先确定且交易时汇率被锁定时，返回此字段。
显示子参数
#### 汇率（settlementQuote） Quote 对象
结算货币与交易货币之间的汇率。当返回_grossSettlementAmount_时，返回此字段。
显示子参数
#### 支付结果信息（paymentResultInfo） PaymentResultInfo 对象
支付结果信息。
当在[**pay**](https://global.alipay.com/docs/ac/ams/payment_cashier) API 中的_paymentMethodType_值为`CARD`，`GRABPAY_MY`或`GRABPAY_SG`，且_paymentStatus_值为`SUCCESS`或`FAIL`时返回此参数。
选择场景
#### 授权过期时间（authExpirytime） 日期时间
授权支付的过期时间，超过此时间后无法捕获支付。
当在**pay（结账支付）** API 中的_paymentMethodType_值为`CARD`时返回此参数。
关于此字段的更多信息：
*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。
#### 促销结果（promotionResult） Array <PromotionResult> 对象
促销结果。
当买家在下单时使用了促销时，返回此参数。
显示子参数
API 探索器
示例代码 在沙箱中运行
### 请求  
URL  
北美地区  
https://open-na-global.alipay.com/ams/api/v1/payments/inquiryPayment  

请求体  
复制  
1  
2  
3  
{  
"paymentId": "2019060811401080010018882020035\*\*\*\*"  
}  

此处省略了大量重复的“ההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה
### 响应  
情况  
支付成功  
响应正文  
复制  
1  
2  
3  
4  
5  
6  
7  
8  
9  
10  
11  
12  
13  
14  
15  
16  
17  
{  
"result": {  
"resultCode": "SUCCESS",  
"resultStatus": "S",  
"resultMessage": "成功"  
},  
"paymentStatus": "SUCCESS",  
"paymentRequestId": "pay\_1089760038715669\_10277574507XXXX",  
"paymentId": "2019060811401080010018882020035XXXX",  
"paymentAmount": {  
"value": "500",  
"currency": "USD"  
},  
"paymentCreateTime": "2019-06-01T12:01:01+08:30",  
"paymentTime": "2019-06-01T12:01:01+08:30",  
"transactions": null  
}  
更多信息
----------------  
这一部分提供了关键参数的额外信息。详情如下：
*   _paymentTime_: 支付宝成功执行支付的时间，即支付达到最终成功状态的日期和时间。这个值用作后续可取消和可退款时间的起始时间。例如，如果退款期限是6个月，那么接受退款的最终截止时间是_paymentTime_ 加上 6 个月。
*   决定何时使用_paymentRequestId_或_paymentId_，遵循以下规则：
    *   如果**pay** API 调用成功，使用_paymentId_或_paymentRequestId_查询支付结果。
    *   如果**pay** API 调用返回未知异常或超时，使用_paymentRequestId_查询支付结果。
    *   如果**cancel** API 调用返回未知异常或超时，使用原始支付的_paymentId_或_paymentRequestId_查询取消结果。
**结果处理逻辑**
--------------------
对于不同的请求结果，需要执行不同的操作。详情如下：
    *   如果_result.resultStatus_的值为`S`，**inquiryPayment** API 调用成功。您可以从API响应的_paymentStatus_字段获取支付结果。
    *   如果_result.resultStatus_的值为`F`，**inquiryPayment** API 调用失败。无法从API响应中获取支付结果。
    *   如果_result.resultStatus_的值为`U`，**inquiryPayment** API 的状态未知。使用相同的请求参数重试**inquiryPayment** API。
### 结果/错误代码  
| 代码 | 值 | 消息 | 进一步行动 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 接口调用成功。通过 _paymentStatus_ 获取订单状态。 |
| ACCESS\_DENIED | F | 访问被拒绝 | 联系支付宝技术支持获取详细原因。 |
| INVALID\_API | F | 调用的API无效或未激活 | 联系支付宝技术支持解决问题。 |
| KEY\_NOT\_FOUND | F | 支付宝或商家的私钥或公钥未找到 | 检查私钥或公钥是否存在。如果不存在，请在支付宝开发者中心上传私钥。 |
| NO\_INTERFACE\_DEF | F | API未定义 | 检查URL是否正确。请参考API文档中的端点。 |
| ORDER\_NOT\_EXIST | F | 订单不存在 | 检查 _paymentId_ 是否正确。如果正确，请联系支付宝技术支持了解具体原因。 |
| PARAM\_ILLEGAL | F | 必需参数未传递，或存在非法参数。例如，非数字输入、无效日期或参数长度和类型错误 | 检查并验证当前API的必需请求字段（包括头部字段和正文字段）是否正确传递并有效。 |
| PAYMENT\_IN\_PROCESS | U | 支付处理中 | 对于收银台支付，您发起的请求具有与已存在交易相同的 _paymentRequestId_，可能是已完成或处理中的交易。检查响应中是否返回了 _redirectActionForm.redirectUrl_。如果返回，将用户重定向到 redirectUrl 指定的地址以完成支付。如果没有返回，支付可能已经完成。详情见结果处理逻辑。对于自动扣款，支付正在处理中。等待异步通知或调用查询支付接口查询最终支付状态。 |
| 进程失败 | F | 发生了一般的业务处理失败。 | 不要重试。通常需要人工干预。建议联系支付宝技术支持以解决问题。 |
| --- | --- | --- | --- |
| 系统错误 | F | 发生了系统错误。 | 不要重试，联系支付宝技术支持获取更多详细信息。 |
| 请求流量超过限制 | U | 请求流量超过了限制。 | 重新调用接口以解决问题。如果未解决，联系支付宝技术支持。 |
| 未知异常 | U | 由于未知原因，API调用失败。 | 重新调用接口以解决问题。如果未解决，联系支付宝技术支持。 |
### 支付结果代码  
| 代码 | 值 | 消息 | 进一步行动 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 支付成功，无需进一步操作。 |
| ACCESS\_DENIED | F | 访问被拒绝 | 联系支付宝技术支持获取详细原因。 |
| CURRENCY\_NOT\_SUPPORT | F | 货币不支持 | 联系支付宝技术支持获取详细原因。 |
| FRAUD\_REJECT | F | 由于风险控制，交易无法处理。如果用户已支付，交易将被退款。 | 当满足以下条件之一时联系支付宝技术支持：  
*   您想要申诉。
*   用户在两周内未收到退款。  
| INVALID\_API | F | 调用的API无效或未激活 | 联系支付宝技术支持解决问题。 |
| INVALID\_CARD | F | 卡片无效。可能是信用卡号无法识别，卡片没有对应的发卡行，或卡号格式错误。 | 使用新卡发起支付或联系发卡银行。 |
| INVALID\_EXPIRY\_DATE\_FORMAT | F | expiryYear 或 expiryMonth 的格式错误 | 检查传递参数 _expiryYear_ 和 _expiryMonth_ 的格式。 |
| ISSUER\_REJECTS\_TRANSACTION | F | 发卡行拒绝交易 | 使用新卡发起支付或联系发卡银行。 |
| INVALID\_ACCESS\_TOKEN | F | 访问令牌已过期、被撤销或不存在 | 检查 _accessToken_ 是否过期、被撤销或不存在。重新签约并重新发起授权签名流程。 |
| INVALID\_MERCHANT\_STATUS | F | 商户状态异常，存在限制 | 联系支付宝技术支持获取详细原因。 |
| 键未找到 | F | 未找到支付宝或商家的私钥或公钥。 | 检查私钥或公钥是否存在。如果不存在，请在支付宝开发者中心上传私钥。  
|
| 商户KYB不合格 | F | 由于商户的KYB（了解你的客户）状态导致支付失败。商户可能未完成KYB，或者KYB状态不适用于此交易。 | 请咨询支付宝技术支持以获取详细原因。  
|
| 未定义接口 | F | API未定义。 | 检查URL是否正确。请参考API文档中的端点。  
|
| 无支付选项 | F | 无可用的支付选项。 | 请咨询蚂蚁金服技术支持以获取详细原因。  
|
| 订单已关闭 | F | 您发起的请求具有与已关闭交易相同的paymentRequestId。 | 使用新的_paymentRequestId_重新发起支付。  
|
| 参数非法 | F | 必需参数未传递，或存在非法参数。例如，非数字输入、无效日期或参数长度和类型错误。 | 检查并验证当前API的必需请求字段（包括头部字段和正文字段）是否正确传递并有效。  
|
| 支付金额超过限制 | F | 支付金额超过了合同或支付方式允许的最大金额。 | 检查支付金额是否超出限制，或使用较低金额重试。联系支付宝技术支持了解具体限制。  
|
| 支付次数超过限制 | F | 支付次数超过了支付方式规定的最大限制。 | 请咨询支付宝技术支持了解具体限制。 |
| 支付未达标 | F | 商户未注册、未签订自动扣款协议或被禁止支付，因此不具备支付资格。 | 请咨询支付宝技术支持以获取详细原因。  
|
| 处理失败 | F | 发生了一般的业务处理失败。 | 不要重试，通常需要人工干预。建议联系支付宝技术支持解决问题。  
|
| 风险拒绝 | F | 由于风险控制，交易无法进一步处理。如果用户已支付，交易将被退款。 | 如果用户在两周内未收到退款，请联系支付宝技术支持。  
|
| 可疑卡片 | F | 卡片涉嫌欺诈，例如被盗或受限。 | 使用新卡发起支付或联系发卡银行。  
|
| 可疑风险 | F | 由于疑似安全问题，交易无法进一步处理。可在工作日后一天重试交易。如果交易不安全且用户已支付，交易将被退款。 | 当满足以下任一条件时，请联系支付宝技术支持：  
*   重试后交易仍无法处理。
*   用户在两周内未收到退款。  
|
| 系统错误 | F | 发生了系统错误。 | 不要重试，联系支付宝技术支持获取更多信息。  
|
| 用户金额超出限制 | F | 支付金额超过了用户的支付限额。 | 创建一个金额小于或等于账户可用余额的新支付，或联系支付宝技术支持。  
|
| 用户余额不足 | F | 由于对应支付方式的用户余额不足，无法完成支付。 | 请充值账户或选择其他支付方式。  
|
| USER\_KYC\_NOT\_QUALIFIED | F | 由于用户的KYC状态导致支付失败。用户可能未完成KYC认证，或者KYC状态不满足此交易要求（例如，支付金额限制或产品信息限制）。 | 首先完成KYC验证。 |
| USER\_PAYMENT\_VERIFICATION\_FAILED | F | 用户在支付方式端被限制支付。 | 联系支付宝技术支持了解具体原因。 |
| USER\_STATUS\_ABNORMAL | F | 用户在支付方式端的状态异常。 | 联系支付宝技术支持了解具体原因。 |
| PAYMENT\_IN\_PROCESS | U | 支付正在处理中。 | 对于收银台支付，您发起的请求具有与已存在交易相同的_paymentRequestId_，这可能是成功或处理中的交易。检查响应中是否返回了_redirectActionForm.redirectUrl_。如果返回，将用户重定向到redirectUrl指定的地址以完成支付。如果没有返回，支付可能已经完成。详情请参阅结果处理逻辑。对于自动扣款，支付正在处理中。等待异步通知或调用查询支付接口查询最终支付状态。 |
| UNKNOWN\_EXCEPTION | U | 由于未知原因，API调用失败。 | 对于收银台支付，使用新的_paymentRequestId_再次调用支付接口以解决问题。如果问题未解决，联系支付宝技术支持。 |
| 对于自动扣款，再次调用支付接口或调用查询支付接口查询最终支付状态。如果问题未解决，联系支付宝技术支持。 |
| CARD\_NOT\_SUPPORTED | F | 用于交易的卡片不支持。 | 使用其他卡片支付交易。 |
| 无效的过期日期 | F | paymentMethod.paymentMethodMetaData.expiryYear 或 paymentMethod.paymentMethodMetaData.expiryDate 的值无效。 |  
请检查 _paymentMethod.paymentMethodMetaData.expiryYear 或 paymentMethod.paymentMethodMetaData.expiryDate_ 的值是否正确：  
*   如果不正确，请传入正确的值。
*   如果正确，请联系支付宝技术支持获取详细原因。  
|
| 无效的卡号 | F | 用于交易的卡号无效。 |  
请检查 _paymentMethod.paymentMethodMetaData.cardno_ 的值是否正确：  
*   如果不正确，请输入正确的值并重试。
*   如果正确，此卡不支持该交易，请使用其他卡进行支付。  
|
| 不接受交易 | F | 发卡银行拒绝支付。 |  
尝试使用不同的卡进行支付，或联系发卡银行。  
|
### 交易结果代码  
| 代码 | 值 | 消息 | 进一步行动 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 接口调用成功。从 `_refundStatus_` 获取退款状态。 |
| ACCESS\_DENIED | F | 访问被拒绝 | 联系支付宝技术支持获取详细原因。 |
| INVALID\_API | F | 调用的 API 无效或未激活 | 联系支付宝技术支持解决问题。 |
| CLIENT\_INVALID | F | 客户端 ID 无效。支付宝对客户端 ID 有限制 | 检查客户端 ID 是否正确，或联系支付宝技术支持获取详细原因。 |
| KEY\_NOT\_FOUND | F | 支付宝或商家的私钥或公钥未找到 | 检查私钥或公钥是否存在。如果不存在，请在支付宝开发者中心上传私钥。 |
| NO\_INTERFACE\_DEF | F | API 未定义 | 检查 URL 是否正确。请参考 API 文档中的端点。 |
| ORDER\_NOT\_EXIST | F | 订单不存在 | 15 秒后重新调用接口。如果重试三次仍无结果，说明订单未创建。 |
| PARAM\_ILLEGAL | F | 必要参数未传递，或存在非法参数。例如，非数字输入、无效日期或参数长度和类型错误 | 检查并验证当前 API 的必需请求字段（包括头部字段和正文字段）是否正确传递并有效。 |
| PROCESS\_FAIL | F | 一般业务失败 | 不要重试，通常需要人工干预。建议联系支付宝技术支持解决问题。 |
| SYSTEM\_ERROR | F | 系统错误 | 不要重试，联系支付宝技术支持获取更多详细信息。 |
| 请求流量超出限制 | U | 请求流量超过了限制。 | 重新调用接口以解决问题。如果问题未解决，请联系支付宝技术支持。 |
| --- | --- | --- | --- |
| 未知异常 | U | 由于未知原因，API调用失败。 | 重新调用接口以解决问题。如果问题未解决，请联系支付宝技术支持。 |
| 支付处理中 | U | 支付正在处理。 | 对于收银台支付，您发起的请求具有与现有交易相同\_paymentRequestId，可能是成功或处理中的交易。检查响应中是否返回了\_redirectActionForm.redirectUrl。如果返回，将用户重定向到redirectUrl指定的地址以完成支付。如果没有返回，支付可能已经完成。详情请参阅结果处理逻辑。对于自动扣款，支付正在处理中。等待异步通知或调用查询支付接口以查询最终支付状态。 |
| 需要验证 | F | 需要3D安全验证。 | 重新发起支付并引导用户进行3D安全验证。 |
| 支付禁止 | F | 因商品在该国家禁止销售，无法处理支付。 | 该交易不允许申诉。 |
| 金额无效 | F | 发卡行因各种原因拒绝交易，例如指定金额无效或超过最大金额限制。 | 请联系支付宝技术支持获取详细原因。 |

要查看文档的最新更新，请访问[发行说明](https://global.alipay.com/docs/releasenotes)。

![图片3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)
@2024 支付宝 [法律信息](https://global.alipay.com/docs/ac/platform/membership)  
#### 这个页面是否有帮助？