通知支付 | 产品API | 支付宝文档
==================

[![图片1：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)](/docs/) [![图片2：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Fpaymentrn_online)  
[返回首页](../../)

产品API  
[支付宝API](/docs/ac/ams/api)  
在线支付  
授权  
安全存储  
支付  
[咨询（结账支付）](/docs/ac/ams/consult?pageVersion=49)  
[支付（结账支付）](/docs/ac/ams/payment_cashier?pageVersion=179)  
[创建支付会话（结账支付）](/docs/ac/ams/session_cashier)  
[扣款（结账支付）](/docs/ac/ams/capture)  
[支付（协议支付）](/docs/ac/ams/payment_agreement)  
[创建支付会话（EasySafePay）](/docs/ac/ams/createpaymentsession_easypay)  
[通知支付](/docs/ac/ams/paymentrn_online?pageVersion=69)  
[通知扣款（结账支付）](/docs/ac/ams/notify_capture)  
[查询支付](/docs/ac/ams/paymentri_online?pageVersion=74)  
[取消支付](/docs/ac/ams/paymentc_online?pageVersion=30)  
订阅  
争议  
退款  
申报  
店内支付  

通知支付
==========

2024-05-11 11:04  
POST /undefined  
当支付处理达到成功或失败的最终状态时，支付宝使用**通知支付**将支付结果发送给商家。商家根据支付结果促进商户端的交易处理。

结构
==========

消息由头和体组成。以下部分专注于体的结构。头的结构请参见：

*   [请求头](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [响应头](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)

**注意**：除数组外，每个字段的数据类型应设置为字符串。这意味着必须使用双引号（" "）包围字段值。例如：

*   如果字段的数据类型为Integer，值为20，则设置为"20"。
*   如果字段的数据类型为Boolean，值为true，则设置为"true"。
### 请求参数  
显示全部  
#### notifyType 字符串  必填  
支付状态通知的类型。有效值为：  
*   `PAYMENT_RESULT`: 表示通知是关于支付结果的。
*   `PAYMENT_PENDING`: 表示用户已完成支付，商家需要等待最终的支付结果。  

#### result Result对象  必填  
支付结果的详细信息，如支付状态、结果代码和结果消息。  
显示子参数  
#### paymentRequestId 字符串  必填  
商家为标识支付请求而分配的唯一ID。  
关于此字段的更多信息  
*   最大长度：64个字符  
#### paymentId 字符串  必填  
支付宝为标识支付分配的唯一ID。_paymentId_ 与 _paymentRequestId_ 之间存在一对一对应关系。  
关于此字段的更多信息  
*   最大长度：64个字符  
#### paymentAmount Amount对象  必填  
商家在订单货币中请求接收的支付金额。  
显示子参数  
#### paymentCreateTime 日期时间  必填  
支付创建的日期和时间。  
关于此字段的更多信息  
*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。  
#### paymentTime 日期时间  
支付达到最终成功状态的日期和时间。  
注意：此字段仅在支付达到最终成功状态（_result.resultStatus_ 的值为 `S`）时返回。  
关于此字段的更多信息  
*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。  
#### pspCustomerInfo PspCustomerInfo对象  
支付宝+移动支付提供商（Alipay+ MPP）的客户信息。  
注意：当Alipay+ MPP可以提供相关信息时，此字段返回。  
显示子参数  
#### customsDeclarationAmount Amount对象  
海关申报的总金额。  
注意：此字段仅在支付成功且钱包为AlipayCN时返回。  
显示子参数  
#### grossSettlementAmount Amount对象  
此字段的值等于交易金额乘以 _settlementQuote_ 的值。当货币兑换在交易时预先确定且汇率在交易时锁定时，此字段返回。  
显示子参数  
#### settlementQuote Quote对象  
结算货币与交易货币之间的汇率。当返回 _grossSettlementAmount_ 时，此字段返回。  
显示子参数  
#### acquirerReferenceNo 字符串  
非支付宝收单方为交易分配的唯一ID。  
关于此字段的更多信息  
*   最大长度：64个字符  
#### paymentResultInfo PaymentResultInfo对象  
支付结果信息。  
当[**pay**](https://global.alipay.com/docs/ac/ams/payment_cashier) API中的`paymentMethodType`值为`CARD`、`GRABPAY_MY`或`GRABPAY_SG`时，此参数返回。  
选择场景  
#### promotionResult PromotionResult对象数组  
促销结果。  
当买家在下单时应用了促销时，此参数返回。  
显示子参数
### 响应参数  
显示全部  
#### result 结果对象 **必需**  
一个固定值，用于向支付宝确认已接收到通知。  
显示子参数  
API 探索器
### 请求  
情况  
支付成功  
请求体  
复制  
1  
2  
3  
4  
5  
6  
7  
8  
9  
10  
11  
12  
13  
14  
15  
16  
{  
"notifyType": "PAYMENT_RESULT",  
"result": {  
"resultCode": "SUCCESS",  
"resultStatus": "S",  
"resultMessage": "成功"  
},  
"paymentRequestId": "2020010123456789XXXX",  
"paymentId": "2020010123456789XXXX",  
"paymentAmount": {  
"value": "8000",  
"currency": "EUR"  
},  
"paymentCreateTime": "2020-01-01T12:01:00+08:30",  
"paymentTime": "2020-01-01T12:01:01+08:30"  
}  
请注意，以上内容是以希伯来文符号填充的，以下是中文翻译：

### 请求  
场景  
支付成功  
请求体  
1  
2  
3  
4  
5  
6  
7  
8  
9  
10  
11  
12  
13  
14  
15  
16  
{  
"notifyType": "支付结果",  
"result": {  
"resultCode": "成功",  
"resultStatus": "S",  
"resultMessage": "成功"  
},  
"paymentRequestId": "2020010123456789XXXX",  
"paymentId": "2020010123456789XXXX",  
"paymentAmount": {  
"value": "8000",  
"currency": "EUR"  
},  
"paymentCreateTime": "2020-01-01 12:01:00 +08:30",  
"paymentTime": "2020-01-01 12:01:01 +08:30"  
}  
此处省略了大量重复的希伯来文符号，实际内容应为中文翻译。
### 响应  
响应体  
复制  
1  
2  
3  
4  
5  
6  
7  
{  
"result": {  
"resultCode": "SUCCESS",  
"resultStatus": "S",  
"resultMessage": "成功"  
}  
}  
注意：此部分提供了关键参数的附加信息。详情如下：  
*   _paymentTime_：支付宝成功执行此支付的时间，即支付达到最终成功状态的日期和时间。此值用作后续可取消和可退款时间的起始时间。例如，如果退款期为6个月，接受退款的最终时间是_paymentTime_加上6个月。  
结果处理逻辑  
接收到通知后，向支付宝发送包含固定值的消息，确认已收到支付宝的通知：  
示例代码  
复制  
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  
如果由于操作问题或网络问题，没有向支付宝返回此类消息，支付宝会反复发送通知，直到商家返回所需消息。首次通知发送后24小时内会进行重新发送通知，最多重试8次，间隔时间为0秒、2分钟、10分钟、10分钟、1小时、2小时、6小时和15小时。
### 结果/错误代码  
| 代码 | 值 | 消息 | 进一步操作 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 支付成功，无需进一步操作。 |
| ACCESS\_DENIED | F | 访问被拒绝 | 联系支付宝技术支持获取详细原因。 |
| INVALID\_API | F | 调用的API无效或未激活 | 联系支付宝技术支持解决问题。 |
| CURRENCY\_NOT\_SUPPORT | F | 货币不支持 | 联系支付宝技术支持获取详细原因。 |
| EXPIRED\_CODE | F | 支付码已过期 | 用户需要刷新支付码。 |
| FRAUD\_REJECT | F | 由于风险控制，交易无法进一步处理。如果用户已支付交易，交易将被退款。 | 当满足以下条件之一时联系支付宝技术支持：  
1. 您想要申诉。
2. 用户在两周内未收到退款。 |
| INVALID\_ACCESS\_TOKEN | F | 访问令牌已过期、被撤销或不存在 | 检查_accessToken_是否过期、被撤销或不存在。重新签署合同并重新发起授权签名过程。 |
| INVALID\_CONTRACT | F | 合同中的参数值与当前交易不匹配 | 检查合同中的参数值是否与当前交易匹配。如果匹配，请联系支付宝技术支持排查问题。 |
| INVALID\_MERCHANT\_STATUS | F | 商家状态异常，存在限制 | 联系支付宝技术支持获取详细原因。 |
| KEY\_NOT\_FOUND | F | 支付宝或商家的私钥或公钥未找到 | 检查私钥或公钥是否存在。如果不存在，请在支付宝开发者中心上传私钥。 |
| MERCHANT\_BALANCE\_NOT\_ENOUGH | F | 商家余额不足 | 商家有足够的余额后再次调用接口。 |
| NO\_INTERFACE\_DEF | F | API未定义 | 检查URL是否正确。请参考API文档中的端点。 |
| NO\_PAY\_OPTIONS | F | 无可用支付方式 | 联系Antom技术支持获取详细原因。 |
| ORDER\_IS\_CLOSED | F | 交易已关闭，无法再次支付 | 使用新的_paymentRequestId_发起支付。 |
| ORDER\_NOT\_EXIST | F | 订单不存在 | 检查_paymentId_是否正确。 |
| PARAM\_ILLEGAL | F | 必需参数未传递，或存在非法参数。例如，非数字输入、无效日期或参数长度和类型错误。 | 检查并验证当前API的必需请求字段（包括头部字段和主体字段）是否正确传递并有效。 |
| PAYMENT\_AMOUNT\_EXCEED\_LIMIT | F | 支付金额超过合同或支付方式允许的最大金额。 | 检查支付金额是否超出限制，或使用较低金额重试。联系支付宝技术支持了解具体限制。 |
| PAYMENT\_COUNT\_EXCEED\_LIMIT | F | 支付次数超过支付方式规定的最大限制。 | 联系支付宝技术支持了解具体限制。 |
| PAYMENT\_NOT\_QUALIFIED | F | 商家未注册、未签订自动扣款合同或被禁止支付，因此不具备支付资格。 | 联系支付宝技术支持获取详细原因。 |
| PROCESS\_FAIL | F | 发生一般业务失败。 | 不要重试，通常需要人工干预。建议联系支付宝技术支持解决问题。 |
| RISK\_REJECT | F | 由于风险控制，交易无法进一步处理。如果用户已支付交易，交易将被退款。 | 如果用户在两周内未收到退款，请联系支付宝技术支持。 |
| PAYMENT\_IN\_PROCESS | U | 支付正在处理中。 | 您发起的请求具有与已存在交易相同的_paymentRequestId_，可能是成功或处理中的交易。检查响应中是否返回了_redirectActionForm.redirectUrl_。如果返回，请将用户重定向到指定的redirectUrl完成支付。如果没有返回，支付可能已经完成。详情请参阅结果处理逻辑。 |
| SUSPECTED\_RISK | F | 由于疑似安全问题，交易无法进一步处理。可在工作日后一天重试交易。如果交易不安全且用户已支付，交易将被退款。 | 当满足以下条件之一时联系支付宝技术支持：  
1. 重试后交易仍无法处理。
2. 用户在两周内未收到退款。 |
| SYSTEM\_ERROR | F | 系统错误 | 不要重试，联系支付宝技术支持获取更多详细信息。 |
| UNKNOWN\_EXCEPTION | U | 由于未知原因，API调用失败。 | 重新调用接口解决问题。如果问题未解决，请联系支付宝技术支持。 |
| USER\_AMOUNT\_EXCEED\_LIMIT | F | 支付金额超过用户支付限额。 | 使用金额小于等于账户可用余额创建新支付，或联系支付宝技术支持。 |
| USER\_BALANCE\_NOT\_ENOUGH | F | 由于对应支付方式的用户余额不足，无法完成支付。 | 请充值账户或选择其他支付方式。 |
| USER\_KYC\_NOT\_QUALIFIED | F | 由于用户KYC状态，支付失败。用户要么未完成KYC，要么KYC状态不符合此交易（例如，支付金额或产品信息的限制）。 | 首先完成KYC验证。 |
| USER\_NOT\_EXIST | F | 用户在钱包端不存在。 | 联系支付宝技术支持获取详细原因。 |
| USER\_PAYMENT\_VERIFICATION\_FAILED | F | 用户在支付方式端被限制支付。 | 联系支付宝技术支持了解具体原因。 |
| USER\_STATUS\_ABNORMAL | F | 用户在支付方式端的状态异常。 | 联系支付宝技术支持了解具体原因。 |
| VERIFY\_TIMES\_EXCEED\_LIMIT | F | 当前验证码在支付验证中失败次数过多。 | 用户必须获取新的验证码。 |
| VERIFY\_UNMATCHED | F | 验证码无效。 | 用户必须获取新的验证码。 |
| AUTHENTICATION\_REQUIRED | F | 需要3D Secure认证。 | 重新发起支付并重定向用户进行3D Secure认证。 |
| PAYMENT\_PROHIBITED | F | 由于商品在该国禁止销售，无法处理支付。 | 无法对此交易提出申诉。 |
| CARD\_NOT\_SUPPORTED | F | 用于交易的卡不支持。 | 使用其他卡支付交易。 |
| INVALID\_EXPIRATION\_DATE | F | paymentMethod.paymentMethodMetaData.expiryYear 或 paymentMethod.paymentMethodMetaData.expiryDate 的值无效。 | 检查_paymentMethod.paymentMethodMetaData.expiryYear 或 paymentMethod.paymentMethodMetaData.expiryDate_的值是否正确：  
1. 如果不正确，请传递正确的值。
2. 如果正确，请联系支付宝技术支持获取详细原因。 |
| INVALID\_CARD\_NUMBER | F | 用于交易的卡号无效。 | 检查_paymentMethod.paymentMethodMetaData.cardno_的值是否正确：  
1. 如果不正确，请传递正确的值并重试。
2. 如果正确，此卡不支持该交易，使用其他卡支付交易。 |
| DO\_NOT\_HONOR | F | 发卡行拒绝支付。 | 使用不同卡重试支付或联系发卡行。 |
| INVALID\_AMOUNT | F | 发卡行因各种原因拒绝交易，例如指定金额无效或超过最大金额限制。 | 联系支付宝技术支持获取详细原因。 |

![图片3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)  
@2024 支付宝 [法律信息](https://global.alipay.com/docs/ac/platform/membership)  
#### 这个页面有帮助吗？