applyToken | Product APIs | Alipay Docs
===============
                        

[![Image 1: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![Image 2: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[Log In](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Faccesstokenapp)

[Go to Homepage](../../)

Product APIs

[Alipay APIs](/docs/ac/ams/api)

Online payments

Authorization

[consult](/docs/ac/ams/authconsult)

[notifyAuthorization](/docs/ac/ams/notifyauth)

[applyToken](/docs/ac/ams/accesstokenapp)

[revoke](/docs/ac/ams/authrevocation)

Vault

Payment

Subscription

Dispute

Refund

Declaration

In-store payments

applyToken
==========

2024-04-10 03:24

POST /v1/authorizations/applyToken

Use this API in one of the following ways to complete different tasks:

*   Use this API to obtain an access token via _authCode_ obtained by calling the **consult** API successfully. The access token will be used when initiating an auto debit.
*   Use this API to get a new access token via the refresh token when an existing access token is about to expire.

Structure
=========

A message consists of a header and body. The following sections are focused on the body structure. For the header structure, see：

*   [Request header](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [Response header](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)

**Note**: Set the data type of each field (except array) as String. This means that you must use double quotation marks (" ") to enclose the field value. Examples:

*   If the data type of a field is Integer and its value is 20, set it as "20". 
*   If the data type of a field is Boolean and its value is true, set it as "true". 

### Request parameters

#### grantType String  REQUIRED

The task to complete by using this API. Valid values are:

*   `AUTHORIZATION_CODE`: When you want to get the access token, use this value. You can get an access token after calling this API successfully.
*   `REFRESH_TOKEN`: Each access token has an expiry time that is specified by _accessTokenExpiryTime_. When your access token is about to expire and you want to get a new access token, use this value. You can get a new access token after calling this API successfully. 

#### customerBelongsTo String  REQUIRED

The wallet that the customer uses. See [Payment methods](https://global.alipay.com/docs/ac/ref/payment_method) to check the valid values.

More information about this field

*   Maximum length: 64 characters

#### authCode String  

The authorization code, used for getting an access token. The value of this field is obtained from the reconstructed redirection URL returned by the wallet.

Note: Specify this field when the value of _grantType_ is `AUTHORIZATION_CODE`.

More information about this field

*   Maximum length: 64 characters

#### refreshToken String  

The refresh token, used for getting a new access token when the access token is about to expire. The refresh token is obtained from the response of the successfully called **applyToken** API.

Note: Specify this field when the value of _grantType_ is `REFRESH_TOKEN`.

More information about this field

*   Maximum length: 128 characters

#### merchantRegion String  

The country or region where the merchant or secondary merchant operates the business. The parameter is a 2-letter country/region code that follows [ISO 3166 Country Codes](https://www.iso.org/obp/ui/#search) standard. Only `US`, `JP`, `PK`, `SG` are supported now.

Note: This field is required when you use the Global Acquirer Gateway (GAGW) product.

More information about this field

*   Maximum length: 2 characters

### Response parameters

Show all

#### result Result object REQUIRED

Indicates whether this API is called successfully. If this API is successfully called, the access token can be obtained.

Show child parameters

#### accessToken String  

The access token that is used to access the corresponding scope of the user resource.

Note: This field is returned when the API is called successfully.

More information about this field

*   Maximum length: 128 characters

#### accessTokenExpiryTime Datetime  

The time after which the access token expires. After the access token expires, the access token cannot be used to deduct money from the user's account.

Note: This field is returned when _accessToken_ is returned.

More information about this field

*   The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard format. For example, "2019-11-27T12:01:01+08:00".

#### refreshToken String  

The refresh token that is used to exchange for a new access token when the access token is about to expire.

Note: This field is returned when the wallet supports refreshing the token. If this field is not returned, it indicates that the access token has a quite long valid period.

More information about this field

*   Maximum length: 128 characters

#### refreshTokenExpiryTime Datetime  

The time after which the refresh token expires. After the refresh token expires, the refresh token cannot be used to retrieve a new access token.

Note: This field is returned when _refreshToken_ is returned.

More information about this field

*   The value follows the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard format. For example, "2019-11-27T12:01:01+08:00".

#### userLoginId String  

The login ID that the user used to register in the wallet. The login ID can be the user's email address or phone number, which is masked when returned to Alipay+ MPP . This field can inform the merchant of the users who are registered.

Note: This field is returned when _result.resultCode_ is `S` and the value of the _scopes_ field in the consult API is `AGREEMENT_PAY`.

More information about this field

*   Maximum length: 64 characters

#### extendInfo String  

Extended information.

Note: This field is returned when extended information exists.

More information about this field

*   Maximum length: 2048 characters

API Explorer

Sample CodesRun in Sandbox

### Request

URL

North America

https://open-na-global.alipay.com/ams/api/v1/authorizations/applyToken

Case

Get accessToken with authCode

Request Body

Copy

1

2

3

4

5

{

"authCode": "663A8FA9D83648EE8AA11FF68298XXXX",

"customerBelongsTo": "GCASH",

"grantType": "AUTHORIZATION\_CODE"

}

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

### Response

Case

Touch'n Go

Case description

If you apply for the access token of Touch'n Go, the following response is returned:

Response Body

Copy

1

2

3

4

5

6

7

8

9

10

11

12

13

{

"accessTokenExpiryTime": "2022-09-14T17:14:16+08:00",

"result": {

"resultStatus": "S",

"resultCode": "SUCCESS",

"resultMessage": "Success"

},

"accessToken": "281011030220200914TLsu9RhgUv87Lf1111\*\*\*\*",

"extendInfo": "{\\"userId\\":\\"100000111111\*\*\*\*\\",\\"userLoginId\\":\\"6017271

      \*\*\*\*\\"}",

"refreshTokenExpiryTime": "2023-03-16T17:14:16+08:00",

"refreshToken": "281011111110200914aGT3jbpxci875H0041\*\*\*\*",

"userLoginId": "6017271\*\*\*\*"

}

הההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההה

XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

Result process logic
--------------------

For different request results, different actions are to be performed. See the following list for details:

*   If the value of _result.resultStatus_ is `S`, the access token is obtained successfully. Use the access token to access the corresponding user resource scope.
*   If the value of _result.resultStatus_ is `U`, the access token is not obtained. Retry the process by calling this API again.
*   If the value of result.resultStatus is `F`, the access token is not obtained. Check the error code and take the corresponding actions. And then retry the process by calling this API again.

### Result/Error codes

| Code | Value | Message | Further action |
| --- | --- | --- | --- |
| SUCCESS | S | Success | The authorization is completed. Store _accessToken_ and other related fields.
 |
| ACCESS\_DENIED | F | Access is denied. | Contact Alipay Technical Support for detailed reasons.

 |
| CLIENT\_FORBIDDEN\_ACCESS\_API | F | The client is not authorized to use this API. | Contact Alipay Technical Support for detailed reasons.

 |
| INVALID\_ACCESS\_TOKEN | F | The access token is expired, revoked, or does not exist. | Check whether _accessToken_ is correct. If not correct, pass in the correct value. If correct, contact Alipay Technical Support for detailed reasons.

 |
| INVALID\_API | F | The called API is invalid or not active. | Contact Alipay Technical Support to resolve the issue.

 |
| INVALID\_AUTHCODE | F | The authorization code is invalid. | Re-initiate the authorization, call the consult interface to obtain _authcode_. Contact Alipay Technical Support to troubleshoot the issue if the authorization code is correct.

 |
| INVALID\_CLIENT\_STATUS | F | The client status is invalid. | Contact Alipay Technical Support for detailed reasons.

 |
| INVALID\_REFRESH\_TOKEN | F | The refresh token is invalid. | Use a valid _refreshToken_ to re-initiate the request. Contact Alipay Technical Support to troubleshoot the issue if the refresh token is correct.

 |
| INVALID\_SIGNATURE | F | The signature is not validated. The private key used to sign a request does not match the public key of Antom Dashboard | 

Check whether the private key used to sign a request matches the public key of Antom Dashboard. The following signature references are useful:

*   The [signature](https://global.alipay.com/docs/ac/ams/api_fund) field in a request header 
*   How to [calculate a signature](https://global.alipay.com/docs/ac/ams/digital_signature) 



 |
| KEY\_NOT\_FOUND | F | The private key or public key of Alipay or the merchant is not found. | 

Check whether the private key or public key exists. If not, upload the private key in Antom Dashboard.



 |
| NO\_INTERFACE\_DEF | F | API is not defined. | Check whether the URL is correct. Please refer to the endpoint in the API documentation.

 |
| NO\_PAY\_OPTIONS | F | The payment method is not supported by this API. | Check whether the payment method is a valid value for the _customerBelongsTo_ parameter. If the value you passed in is correct, contact Alipay Technical Support for detailed reasons.

 |
| OAUTH\_FAILED | F | OAuth process failed. | Contact Alipay Technical Support for detailed reasons.

 |
| PARAM\_ILLEGAL | F | The required parameters are not passed, or illegal parameters exist. For example, a non-numeric input, an invalid date, or the length and type of the parameter are wrong. | Check and verify whether the required request fields (including the header fields and body fields) of the current API are correctly passed and valid.

 |
| PROCESS\_FAIL | F | A general business failure occurred. | Do not retry. Human intervention is usually needed. It is recommended that you contact Alipay Technical Support to troubleshoot the issue.

 |
| SYSTEM\_ERROR | F | A system error occurred. | Do not retry, and contact Alipay Technical Support for more details.

 |
| UNKNOWN\_CLIENT | F | The client is unknown. | Contact Alipay Technical Support for detailed reasons.

 |
| USER\_NOT\_EXIST | F | The user does not exist on the wallet side. | Contact Alipay Technical Support for detailed reasons.

 |
| USER\_STATUS\_ABNORMAL | F | The user status is abnormal on the wallet side. | Contact Alipay Technical Support to know the specific reasons.

 |
| AUTH\_IN\_PROCESS | U | The authorization is still in process. | Call this interface again until you receive a final result status.

 |
| REQUEST\_TRAFFIC\_EXCEED\_LIMIT | U | The request traffic exceeds the limit. | Call the interface again to resolve the issue. If not resolved, contact Alipay Technical Support.

 |
| UNKNOWN\_EXCEPTION | U | An API call has failed, which is caused by unknown reasons. | Call the interface again to resolve the issue. If not resolved, contact Alipay Technical Support.

 |

To view the latest updates to the documentation, visit [Release notes](https://global.alipay.com/docs/releasenotes).

![Image 3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png)![Image 4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 Alipay [Legal Information](https://global.alipay.com/docs/ac/platform/membership)

#### Is this page helpful?