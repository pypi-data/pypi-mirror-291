沙箱 | 开发参考 | 支付宝文档
===============

[![图片1：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)](/docs/) [![图片2：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fref%2Fsandbox)  
[返回首页](../../)  

开发参考  
[沙箱](/docs/ac/ref/sandbox)  
[如何测试银行卡支付](/docs/ac/ref/card)  
[如何测试支付宝+支付方式](/docs/ac/ref/wallet)  
[如何测试其他支付方式](/docs/ac/ref/other)  
[测试钱包](/docs/ac/ref/testwallet)  
[测试资源](/docs/ac/ref/test_resource)  
[集成模式](/docs/ac/ref/oy9921)  
[安全文件传输](/docs/ac/ref/xgcpey)  

常见问题  
蚂蚁通仪表盘  
工具  
其他参考  
[MCC代码](/docs/ac/ref/mcccodes)  
[Amount对象使用规则](/docs/ac/ref/cc)  
[支付方式](/docs/ac/ref/payment_method)  
[风险管理方法](/docs/ac/ref/risk_methods)  
[品牌资产](/docs/ac/ref/brandasset)  

沙箱
=======

2024-05-22 07:34  
如何使用沙箱
==================

沙箱提供了一个测试环境，用于模拟支付，确保应用程序与蚂蚁通产品的无缝集成。本主题将指导您有效地使用沙箱。

开始前
----------------  
在沙箱中测试前，请完成以下步骤：

1. 登录[蚂蚁通仪表盘](https://dashboard.alipay.com/global-payments/home)，切换到测试模式，进入 **开发者** > **快速入门** > **集成资源和工具**，然后选择 **集成资源** 获取沙箱客户端ID、域名和公钥。
2. 下载测试钱包应用。请参考[测试钱包](https://global.alipay.com/docs/ac/ref/testwallet)指南进行操作。  
在沙箱环境测试
----------------  
在沙箱环境中，提供了多种模拟API调用的方法，你可以多次调用每个API。如果你提供相应信息，API调用之间是相互关联的。例如，你首先调用**支付** API来发起一笔支付。然后，你可以通过指定_paymentId_调用**退款** API来针对这笔支付发起退款。沙箱环境会提供支付和相关退款的信息。

此外，当你在沙箱中调用**支付**或**咨询** API时，沙箱还会模拟不同终端类型（如WEB、WAP和APP）商户端与支付方式端之间的重定向过程。
### 用于结账支付/自动扣款  
要测试结账支付和自动扣款，您可以使用提供的测试指南来模拟各种支付方式的支付和存档过程。沙箱还可以模拟所有错误代码，甚至通过[错误场景模拟工具](https://global.alipay.com/docs/ac/ref/error_scenario_sim_en)模拟罕见的生产环境场景。这使开发者在测试期间能够处理一致的系统逻辑处理。  
#### 支付方式测试  
| **支付方式** | **测试指南** |
| --- | --- |
| [信用卡](https://global.alipay.com/docs/ac/cashierpay/pay_type#DDFip) | [如何测试信用卡支付](https://global.alipay.com/docs/ac/ref/card) |
| [Alipay+ 支付方式](https://global.alipay.com/docs/ac/cashierpay/pay_type#mt4eB) | [如何测试Alipay+支付方式](https://global.alipay.com/docs/ac/ref/wallet) |
| [钱包](https://global.alipay.com/docs/ac/cashierpay/pay_type#IK789) | [如何测试其他支付方式](https://global.alipay.com/docs/ac/ref/other) |
| [手机银行应用](https://global.alipay.com/docs/ac/cashierpay/pay_type#KSRbI) |
| [银行转账](https://global.alipay.com/docs/ac/cashierpay/pay_type#bR1hN) |
| [在线银行](https://global.alipay.com/docs/ac/cashierpay/pay_type#llC45) |
| [柜台支付](https://global.alipay.com/docs/ac/cashierpay/pay_type#FwduU) |  
#### 模拟错误场景  
错误场景模拟提供了不同API结果的模拟，并返回集成测试所需的特定响应。有关详细信息，请参阅[错误场景模拟](https://global.alipay.com/docs/ac/ref/error_scenario_sim_en)。
### 订阅支付
在沙盒环境中，您可以创建、更新和取消订阅计划。沙盒会自动加快订阅扣款周期，以方便您的验证流程。下表说明了其工作原理：

| **periodRule.periodType** | **periodRule.periodCount** | **沙盒加速间隔（分钟）** | **加速频率** |
| --- | --- | --- | --- |
| `DAY` | `31` | 3 | 12 |
| `93` | 3 | 12 |
| `366` | 3 | 12 |
| `WEEK` | `1` | 3 | 12 |
| `MONTH` | `1` | 3 | 12 |
| `3` | 15 | 12 |
| `6` | 30 | 12 |
| `YEAR` | `1` | 60 | 12 |

例如，创建一个为期31天的订阅计划：

```json
{
  "subscriptionRequestId": "REQUEST_20240409141836419",
  "subscriptionDescription": "订阅测试",
  "paymentMethodType": "GCASH",
  "env": {
    "osType": "ANDROID",
    "terminalType": "APP"
  },
  "orderInfo": {
    "orderAmount": {
      "currency": "PHP",
      "value": "100"
    }
  },
  "paymentAmount": {
    "currency": "PHP",
    "value": "100"
  },
  "periodRule": {
    "periodCount": 31,
    "periodType": "DAY"
  },
  "settlementStrategy": {
    "settlementCurrency": "USD"
  },
  "subscriptionStartTime": "2024-04-09T14:18:36+08:00",
  "subscriptionEndTime": "2074-04-09T14:18:36+08:00",
  "subscriptionExpiryTime": "2024-04-09T14:48:36+08:00",
  "subscriptionNotificationUrl": "https://www.baidu.com",
  "subscriptionRedirectUrl": "https://alipay.com/subscriptionNotify",
  "paymentNotificationUrl": "https://alipay.com/subscriptionPayNotify"
}
```

按照[如何测试Alipay+支付方式](https://global.alipay.com/docs/ac/ref/wallet)的指南完成沙盒中的存档过程，您将开始每3分钟收到一次扣款通知。在第十三次扣款后，加速周期停止。加速周期内的最后一次详细扣款通知如下：

```json
{
  "paymentAmount": {
    "currency": "PHP",
    "value": "100"
  },
  "paymentCreateTime": "2024-04-08T23:59:00-07:00",
  ...
}
```

请注意，以上示例中的时间和金额都是假设值，实际使用时需要根据您的业务需求进行调整。
"paymentId": "202404091940108001001886J0299059200",
"支付时间": "2024年04月08日 23:59:03 -07:00",
"周期结束时间": "2025年05月16日 23:18:36 -07:00",
"周期开始时间": "2025年04月15日 23:18:36 -07:00",
"阶段编号": "13",
"结果": {
"结果代码": "SUCCESS",
"结果信息": "success",
"结果状态": "S"
},
"订阅Id": "202404091900000000000009D0000004046",
"订阅请求Id": "REQUEST_20240409141836419",
"订阅编号": "13"
}  
要查看文档的最新更新，请访问 [版本说明](https://global.alipay.com/docs/releasenotes)。  
![图片 3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片 4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)  
@2024 蚂蚁金服 [法律信息](https://global.alipay.com/docs/ac/platform/membership)  
#### 这个页面有帮助吗？  
#### 在这个页面上  
[如何使用沙箱环境](#p9X19 "如何使用沙箱环境")  
[开始之前](#xh0P0 "开始之前")  
[在沙箱中测试](#hgYcM "在沙箱中测试")  
[针对结账支付/自动扣款](#A3VRp "针对结账支付/自动扣款")  
[测试支付方式](#IyR8b "测试支付方式")  
[模拟错误场景](#nijOn "模拟错误场景")  
[针对订阅支付](#RcC5W "针对订阅支付")