Pay | Scan to Bind | Alipay Docs
===============
                        

[![Image 1: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![Image 2: Alipay, China's leading third-party online payment solution](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[Log In](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fscantopay_en%2Fpay)

[Go to Homepage](../../)

Scan to Bind

[Overview](/docs/ac/scantopay_en/overview)

Integration guide

[Obtain authorization](/docs/ac/scantopay_en/authorization)

[Pay](/docs/ac/scantopay_en/pay)

After payments

[Reconciliation](/docs/ac/scantopay_en/settle_reconcile)

Pay
===

2023-08-31 07:50

After obtaining the buyer’s authorization, you can directly initiate the Auto Debit service without the need to go through the authorization process again for each payment.

To complete an Auto Debit payment, perform the following two steps:

1.  Initiate a payment
2.  Obtain the payment result

Step 1: Initiate a payment
==========================

If the balance of the target payment method is sufficient to pay for the buyer's order, you can call the [**pay**](https://global.alipay.com/docs/ac/ams/payment_agreement) API to initiate an Auto Debit payment. Pass in the following parameters correctly in the request:

*   _productCode_: Pass in the value `AGREEMENT_PAYMENT`.
*   _paymentMethod.paymentMethodId_: The value of the payment token (_accessToken_) that you obtain using the [**applyToken**](https://global.alipay.com/docs/ac/ams/accesstokenapp) API.
*   _paymentExpiryTime_: You can only specify the parameter to limit the expiration time to less than 1 minute. The value of this field must comply with the [ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html) standard. If you do not specify a value for this field, the expiration time of an automatic deduction request is one minute after the payment request is sent. For details, see the [**pay**](https://global.alipay.com/docs/ac/ams/payment_agreement) API.
*   _paymentNotifyUrl_: The address used to receive asynchronous notifications. We recommend you pass in the parameter.

In the [**pay**](https://global.alipay.com/docs/ac/ams/payment_agreement) API response, learn whether the deduction is successful based on the _result.resultStatus_ value:

*   If the value is `S`, the deduction is successful.
*   If the value is `U`, the transaction is still in progress. You need to inquire about the transaction status using the [**inquiryPayment**](https://global.alipay.com/docs/ac/ams/paymentri_online) API or wait for asynchronous notifications to obtain the transaction result.
*   If the value is `F`, the deduction fails. You need to handle it according to the result code.

If you cannot receive a response, we recommend you call the [**pay**](https://global.alipay.com/docs/ac/ams/payment_agreement) API with the same parameters.

Step 2: Obtain the payment result
=================================

Due to network issues, asynchronous notifications may not be sent or may be delayed. To obtain an accurate payment result, you must integrate both the asynchronous notifications and payment result inquiry service.

1\. Receive asynchronous notifications
--------------------------------------

Apart from learning the payment result from the redirection to the payment result page, you can also set the asynchronous notification address by specifying _paymentNotifyUrl_ in the [**pay**](https://global.alipay.com/docs/ac/ams/payment_cashier) API. When the payment is completed or expired, Alipay sends an asynchronous notification to the address through the [**notifyPayment**](https://global.alipay.com/docs/ac/ams/paymentrn_online) API.

When you receive the notification from Alipay, you must return a response by following the [code sample](https://global.alipay.com/docs/ac/cashierpay/notifications#JtjSl). If you do not return the response to Alipay or the response is not received by Alipay due to network issues, Alipay automatically resends the asynchronous notification within 24 hours for up to eight times or until the correct response is received. The sending intervals are as follows: 0 sec, 2 min, 10 min, 10 min, 1 h, 2 h, 6 h, and 15 h.

> **Note**: When a payment is successful, Alipay immediately sends you an asynchronous notification of payment success. When a payment fails, Alipay sends you an asynchronous notification of payment failure after the payment order is closed. The default order expiry time is 14 minutes after the payment is initiated.

2\. Inquire about the payment status
------------------------------------

We recommend that you inquire about the payment status by calling the [**inquiryPayment**](https://global.alipay.com/docs/ac/ams/paymentri_online) API. You can use the API after the payment request is initiated and before the order is closed.

In the response returned through the [**inquiryPayment**](https://global.alipay.com/docs/ac/ams/paymentri_online) API, _paymentStatus_ indicates the payment status. See the following table for details:



| **paymentStatus** | **Type** | **Description** | **Handling** |
| --- | --- | --- | --- |
| SUCCESS | Final status | The payment is successful. | You can display a payment success page. |
| PROCESSING | Intermediate status | The payment is being processed. | You can allow the buyer to continue to pay. |
| FAIL | Final status | The user has not paid or the payment fails. | You can allow the buyer to continue to pay or close the payment order. |
| CANCELLED | Final status | The payment is canceled by you. | You can allow the buyer to continue to pay or close the payment order. |



Table 1. Details of _paymentStatus_

For details about the payment status, see [Payment status description](https://global.alipay.com/docs/ac/cashierpay/payment_status_desc).

3\. Best Practices
------------------

To obtain accurate payment results, we recommend that you maintain an order table in the database, which should include at least two fields: the order number and order status. And use the asynchronous notification and payment result inquiry services in the following way:

*   **Asynchronous notification**: Listen to Alipay's asynchronous notifications and return a response upon receiving an asynchronous notification. Then check the order status in the database:

*   If the order status is `INIT`, update the order status according to the asynchronous notification.
*   If the order status is not `INIT`, it indicates that the final payment result has been obtained through the inquiry service and the order status has been updated accordingly. No further actions are needed.

*   **Payment inquiry**: Inquire about the payment status. Before each inquiry, you need to check the order status in the database:

*   If the order status is `INIT`, initiate an inquiry. Update the order status in the database if a final payment result is obtained, otherwise, continue the inquiry process.
*   If the order status is not `INIT`, it indicates that the inquiry process has been conducted and a final payment result has been obtained and used for updating the order status. No further actions are needed.

![Image 3: image](https://idocs-assets.marmot-cloud.com/storage/idocs87c36dc8dac653c1/1619061903693-545f78ce-8cd7-4a54-8a83-763289bf7bbf.png)

Figure 1. Best practice to use the asynchronous notification and payment result inquiry service

To view the latest updates to the documentation, visit [Release notes](https://global.alipay.com/docs/releasenotes).

![Image 4](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png)![Image 5](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 Alipay [Legal Information](https://global.alipay.com/docs/ac/platform/membership)

#### Is this page helpful?

#### On this page

[Step 1: Initiate a payment](#SXydg "Step 1: Initiate a payment")

[Step 2: Obtain the payment result](#MXtRf "Step 2: Obtain the payment result")

[1\. Receive asynchronous notifications](#nNDuL "1. Receive asynchronous notifications")

[2\. Inquire about the payment status](#Z6H8I "2. Inquire about the payment status")

[3\. Best Practices](#lKesn "3. Best Practices")