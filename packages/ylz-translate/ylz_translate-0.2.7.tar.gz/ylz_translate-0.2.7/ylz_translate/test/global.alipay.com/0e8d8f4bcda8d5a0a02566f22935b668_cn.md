通知支付 | 产品API | 支付宝文档
==================

[![图片1：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg)![图片2：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Fnotify_subpayment)

[返回首页](../../)

产品API
[支付宝API](/docs/ac/ams/api)
在线支付
授权
安全存储
支付
订阅
[创建](/docs/ac/ams/create_sub)
[通知订阅](/docs/ac/ams/notify_sub)
[通知支付](/docs/ac/ams/notify_subpayment)
[修改](/docs/ac/ams/change_sub)
[取消](/docs/ac/ams/cancel_sub)
争议
退款
申报
店内支付
通知支付
==================

2024-01-29 07:27

当订阅周期的支付达到成功或失败的最终状态时，支付宝使用**notifyPayment**向商家发送支付结果。

结构
==========

一条消息由头部和主体组成。以下部分专注于主体结构。头部结构请参考：

*   [请求头部](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [响应头部](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)

**注意**：除数组外，每个字段的数据类型应设置为字符串。这意味着字段值必须用双引号（" "）括起来。例如：

*   如果字段的数据类型是整数，值为20，则设置为"20"。
*   如果字段的数据类型是布尔值，值为true，则设置为"true"。
### 请求参数  
显示全部  
#### result 结果对象 **必需**  
支付结果的详细信息，如支付状态、结果代码和结果消息。  
显示子参数  
#### paymentId 字符串 **必需**  
支付宝为每个订阅周期分配的唯一支付ID。  
关于此字段的更多信息  
*   最大长度：64个字符  
#### paymentAmount 金额对象 **必需**  
每个订阅周期的支付金额。  
显示子参数  
#### paymentCreateTime 日期时间 **必需**  
每个订阅周期支付创建的日期和时间。  
关于此字段的更多信息  
*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。  
#### paymentTime 日期时间  
每个订阅周期支付达到最终成功状态的日期和时间。  
当_result.resultStatus_的值为`S`时，返回此参数。  
#### subscriptionRequestId 字符串 **必需**  
商家为识别订阅请求分配的唯一ID。  
关于此字段的更多信息  
*   最大长度：64个字符  
#### subscriptionId 字符串 **必需**  
支付宝为识别订阅分配的唯一ID。  
关于此字段的更多信息  
*   最大长度：64个字符  
#### periodStartTime 日期时间 **必需**  
当前订阅周期的开始日期和时间。  
关于此字段的更多信息  
*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。  
#### periodEndTime 日期时间 **必需**  
当前订阅周期的结束日期和时间。  
关于此字段的更多信息  
*   值遵循[ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html)标准格式。例如，"2019-11-27T12:01:01+08:00"。  
#### phaseNo 字符串 **必需**
表示订阅期间的当前阶段。例如，如果订阅始于5月，以月为周期持续一年，那么6月就代表第二个阶段，此时`phaseNo`等于"2"。

关于此字段的更多信息：
*   最大长度：64个字符
### 响应参数  
显示全部  
#### result 结果对象 **必需**  
一个固定值，用于向支付宝确认已接收到通知。  
显示子参数  
API 探索器
### 请求  
请求体  
复制  
1  
2  
3  
4  
5  
6  
7  
8  
9  
10  
11  
12  
13  
14  
15  
16  
17  
18  
19  
{  
"phaseNo": "1",  
"periodStartTime": "2022-11-03T17:00:00-07:00",  
"periodEndTime": "2022-10-04T09:00:00-07:00",  
"paymentAmount": {  
"currency": "PHP",  
"value": "122"  
},  
"paymentCreateTime": "2022-12-05T11:34:05-08:00",  
"paymentId": "20221205194010800100188860204600921",  
"paymentTime": "2022-12-05T11:33:56-08:00",  
"result": {  
"resultCode": "SUCCESS",  
"resultMessage": "成功",  
"resultStatus": "S"  
},  
"subscriptionId": "20221205190000000000000450000007269",  
"subscriptionRequestId": "amsmdsubscription_20221206_033332_074"  
}  
请注意：此文本为示例，实际内容可能为加密或非人类可读的填充数据。  
以下为填充数据的示例：  
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
### 响应  
响应体  
复制  
1  
2  
3  
4  
5  
6  
7  
{  
"result": {  
"resultStatus": "S",  
"resultCode": "SUCCESS",  
"resultMessage": "成功。"  
}  
}  
哈哈哈哈哈  
结果处理逻辑
====================  
在接收到支付宝的通知后，使用固定值发送以下消息，以确认已收到支付宝的通知：  
示例代码  
复制  
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  
请注意，上述代码示例应替换为实际的确认消息内容。通常，这会涉及到发送一个确认接收通知的特定HTTP请求或使用特定的API接口。具体的实现取决于与支付宝集成的接口文档。
如果由于操作问题或网络问题，支付宝没有接收到返回的消息，支付宝会在24小时内自动重发通知最多八次，直到收到正确的响应为止。发送间隔如下：0秒，2分钟，10分钟，10分钟，1小时，2小时，6小时和15小时。
### 结果/错误代码  
| 代码 | 值 | 消息 | 进一步行动 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 接口调用成功。 |
| ACCESS\_DENIED | F | 访问被拒绝。 | 联系支付宝技术支持获取详细原因。 |
| INVALID\_ACCESS\_TOKEN | F | 访问令牌已过期、被撤销或不存在。 | 联系支付宝技术支持获取详细原因。 |
| CURRENCY\_NOT\_SUPPORT | F | 货币不受支持。 | 联系支付宝技术支持获取详细原因。 |
| ORDER\_IS\_CLOSED | F | 交易已关闭，无法再次支付。 | 联系支付宝技术支持获取详细原因。 |
| PAYMENT\_AMOUNT\_EXCEED\_LIMIT | F | 支付金额超过合同或钱包允许的最大金额。 | 检查支付金额是否超出限制，或使用较低金额重试。联系支付宝技术支持了解具体限制。 |
| PAYMENT\_COUNT\_EXCEED\_LIMIT | F | 支付次数超过钱包规定的最大限制。 | 联系支付宝技术支持了解具体限制。 |
| PROCESS\_FAIL | F | 发生了一般的业务失败。 | 不要重试，通常需要人工干预。建议联系支付宝技术支持解决问题。 |
| MERCHANT\_BALANCE\_NOT\_ENOUGH | F | 商户余额不足。 | 商户有足够的余额后再次调用接口。 |
| UNKNOWN\_EXCEPTION | U | 由于未知原因，API调用失败。 | 重试接口以解决问题。如果未解决，联系支付宝技术支持。 |
| SYSTEM\_ERROR | F | 系统错误。 | 不要重试，联系支付宝技术支持获取更多详情。 |
| USER\_BALANCE\_NOT\_ENOUGH | F | 用户余额不足，无法完成支付。 | 联系支付宝技术支持获取详细原因。 |
| USER\_STATUS\_ABNORMAL | F | 支付方式端的用户状态异常。 |
请联络支付宝技术支持以了解具体原因。  

要查看文档的最新更新，请访问[发行说明](https://global.alipay.com/docs/releasenotes)。  

![图片3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)  

@2024 支付宝 [法律信息](https://global.alipay.com/docs/ac/platform/membership)  

#### 这个页面是否有帮助？