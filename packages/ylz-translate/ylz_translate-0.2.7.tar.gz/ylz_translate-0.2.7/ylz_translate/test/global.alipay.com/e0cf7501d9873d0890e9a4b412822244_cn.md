通知退款 | 产品API | 支付宝文档
==================

[![图片1：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/d66c43c0-440d-4c97-9976-f2028a2c8c5e.svg) ![图片2：中国领先的第三方在线支付解决方案 - 支付宝](https://ac.alipay.com/storage/2024/3/26/a48bd336-aea0-4f16-bf83-616eacbb4434.svg)](/docs/)

[登录](https://global.alipay.com/ilogin/account_login.htm?goto=https%3A%2F%2Fglobal.alipay.com%2Fdocs%2Fac%2Fams%2Fnotify_refund)  
[返回首页](../../)  
产品API  
[支付宝API](/docs/ac/ams/api)  
在线支付  
授权  
安全存储  
支付  
订阅  
争议  
退款  
[在线退款](/docs/ac/ams/refund_online)  
[通知退款](/docs/ac/ams/notify_refund)  
[查询退款](/docs/ac/ams/ir_online)  
声明  
店内支付  

通知退款
==========

2024年5月13日 02:56  
POST /undefined  

当退款处理达到成功或失败的最终状态时，支付宝使用**notifyRefund**将退款结果发送给商家。商家根据退款结果推进商家端的交易处理。

结构
==========

消息由头和体两部分组成。以下部分专注于体的结构。头的结构请参考：

*   [请求头](https://global.alipay.com/docs/ac/ams/api_fund#ML5ur)
*   [响应头](https://global.alipay.com/docs/ac/ams/api_fund#WWH90)

**注意**：除数组外，每个字段的数据类型应设置为字符串。这意味着字段值必须用双引号（" "）括起来。例如：

*   如果字段的数据类型为Integer，值为20，则设置为"20"。
*   如果字段的数据类型为Boolean，值为true，则设置为"true"。
### 请求参数  
显示全部  
#### notifyType 字符串  必填  
退款状态通知的类型。有效值为：  
*   `REFUND_RESULT`: 表示通知是关于退款结果的。  
#### result 结果对象  必填  
退款结果的详细信息，如退款状态、结果代码和结果消息。  
显示子参数  
#### refundStatus 字符串  必填  
表示退款结果。有效值为：  
*   `SUCCESS`: 表示退款成功。
*   `FAIL`: 表示退款失败。  
#### refundRequestId 字符串  必填  
商家为识别退款请求分配的唯一ID。  
关于此字段的更多信息  
*   最大长度：64 个字符  
#### refundId 字符串  必填  
支付宝为识别退款分配的唯一ID。与_paymentId_ 和 _paymentRequestId_ 一对一对应。  
关于此字段的更多信息  
*   最大长度：64 个字符  
#### refundAmount 金额对象  必填  
商家发起的退款金额。  
显示子参数  
#### refundTime 日期时间  
退款成功或失败的最终状态的日期和时间。  
注意：当退款成功（_result.resultStatus_ 的值为 `S`）时，此字段返回。  
#### grossSettlementAmount 金额对象  
退款结算金额，等于退款金额乘以_settlementQuote_ 的值。当交易时预先确定货币兑换且汇率在交易时锁定时，此字段返回。  
显示子参数  
#### settlementQuote 报价对象  
结算货币与交易货币之间的汇率。当_grossSettlementAmount_ 返回时，此字段返回。  
显示子参数
### 响应参数  
显示全部  
#### result 结果对象 **必需**  
一个固定值，用于向支付宝确认已接收到通知。  
显示子参数  
API 探索器
### 请求  
请求体  
复制  
1  
2  
3  
4  
5  
6  
7  
8  
9  
10  
11  
12  
13  
14  
15  
16  
{  
"notifyType": "REFUND\_RESULT",  
"refundAmount": {  
"currency": "HKD",  
"value": "10000"  
},  
"refundId": "2021080419401080130018866020092XXXX",  
"refundRequestId": "amsdemorefund\_zhangyikai\_zyk\_20210804\_165236\_931",  
"refundStatus": "SUCCESS",  
"refundTime": "2021-08-04T01:52:37-07:00",  
"result": {  
"resultCode": "SUCCESS",  
"resultMessage": "成功",  
"resultStatus": "S"  
}  
}  
请注意，以下内容为重复的占位符，实际文档中应为相关数据或说明：  
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
### 响应  
响应体  
复制  
1  
2  
3  
4  
5  
6  
7  
{  
"result": {  
"resultCode": "SUCCESS",  
"resultStatus": "S",  
"resultMessage": "成功"  
}  
}  
请注意，以下内容为模拟填充，实际应替换为真实信息：  
结果处理逻辑  
--------------------
在接收到支付宝的通知后，使用固定值发送以下消息，以确认已收到支付宝的通知：  
示例代码  
复制  
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX  
请根据实际业务逻辑替换上述示例中的“XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX…”内容。
如果由于操作问题或网络问题，支付宝没有收到返回的确认消息，支付宝会重新发送通知，直到商家返回所需的消息。首次通知发送后24小时内，支付宝将进行重试。通知将最多重试8次，重试间隔为0秒、2分钟、10分钟、10分钟、1小时、2小时、6小时和15小时。
### 结果/错误代码  
| 代码 | 值 | 消息 | 进一步操作 |
| --- | --- | --- | --- |
| SUCCESS | S | 成功 | 退款成功，无需进一步操作。 |
| ACCESS\_DENIED | F | 访问被拒绝。 | 联系支付宝技术支持获取详细原因。 |
| INVALID\_API | F | 调用的API无效或未激活。 | 联系支付宝技术支持解决问题。 |
| CLIENT\_INVALID | F | 客户端ID无效。支付宝对客户端ID有限制。 | 检查客户端ID是否正确，或联系支付宝技术支持获取详细原因。 |
| CURRENCY\_NOT\_SUPPORT | F | 货币不受支持。 | 联系支付宝技术支持获取详细原因。 |
| INVALID\_CONTRACT | F | 合同参数值与当前交易不匹配。 | 检查合同中的参数值是否与当前交易匹配。如果匹配，请联系支付宝技术支持排查问题。 |
| INVALID\_MERCHANT\_STATUS | F | 商家状态异常，存在限制。 | 联系支付宝技术支持获取详细原因。 |
| INVALID\_SIGNATURE | F | 签名验证失败。请求签名所用的私钥与Antom Dashboard的公钥不匹配。 | 检查用于签名请求的私钥是否与Antom Dashboard的公钥匹配。参考以下签名信息：  
1.  请求头中的[签名](https://global.alipay.com/docs/ac/ams/api_fund)字段
2.  如何[计算签名](https://global.alipay.com/docs/ac/ams/digital_signature)  
|
| KEY\_NOT\_FOUND | F | 支付宝或商家的私钥或公钥未找到。 | 检查私钥或公钥是否存在。如果不存在，请在Antom Dashboard上传私钥。 |
| MEDIA\_TYPE\_NOT\_ACCEPTABLE | F | 服务器不支持客户端可接受的媒体类型。 | 检查媒体类型是否正确，并使用支付宝接受的媒体类型。  
|
| MERCHANT\_BALANCE\_NOT\_ENOUGH | F | 商户余额不足。 | 等商户余额充足后再次调用接口。重试时需更改\_refundRequestId\_\_字段。  
|
| MERCHANT\_NOT\_REGISTERED | F | 商户未注册。 | 请使用注册接口注册商户。如注册接口调用失败，请联系支付宝技术支持。  
|
| METHOD\_NOT\_SUPPORTED | F | 服务器不支持请求的HTTP方法。仅支持POST方法。 | 确保HTTP方法为POST。  
|
| MULTIPLE\_REFUNDS\_NOT\_SUPPORTED | F | 因合同限制，不支持多次退款。 | 检查是否存在多次退款。不要再调用退款接口。每次退款仅调用一次接口。  
|
| NO\_INTERFACE\_DEF | F | API未定义。 | 检查URL是否正确。请参考API文档中的端点信息。  
|
| ORDER\_IS\_CLOSED | F | 交易已关闭，无法再次支付。 | 使用新的\_paymentRequestId\_\_重新发起退款。  
|
| ORDER\_NOT\_EXIST | F | 订单不存在。 | 检查\_paymentId\_\_是否正确。如果正确，请联系支付宝技术支持了解具体原因。  
|
| ORDER\_STATUS\_INVALID | F | 订单状态无效。交易正在处理或交易失败。 | 检查订单状态并采取相应操作。如果交易正在处理，请等待。交易失败时不要发起退款。请联系支付宝技术支持了解具体原因。
| 参数非法 | F | 缺少必需的参数，或者存在非法参数。例如，非数字输入、无效日期或参数长度和类型错误。 | 检查并确认当前API的必需请求字段（包括头部字段和正文字段）是否正确传递并有效。  
|
| 处理失败 | F | 发生了一般业务错误。 | 不要重试，通常需要人工干预。建议联系支付宝技术支持以解决问题。  
|
| 退款金额超过支付金额 | F | 总退款金额超过了支付金额。 | 确认总退款金额是否超过支付金额。使用小于或等于支付金额的金额创建新的退款，或联系支付宝技术支持。  
|
| 退款时间超出范围 | F | 退款日期超过了合同约定的退款期限。 | 确认退款日期是否超出退款期限。检查合同中的退款期限，或联系支付宝技术支持获取具体的退款期限。  
|
| 重复请求不一致 | F | 金额或币种与先前请求不同。 | 确保所有请求中的字段相同，或使用新的\_paymentRequestId\_\_重新发起退款。  
|
| 风险拒绝 | F | 请求因风险控制被拒绝。 | 提示用户请求被拒绝，因为风险控制失败。  
|
| 系统错误 | F | 发生了系统错误。 | 不要重试，联系支付宝技术支持获取更多详细信息。  
|
| 退款处理中 | U | 退款正在处理中。 | 等待异步通知或调用**查询退款**接口查询最终的退款状态。不要重试退款请求。 |
| 请求流量超过限制 | U | 请求流量超出限制。 | 重新调用接口以解决问题。如果问题未解决，请联系支付宝技术支持。 |
| --- | --- | --- | --- |
| 未知异常 | U | API 调用因未知原因失败。 | 重新调用接口以解决问题。如果问题未解决，请联系支付宝技术支持。 |

要查看文档的最新更新，请访问[发行说明](https://global.alipay.com/docs/releasenotes)。

![图片 3](https://ac.alipay.com/storage/2021/5/20/19b2c126-9442-4f16-8f20-e539b1db482a.png) ![图片 4](https://ac.alipay.com/storage/2021/5/20/e9f3f154-dbf0-455f-89f0-b3d4e0c14481.png)

@2024 支付宝 [法律信息](https://global.alipay.com/docs/ac/platform/membership)

#### 这个页面有帮助吗？