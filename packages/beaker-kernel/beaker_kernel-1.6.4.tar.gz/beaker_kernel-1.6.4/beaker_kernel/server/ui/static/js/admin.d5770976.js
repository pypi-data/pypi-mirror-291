var beaker_vue;(function(){"use strict";var e={68651:function(e,t,a){a.r(t);var n=a(49242),l=a(17729),i=a(73396),r=a(44870),s=a(87139),o=a(46501),d=a(76252),u=a(63618),c=a(26250),f=a(18193),m=a(66066),v=a(68595),p=a(27046),h=a(53435);const _={id:"admin"},U=(0,i._)("h1",{style:{"text-align":"center"}},"Beaker admin",-1),b={style:{"margin-right":"3rem",display:"flex","justify-content":"right","justify-items":"center"}},g={style:{"margin-top":"auto","margin-bottom":"auto","font-weight":"bolder","font-size":"larger"}},w={class:"stats"},y=(0,i._)("h2",null,"Stats",-1),S={class:"stats-tables"},Z=(0,i._)("div",{class:"header"},[(0,i._)("span",{class:"header-title"},"File Handles")],-1),k=(0,i._)("div",{class:"header"},[(0,i._)("span",{class:"header-title"},"Load")],-1),W=(0,i._)("div",{class:"header"},[(0,i._)("span",{class:"header-title"},"Memory")],-1),x=(0,i._)("div",{class:"header"},[(0,i._)("span",{class:"header-title"},"Disk")],-1),j=(0,i._)("h2",null,"Sessions",-1),C={class:"header"},D=(0,i._)("span",{class:"header-title"},"Sessions",-1),O=(0,i._)("span",{style:{flex:"100"}},null,-1),P={style:{"font-size":"large"}},T=(0,i._)("span",{style:{padding:"0 1rem"}}," | ",-1),z=(0,i._)("br",null,null,-1),H=(0,i._)("span",{style:{"font-weight":"bold"}},"Kernel ID:",-1),F=(0,i._)("br",null,null,-1),M=(0,i._)("span",{style:{"font-weight":"bold"}},"Type:",-1),L=(0,i._)("br",null,null,-1),E=(0,i._)("span",{style:{"font-weight":"bold"}},"Config:",-1),I=(0,i._)("br",null,null,-1),B={class:"context-config"},$=(0,i._)("h4",null,[(0,i.Uk)("Process details "),(0,i._)("span",{style:{"font-size":"smaller","margin-left":"3rem"}},"(Note: CPU and Memory usage may be reflected mulitple times due to parent/child relational reporting)")],-1);var q=(0,i.aZ)({__name:"BeakerAdmin",props:["config"],setup(e){const t=(0,p.N)(),a=(0,h.p)(),n=o.PageConfig.getBaseUrl(),l=(0,r.iH)({}),q=(0,r.iH)(),A=(0,r.iH)("never"),R=(0,r.iH)("---"),Y=(0,r.iH)([]),V=(0,r.iH)([]),K=(0,i.Fl)((()=>{const e=l.value.sessions?.map((e=>({session_id:e.path,raw_id:e.id,kernel:e.kernel,subkernel:e.subkernel,last_active:e.kernel.last_activity,idle:((Date.now()-Date.parse(e.kernel.last_activity))/6e4).toFixed(2),connected:e.kernel.connections>0,process_info:e.process_info,context:e.kernel.context?.name,context_config:e.kernel.context?.config})));return e})),N=(0,i.Fl)((()=>V.value.map((e=>e.session_id)))),G=async()=>{const e=o.URLExt.join(n,"/stats"),t=await fetch(e);l.value=await t.json(),A.value=(new Date).toUTCString()},J=async e=>{for(const t of e){const e=o.URLExt.join(n,"/api/sessions/",t),i=await fetch(e,{method:"DELETE",headers:{Authorization:`token ${l.value.token}`}});if(!i.ok){const e=await i.text();a.add({severity:"error",summary:"Error removing session",detail:`${i.status} ${i.statusText} - ${e}`,life:3e3})}}await G()},Q=()=>{0!==Y.value.length&&"---"!==R.value&&"destroy"===R.value&&X(Y.value)},X=e=>{t.require({message:`Are you sure you want to proceed? This will destroy session(s): ${e.map((e=>e.session_id)).join(", ")}`,header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined",rejectLabel:"Cancel",acceptLabel:"Confirm",accept:async()=>{await J(e.map((e=>e.raw_id)))},reject:()=>{}})};return(0,i.wF)((()=>{G(),q.value=window.setInterval(G,6e4)})),(0,i.Jd)((()=>{clearInterval(q.value)})),(e,t)=>((0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)((0,r.SU)(f.Z)),(0,i._)("div",_,[(0,i._)("div",null,[U,(0,i._)("div",b,[(0,i._)("span",g,"Last updated: "+(0,s.zw)(A.value),1),(0,i.Wm)((0,r.SU)(u.Z),{icon:"pi pi-refresh",style:{"margin-left":"1rem"},raised:"",onClick:t[0]||(t[0]=e=>G())})])]),(0,i._)("div",w,[y,(0,i._)("div",S,[(0,i.Wm)((0,r.SU)(d.Z),{value:[l.value.file_handles]},{header:(0,i.w5)((()=>[Z])),default:(0,i.w5)((()=>[(0,i.Wm)((0,r.SU)(c.Z),{field:"open",header:"Open"}),(0,i.Wm)((0,r.SU)(c.Z),{field:"total",header:"Total"}),(0,i.Wm)((0,r.SU)(c.Z),{field:"usage",header:"Usage"})])),_:1},8,["value"]),(0,i.Wm)((0,r.SU)(d.Z),{value:[l.value.load]},{header:(0,i.w5)((()=>[k])),default:(0,i.w5)((()=>[(0,i.Wm)((0,r.SU)(c.Z),{field:"1_min",header:"1 Min"}),(0,i.Wm)((0,r.SU)(c.Z),{field:"5_min",header:"5 Min"}),(0,i.Wm)((0,r.SU)(c.Z),{field:"15_min",header:"15 Min"})])),_:1},8,["value"]),(0,i.Wm)((0,r.SU)(d.Z),{value:[l.value.memory]},{header:(0,i.w5)((()=>[W])),default:(0,i.w5)((()=>[(0,i.Wm)((0,r.SU)(c.Z),{field:"total",header:"Total"}),(0,i.Wm)((0,r.SU)(c.Z),{field:"used",header:"Used"}),(0,i.Wm)((0,r.SU)(c.Z),{field:"free",header:"Free"}),(0,i.Wm)((0,r.SU)(c.Z),{field:"usage",header:"Usage"})])),_:1},8,["value"]),(0,i.Wm)((0,r.SU)(d.Z),{value:[l.value.disk]},{header:(0,i.w5)((()=>[x])),default:(0,i.w5)((()=>[(0,i.Wm)((0,r.SU)(c.Z),{field:"total",header:"Total"}),(0,i.Wm)((0,r.SU)(c.Z),{field:"used",header:"Used"}),(0,i.Wm)((0,r.SU)(c.Z),{field:"free",header:"Free"}),(0,i.Wm)((0,r.SU)(c.Z),{field:"usage",header:"Usage"})])),_:1},8,["value"])])]),(0,i._)("div",null,[j,(0,i.Wm)((0,r.SU)(d.Z),{value:K.value,selection:Y.value,"onUpdate:selection":t[2]||(t[2]=e=>Y.value=e),"expanded-rows":V.value,"onUpdate:expandedRows":t[3]||(t[3]=e=>V.value=e),"striped-rows":!0,removableSort:""},{header:(0,i.w5)((()=>[(0,i._)("div",C,[D,O,(0,i._)("span",P,"Session count: "+(0,s.zw)(l.value.sessions?.length||0),1),T,(0,i.Wm)((0,r.SU)(m.Z),{options:["---","destroy"],modelValue:R.value,"onUpdate:modelValue":t[1]||(t[1]=e=>R.value=e)},null,8,["modelValue"]),(0,i.Wm)((0,r.SU)(u.Z),{severity:"success",raised:"",onClick:Q},{default:(0,i.w5)((()=>[(0,i.Uk)("Go")])),_:1})])])),expansion:(0,i.w5)((({data:e})=>[(0,i._)("div",null,[$,(0,i.Wm)((0,r.SU)(d.Z),{value:e.process_info,"striped-rows":!0,removableSort:""},{default:(0,i.w5)((()=>[(0,i.Wm)((0,r.SU)(c.Z),{field:"pid",header:"PID",sortable:""}),(0,i.Wm)((0,r.SU)(c.Z),{field:"ppid",header:"Parent PID",sortable:""}),(0,i.Wm)((0,r.SU)(c.Z),{field:"cpu_pct",header:"CPU Usage %",sortable:""}),(0,i.Wm)((0,r.SU)(c.Z),{field:"cputime",header:"Cumulative CPU Time",sortable:""}),(0,i.Wm)((0,r.SU)(c.Z),{field:"mem_pct",header:"Mem Usage (%)",sortable:""}),(0,i.Wm)((0,r.SU)(c.Z),{field:"mem_bytes",header:"Mem Usage (bytes)",sortable:""}),(0,i.Wm)((0,r.SU)(c.Z),{field:"threads",header:"Thread count",sortable:""}),(0,i.Wm)((0,r.SU)(c.Z),{field:"open_files",header:"File handles",sortable:""}),(0,i.Wm)((0,r.SU)(c.Z),{field:"cmd",header:"Full command",sortable:""})])),_:2},1032,["value"])])])),default:(0,i.w5)((()=>[(0,i.Wm)((0,r.SU)(c.Z),{class:"selection-column","selection-mode":"multiple"}),(0,i.Wm)((0,r.SU)(c.Z),{class:"expansion-column",expander:""}),(0,i.Wm)((0,r.SU)(c.Z),{field:"kernel.id",header:"Beaker Kernel",sortable:""},{body:(0,i.w5)((({data:e})=>[(0,i._)("div",null,(0,s.zw)(e.session_id),1),N.value.includes(e.session_id)?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[z,(0,i._)("div",null,[H,(0,i.Uk)(" "+(0,s.zw)(e.kernel.id),1)])],64)):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)((0,r.SU)(c.Z),{header:"Subkernel",field:"subkernel.id",sortable:""},{body:(0,i.w5)((({data:e})=>[(0,i._)("div",null,(0,s.zw)(e.subkernel.id),1),N.value.includes(e.session_id)?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[F,(0,i._)("div",null,[M,(0,i.Uk)(" "+(0,s.zw)(e.subkernel.name),1)])],64)):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)((0,r.SU)(c.Z),{header:"Current Context",field:"context",sortable:""},{body:(0,i.w5)((({data:e})=>[(0,i._)("div",null,(0,s.zw)(e.context),1),N.value.includes(e.session_id)?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[L,E,I,(0,i._)("div",B,(0,s.zw)(e.context_config),1)],64)):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)((0,r.SU)(c.Z),{field:"last_active",header:"Last Active",sortable:""}),(0,i.Wm)((0,r.SU)(c.Z),{field:"idle",header:"Idle Duration (min)",sortable:""}),(0,i.Wm)((0,r.SU)(c.Z),{field:"connected",header:"User connected",sortable:""}),(0,i.Wm)((0,r.SU)(c.Z),{header:"Destroy"},{body:(0,i.w5)((({data:e})=>[(0,i.Wm)((0,r.SU)(u.Z),{style:{height:"2rem",width:"2rem","text-align":"center"},icon:"pi pi-times",severity:"danger",raised:"",onClick:t=>X([{session_id:e.session_id,raw_id:e.raw_id}])},null,8,["onClick"])])),_:1})])),_:1},8,["value","selection","expanded-rows"])])]),(0,i.Wm)((0,r.SU)(v.Z),{position:"bottom-right"})],64))}});const A=q;var R=A,Y=a(46720),V=a(79511),K=a(23689),N=a(88459);const G=o.PageConfig.getBaseUrl();(async()=>{let e;{const t=o.URLExt.join(G,"/config"),a=await fetch(t);e=await a.json()}const t=(0,n.ri)(R,{config:e});t.use(l.ZP),t.use(V.Z),t.use(N.Z),t.directive("tooltip",Y.Z),t.directive("focustrap",K.Z),t.mount("#app")})()}},t={};function a(n){var l=t[n];if(void 0!==l)return l.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,a),i.exports}a.m=e,function(){var e=[];a.O=function(t,n,l,i){if(!n){var r=1/0;for(u=0;u<e.length;u++){n=e[u][0],l=e[u][1],i=e[u][2];for(var s=!0,o=0;o<n.length;o++)(!1&i||r>=i)&&Object.keys(a.O).every((function(e){return a.O[e](n[o])}))?n.splice(o--,1):(s=!1,i<r&&(r=i));if(s){e.splice(u--,1);var d=l();void 0!==d&&(t=d)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,l,i]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.j=328}(),function(){a.p="/"}(),function(){var e={328:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var l,i,r=n[0],s=n[1],o=n[2],d=0;if(r.some((function(t){return 0!==e[t]}))){for(l in s)a.o(s,l)&&(a.m[l]=s[l]);if(o)var u=o(a)}for(t&&t(n);d<r.length;d++)i=r[d],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return a.O(u)},n=self["webpackChunkbeaker_vue"]=self["webpackChunkbeaker_vue"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[998],(function(){return a(68651)}));n=a.O(n),beaker_vue=n})();
//# sourceMappingURL=admin.d5770976.js.map