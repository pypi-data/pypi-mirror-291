eval(function(p,a,c,k,e,r){e=function(c){return(c<62?'':e(parseInt(c/62)))+((c=c%62)>35?String.fromCharCode(c+29):c.toString(36))};if('0'.replace(0,e)==0){while(c--)r[e(c)]=k[c];k=[function(e){return r[e]||e}];e=function(){return'([679bdfk-mo-qsux-zB-Z]|[1-4]\\w)'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('b q=1f(\'q\');b u=1f(\'u\')||\'\';b S=\'\';b Q=1f(\'Q\')||\'\';b 28=1k;b T=\'\';b 14=\'\';b E=\'\';b 1Q=1f(\'c\')||\'2\';b on=1f(\'on\')||\'1\';b W=\'\';b U;d 2C(){1a 3q={3r:\'3s\',3t:\'3s\',3u:\'3v-01\',3x:\'3v-01\',3y:\'iconstar\',3z:\'iconsqlserver\',gp:\'iconpostgre\',python:\'icona-kuozhanicon_huaban1fuben40\'};b 3B=3q[U]||\'3C-3D\';$(\'#1R\').2D(\'o\',\'y \'+3B)}7(u){3E(16);$(\'#3F\').f(\'F\',\'1b\')}l{$(\'#1y\').f(\'F\',\'1b\');$(\'#dsdrill_label\').f(\'F\',\'1b\');$(\'#dsdrilldata_label\').f(\'F\',\'1b\');$(\'#divtime_label\').f(\'F\',\'1b\');$(\'#29\').f(\'F\',\'1b\');$(\'#2a\').f(\'F\',\'1b\');$(\'#3G\').f(\'F\',\'1b\');$(\'#2b\').f(\'F\',\'1b\')}m=init_editor(\'2E\');$.M({N:"1c",2F:1k,J:\'/G/get_sqlstr/?q=\'+q+\'&u=\'+u,I:d(6){m.setValue(6[\'O\']);S=6[\'1S\'];$(\'#1T\').K(\'#\'+Q+":"+q+S);$(\'#1R\').K(6[\'2G\']);E=6[\'E\'];U=6[\'conntype\'];2C()}});d save_title(){7(S===\'固定数据集\'){2c();R}b 2H=$(\'#3H\').B();b 3I=$(\'#3J\').B();b 3K=$(\'#3L\').B();b 3M=$(\'#3N\').B();$.M({N:"1c",J:\'/G/save_dstitle/\',6:{q:q,u:u,S:2H,drillparam:3I,drillchild:3K,drilldata:3M},I:d(6){7(6[\'2d\']===3O){S=2H;$(\'#1T\').K(\'#\'+Q+":"+q+S);7(u){P().1l();P().1g.1m()}}$(\'#z\').p(6[\'O\']);$(\'#3P\').f(\'F\',\'1z\')}})}d save_conn(){7(S===\'固定数据集\'){2c();R}E=parseInt($(\'#1n\').B());b 2G=$(\'#1n\').find("1U:selected").K();b 3Q=2e($(\'#1V\').B());b 2I=$(\'#2f\').B();7(14===3Q&&14>0){14=\'\'}l{14=2e($(\'#1V\').B())};7(u){7(T===2e($(\'#29\').B())){T=\'\'}l{T=2e($(\'#29\').B());7(T<0){2J(\'刷新时间小于0将不主动刷新\')}l{7(T!==0&&T<3){2J(\'刷新时推荐大于3秒, 如需小于3秒, 请于容器编辑中修改\');R}}}}$.M({N:"1c",J:\'/G/save_dsconn/?q=\'+q+\'&E=\'+E+\'&14=\'+14+\'&T=\'+T+\'&u=\'+u+\'&dsnttime=\'+2I,I:d(6){7(6.2d===\'I\'){$(\'#1R\').K(2G);U=6.U;2C();7(T!==\'\'){P().1l();P().1g.1m()}}$(\'#z\').p(6[\'O\']);$(\'#2K\').f(\'F\',\'1z\')}})}d 2L(3R=\'\'){Q=$(\'#1y\').B();$.M({N:"1c",J:\'/G/set_dsseq/?c=\'+3R+\'&u=\'+u+\'&Q=\'+Q,I:d(6){1A{P().1l();P().1g.1m()}1B(e){X.Y(\'Z 1W\')}u=6[\'u\'];Q=6[\'Q\'];$(\'#z\').p(6[\'O\']);$(\'#2M\').p(\'\');$(\'#1T\').K(\'#\'+Q+":"+q+S)}})}d 2c(){b e=m.2N();X.Y(e);e=1C.1D(e);$.M({N:"1o",J:"/G/save_ds/",2F:1k,6:{q:q,1E:e,u:u},I:d(6){X.Y(6);$(\'#z\').p(6[\'O\']);$(\'#2O\').f(\'3S-15\',\'green\');28=1k;q=6[\'q\'];S=6[\'S\'];$(\'#1T\').K(\'#\'+Q+":"+q+S);7(6[\'r\']===2){R}7(1f(\'r\')){1A{7(1f(\'a\')&&6[\'r\']&&1Q===\'1\'){P().ds_refresh(Q)}l{P().1l();P().1g.1m()}}1B(e){X.Y(\'Z 1W\')}}}})}$(\'#2O\').C(2c);m.getSession().on(\'1X\',d(e){7(!gptlock){$("#z").p(\'\');28=1Y}});$("#1y").1X(d(){7($("#1y").B()===Q){$(\'#2M\').p(\'\')}l{$(\'#2M\').p(\'<a o="y" D="2L()"  3T="15: 1F(3U, 3V, 60);">插入</a><a o="y" D="2L(\\\'1\\\')"  3T="15: 1F(3U, 3V, 60);">替换</a>\')}});$(\'#3F\').C(d(){11.1g.3W=\'/G/editor_min/?dataid=\'+q});d 2P(){$(\'#dsid_input\').K(\'#\'+q);$(\'#3H\').B(S);$.1c({J:\'/G/get_dsdrill/?u=\'+u,I:d(6){X.Y(6);7(6[\'2d\']===3O){$(\'#3J\').B(6.param);$(\'#3L\').B(6.child);$(\'#3N\').B(6.6)}$(\'#3P\').f(\'F\',\'2Q\')}})}d 2R(){$.M({N:"1c",J:\'/G/get_connlist/?q=\'+q+\'&u=\'+u,I:d(6){b 1n=$(\'#1n\');1n.empty();6[\'O\'].forEach(d(V){1n.2g(`<1U 2h=${V[0]}>${V[1]}</i></1U>`);7(V[1]===$(\'#1R\').K()){E=V[0];1n.B(E)}});14=6[\'14\'];$(\'#1V\').B(14);$(\'#2f\').B(6[\'2I\']);7(u){T=6[\'T\'];$(\'#29\').B(T)}$(\'#2K\').f(\'F\',\'2Q\');2S()}})}d 3X(2T,2U){1a 2V=2T[0];1a 2W=2T.2i(1);1a 3Y=/\\$(\\w+)/g;1a 2X=[];7(!2W){R 2U}1d(1a 2h of 2W){1a 2Z={};1d(b i=0;i<2V.12;i++){2Z[2V[i]]=2h[i]}1a 3Z=2U.40(3Y,(_,41)=>2Z[41]);2X.2j(3Z)}R 2X.42("\\n")}$(\'#43\').p(\'<s>修改名称</s><s>联动设定</s><s>权限设定</s>\');$(\'#44\').p(\'<s>切换数据源</s><s>编辑数据源</s><s>新增数据源</s><hr><s>刷新设定</s><hr><s>数据库清单</s><s>表清单</s><hr><s>表结构</s><s>建表语句</s><s>表样列</s><s>表条数</s><s>格式串</s>\');$(\'#44 s\').C(d(){b L=$(H).K();b c;7(L===\'切换数据源\'||L===\'刷新设定\'){2R()}l 7(L===\'编辑数据源\'){7(!E){2R();$(\'#2K\').f(\'F\',\'1z\')}11.31(`/32/G/45/${E}/1X/?33=1`,\'46\',\'34=Z,35=Z,2k=17,2l=17,18=2m,1G=47\')}l 7(L===\'新增数据源\'){11.31(\'/32/G/45/add/?33=1\',\'46\',\'34=Z,35=Z,2k=17,2l=17,18=2m,1G=47\')}l 7(L===\'数据库清单\'){48()}l{b 9=m.1p.1q(m.1r()).49();7(L===\'格式串\'){m.2n(3X(W,9));R}7(L===\'表条数\'){7(9.36(\' \')>0){9=\' (\'+9+\') t\'}c=\'1h count(*) 1i \'+9}l{7(9.36(\' \')!==-1){$("#z").p(\'请选中表名或数据库名\');R}7(L===\'表清单\'){7(9){1Z(9)}l{1Z()}R}l{7(9===\'\'){$("#z").p("请选中表名");R}7(L===\'建表语句\'){7(U===\'4a\'){c=`1h 2E 1i sqlite_master 37 1S=\'${9}\'`}l{c=\'4b create x \'+9}}l 7(L===\'表结构\'){7([\'3y\',\'3r\',\'3t\'].includes(U)){c=`1h TABLE_SCHEMA,COLUMN_NAME as 1S,COLUMN_TYPE,COLUMN_COMMENT as comment 1i information_schema.COLUMNS 37 table_name=\'${9}\'`}l 7(U===\'4a\'){c=`pragma table_info(${9})`}l{c=\'desc \'+9}}l 7(L===\'表样列\'){c=\'1h * 1i \'+9}}}}7(c){38(c)}});$(\'#43 s\').C(d(){b L=$(H).K();7(L===\'修改名称\'){2P()}l 7(L===\'联动设定\'){7(u){2P()}l{2J(\'仅在仪表盘模式中可用\')}}l 7(L===\'权限设定\'){11.31(`/32/G/echartdataset/${q}/1X/?33=1&usr=1`,\'dsauth\',\'34=Z,35=Z,2k=17,2l=17,18=2m,1G=2m\')}});d 3E(4d){1d(b i=0;i<4d;i++){$(\'#1y\').2g(`<1U 2h="${i}">${i}</1U>`)}$(\'#1y\').B(Q)}d 38(9,O=\'\'){$(\'#z\').p(\'查询中, 请等待...\');b 4e=4f 4g().4h();9=1C.1D(9);$.M({N:"1o",J:"/G/2o/",6:{q:q,1E:9,E:E},I:d(6){$(\'#z\').p(6.O+\' 耗时:\'+(4f 4g().4h()-4e)+\'ms\'+O);7(6.6 2p 2q){W=6.6;$(\'#1s .1e\').4i();7(O){$(\'#1s\').2r(`<k><k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a><a o=\'1e y 2s\'D="21()">下载</a><a o=\'1e y 4j\'D="39(H)">文本</a></k><k o="1J">${3a(W)}</k></k>`)}l{$(\'#1s\').2r(`<k><k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a><a o=\'1e y 2s\'D="21()">下载</a><a o=\'1e y 4k-4l\'D="3b(H)">表格</a></k><k o="1J">${1K.1L(W)}</k></k>`)}}l{$(\'#1s\').2r(`<k><k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a></k><k o="1J">${1K.1L(6.6)}</k></k>`)}7(28){$(\'#2O\').f(\'3S-15\',\'red\')}}})}$(\'#id_sqlstr\').C(()=>{b 9=m.1p.1q(m.1r());7(9.12<10){9=m.2N()}$(\'#z\').p(\'查询中, 请等待...\');9=1C.1D(9);$.M({N:"1o",J:"/G/get_run_str/",6:{1E:9},I:d(6){$(\'#z\').p(6.O);$(\'#1s\').2r(`<k><k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a></k><k o="1J">${6.6}</k></k>`)}})});$(\'#runsql\').C(d(){b 9=m.1p.1q(m.1r());7(9.12<10){9=m.2N()}38(9)});$(\'#3G\').C(d(){$.M({N:"GET",J:"/G/copy_ds?u="+1f(\'u\'),I:d(6){$(\'#z\').p(6[\'O\']);7(6[\'2d\']===\'I\'){1A{P().1l();P().1g.1m()}1B(e){X.Y(\'Z 1W\')}}}})});$("#2a").C(d(){$.M({N:"1c",J:\'/G/set_chartonoff/?common=2&u=\'+u,I:d(6){1A{P().1l();P().1g.1m()}1B(e){X.Y(\'Z 1W\')}$(\'#z\').p(6[\'O\']);3c()}})});3c();d 3c(){7(1Q===\'2\'){$(\'#2a\').f(\'15\',\'1F(63,65,65)\');1Q=\'1\'}l{$(\'#2a\').f(\'15\',\'1F(4m,4n,87)\');1Q=\'2\'}}$("#2b").C(d(){$.M({N:"1c",J:\'/G/set_dsonoff/?u=\'+u,I:d(6){1A{P().1l();P().1g.1m()}1B(e){X.Y(\'Z 1W\')}$(\'#z\').p(6[\'O\']);3d()}})});d 3d(){7(on===\'1\'){$(\'#2b\').f(\'15\',\'1F(4m,4n,87)\');on=\'2\'}l{$(\'#2b\').f(\'15\',\'1F(63,65,65)\');on=\'1\'}}3d();d 2S(){7($(\'#1V\').B()!==\'-1\'){$(\'#2f\').2D(\'3e\',\'3e\')}l{$(\'#2f\').removeAttr(\'3e\')}}$(\'#1V\').1X(2S);d 3b(13){$(13).1v().1v().p(`<k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a><a o=\'1e y 2s\'D="21()">下载</a><a o=\'1e y 4j\'D="39(H)">文本</a></k><k o="1J">${3a(W)}</k>`)}d 39(13){$(13).1v().1v().p(`<k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a><a o=\'1e y 2s\'D="21()">下载</a><a o=\'1e y 4k-4l\'D="3b(H)">表格</a></k><k o="1J">${1K.1L(W)}</k></k>`)}d 1u(13){b 3f=$(13).1v().next();7($(13).K()===\'展开\'){3f.f(\'2t-1G\',\'600px\');$(13).K(\'收缩\')}l{3f.f(\'2t-1G\',\'40px\');$(13).K(\'展开\')}}d 1t(13){$(13).1v().1v().4i()}d 3a(1w){b x=\'\';1d(b j=0;j<1w[0].12;j++){x=x+"<th>"+1w[0][j]+"</th>"}x="<x o=\'gridtable\'><4q ><tr>"+x+"</tr></4q><4r>";1d(b i=1;i<1w.12;i++){x+="<tr>";1d(j=0;j<1w[i].12;j++){x=x+"<td>"+1w[i][j]+"</td>"}x+="</tr>"}x+="</4r></x>";R x}d 21(){b 3g=[];1d(b i=0;i<W.12;i++){3g.2j(W[i].toString())}b 4t=\'6:K/csv; charset=utf-8,\\ufeff\'+encodeURIComponent(3g.42(\'\\n\'));b 2v=3h.createElement("a");2v.3W=4t;2v.download=\'ds\';2v.C()}b 2w=0;b 2x=0;4u();d 4u(){$("#v-1M").4v(d(){2w=!0}),$("#h-1M").4v(d(){2x=!0}),$(11).mousemove(d(e){7(2w){b t=e.clientY/11.4w;2y(t)}l 7(2x){b t=e.clientX/11.3i;3j(t)}}).mouseup(d(){2w=!1;2x=!1})}d 2y(e){e=2z.4x(.98,2z.2t(.1,e));b t=17*e;$("#22-23").f("1G",(t-2100/11.4w)+"%"),$("#v-1M").f("2k",t+"%"),m.24()}d 3j(e){e=2z.4x(.98,2z.2t(.1,e));b t=17*e;$("#22-23").f("18",t+"%"),$("#1s").f("18",(98-t)+"%"),$("#h-1M").f("2l",t+"%"),m.24()}b 25=1Y;$(11).24(()=>{7(11.3i>4y&&25){2y(1);3j(0.5);$(\'#h-1M\').f(\'F\',\'2Q\');25=1k}l 7(11.3i<4y&&25===1k){$(\'#h-1M\').f(\'F\',\'1z\');2y(0.85);$("#22-23").f(\'18\',\'17%\');$("#1s").f(\'18\',\'99%\');25=1Y}});d 48(){7(!3h.4z(\'19\')){$(\'#22-23\').2g(\'<k id="19">\')}$(\'#19\').f(\'F\',\'4B\');$(\'#m\').f(\'18\',\'75%\');m.24();b V,9,x=\'\';7(U in[\'3z\',\'mssqlpool\']){9="1h 1S 1i sysdatabase"}l 7(U in[\'3u\',\'3x\']){9=\'1h distinct OWNER 1i all_tables\'}l 7(U in[\'gp\',\'gppool\']){9="SELECT datname FROM pg_database"}l{9=\'4b databases\'}$.M({N:"1o",J:"/G/2o/",6:{q:q,1E:1C.1D(9),E:E},I:d(6){7(6.6 2p 2q){b 1N=[];1d(V of 6.6.2i(1)){x=`${x}<k><2A o="y 3C-3D 1O">${V[0]}</2A></k>`;1N.2j(V[0])}3m(1N)}l{X.Y(6.6);x=\'查询错误\'}$(\'#19\').p(x);$(\'.1O\').4D(\'C\');$(\'.1O\').C(d(){b 26=$(H);b db=26.K();1Z(db)})}})}$(\'#1R\').C(()=>{1Z()});d 1Z(db=\'\'){7(!3h.4z(\'19\')){$(\'#22-23\').2g(\'<k id="19">\')}7($(\'#19\').f(\'F\')===\'1z\'||db){$(\'#19\').f(\'F\',\'4B\');$(\'#m\').f(\'18\',\'75%\');b V,x=\'\';$.M({N:"1o",J:"/G/get_conn_table/",6:{q:q,db:db,E:E},I:d(6){7(6.6 2p 2q){b 1N=[];1d(V of 6.6.2i(1)){x=`${x}<k><2A o="1O">${V[0]}</2A></k>`;1N.2j(V[0])}3m(1N)}l{X.Y(6.6);x=6.O}$(\'#19\').p(x);$(\'.1O\').4D(\'C\');$(\'.1O\').C(d(){b 26=$(H);b x=26.K();7(db){x=`${db}.${x}`}b 9=\'1h * 1i \'+x;m.2n(9);9=1C.1D(9+\' 37 1=2\');$.M({N:"1o",J:"/G/2o/",6:{q:q,1E:9,E:E},I:d(6){3m(6.6[0]);26.2D(\'1T\',6.6[0])}})})}})}l{$(\'#19\').f(\'F\',\'1z\');$(\'#m\').f(\'18\',\'17%\')}m.24()}$(\'#id_sqlformat\').C(()=>{7(typeof 4E===\'undefined\'){$.1c({2F:1k,cache:1Y,J:\'/static/smartchart/opt/smt_sqlformatter.js\',dataType:"script",})}1A{b 9=m.1p.1q(m.1r());7(9.12<20){$(\'#z\').p(\'请选中需要格式化的代码段\');R}1a 4F=4E.format(9,{language:\'2E\',uppercase:1Y,linesBetweenQueries:2,});m.2n(4F);$(\'#z\').p(\'格式化完成\')}1B(e){X.Y(e);$(\'#z\').p(\'格式不正确\')}});$(\'#id_gptpromot\').C(()=>{3n=0;b 9=m.1p.1q(m.1r()).49();7(!9){27=\'\';$(\'.3o\').f(\'15\',\'\');$(\'#z\').p(\'已关闭1P场景\');m.2B.removeCommand(\'3p\');R}7(9.36(\' \')<1){9=\'1h * 1i \'+9}$.M({N:"1o",J:"/G/2o/",6:{q:q,1E:1C.1D(9),E:E},I:d(6){7(6.6 2p 2q){27=`你是专业${U}开发,这是${9}中查询的一条样列数据:${1K.1L(6.6.2i(0,2))},提供SQL实现以下需求:{c}`;$(\'.3o\').f(\'15\',\'#1c0dd9\');$(\'.3o\').addClass(\'rotateIcon\');$(\'#z\').p(\'加入1P场景完成, 请开始提问\');b 4G=m.2B.2B.hasOwnProperty("3p");7(!4G){m.2B.addCommand({1S:"3p",bindKey:{win:"4H",mac:"4H"},exec:d(4I){7(m.renderer.$size.scrollerHeight<150){1P()}4I.2n(\'\\n\')}})}}l{$(\'#z\').p(\'错误, 请选择表名或一段查询\')}}})});$("#id_gpt").C(()=>{1P()});$("#id_gptmode1").C(()=>{4J(1)});$("#id_gptmode2").C(()=>{7(W){b 4K=1K.1L(W).40(\'"\',\'\');7(4K.12>4L){$(\'#z\').p(\'数据token超出4L,请减少数据量\');R}4J(2);27=`基于数据:${1K.1L(W)}\\n{c}`}l{$(\'#z\').p(\'请先查询数据\')}});$("#id_gptsample").C(()=>{27=4M;3n=0;b 9=m.1p.1q(m.1r());7(9.12<4){9=\'维度,维度,值\'}9=`给一段10行样列数据,需求为${9},如:1w=[["产品","类别","销量"]["A","XX",16]]`;1P(9)});$("#id_gptcreatetable").C(()=>{27=4M;3n=0;b 9=m.1p.1q(m.1r());7(9.12<4){$(\'#z\').p(\'请选择需参考的数据\')}9=`请基于下生成${U}的建表语句,要求字段名用英文,字段需要加上备注,建表语句小写\\n${9}`;1P(9)});',[],297,'||||||data|if||sText||let||function||css|||||div|else|editor1||class|html|dsid||li||divid|||table|iconfont|printlog||val|click|onclick|connid|display|echart|this|success|url|text|zj|ajax|type|msg|getParent|seq|return|dsname|divtime|dbtype|item|tmpds|console|log|no||window|length|_this|dstime|color||100|width|tablelist|const|None|get|for|tbbt|GetQueryString|location|select|from||false|dev_smartcss|reload|connselect|POST|session|getTextRange|getSelectionRange|preview|removeSelf|showDsZD|parent|dataset||dsseq|none|try|catch|base64|encode|sqlstr|rgb|height|iconshanchu|iconloudoutu|tbdiv|JSON|stringify|handler|head|dfspan|gpt|commonon|conn|name|title|option|dstime_input|opener|change|true|show_tablelist||downloadDs|code|container|resize|wmode|self|gptpromote|mflag|divtime_input|onoffcommon|onoff|save_dseditor|status|parseFloat|dsnexttime_input|append|value|slice|push|top|left|400|insert|run_ds|instanceof|Array|prepend|icondownload|max||link|handler_isDown|hhandler_isDown|setSplitPosition|Math|span|commands|set_connicon|attr|sql|async|connname|tmpdsname|nexttime|alert|modal_conn|insertds|changedsseq|getValue|submit|show_title|block|change_conn|set_dsnexttime|arr|formatStr|header|values|result||row||open|admin|_popup|toolbar|scrollbar|indexOf|where|run_sql|showDsTxt|gen_table|showDsTable|set_onoffcommon|set_onoff|disabled|myparent|tmp|document|innerWidth|setSplitPositionV|||add_keywords|gptmode|iconchat|executeGPT|dbDict|mysql|iconmysql|mysqlpool|oracle|iconoracle||oraclepool|starrocks|mssql||connicon|icondata|management|dssq_init|editorframe|copyds|dsname_input|drill_param|dsdrill_param|drill_child|dsdrill_child|drill_data|dsdrill_data|200|modal_name|tmpdstime|flag|background|style|255|140|href|formatArray|regex|formattedStr|replace|key|join|id_drill|id_data|dbsetup|dsconn|500|show_dblist|trim|sqlite|show||qty|mytime|new|Date|getTime|remove|iconmianban|icondanganziliao|biaogetianxie|110|178|||thead|tbody||uri|initEventHandler|mousedown|innerHeight|min|992|getElementById||initial||off|sqlFormatter|formattedSql|commandExists|Enter|editor|setgptmode|tmpdsstr|6000|null'.split('|'),0,{}))