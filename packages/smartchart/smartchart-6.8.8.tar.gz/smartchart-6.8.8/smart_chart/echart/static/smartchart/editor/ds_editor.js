eval(function(p,a,c,k,e,r){e=function(c){return(c<62?'':e(parseInt(c/62)))+((c=c%62)>35?String.fromCharCode(c+29):c.toString(36))};if('0'.replace(0,e)==0){while(c--)r[e(c)]=k[c];k=[function(e){return r[e]||e}];e=function(){return'([679bdfk-mo-qsux-zB-Z]|[1-4]\\w)'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('9 q=1f(\'q\');9 u=1f(\'u\')||\'\';9 S=\'\';9 Q=1f(\'Q\')||\'\';9 27=1i;9 T=\'\';9 14=\'\';9 E=\'\';9 1Q=1f(\'c\')||\'2\';9 on=1f(\'on\')||\'1\';9 V=\'\';9 W;d 2C(){1a 3o={3p:\'3q\',3r:\'3q\',3s:\'3t-01\',3v:\'3t-01\',3w:\'iconstar\',3x:\'iconsqlserver\',gp:\'iconpostgre\',python:\'icona-kuozhanicon_huaban1fuben40\'};9 3z=3o[W]||\'3A-3B\';$(\'#1R\').2D(\'o\',\'y \'+3z)}7(u){3C(16);$(\'#3D\').f(\'F\',\'1b\')}l{$(\'#1y\').f(\'F\',\'1b\');$(\'#dsdrill_label\').f(\'F\',\'1b\');$(\'#dsdrilldata_label\').f(\'F\',\'1b\');$(\'#divtime_label\').f(\'F\',\'1b\');$(\'#28\').f(\'F\',\'1b\');$(\'#29\').f(\'F\',\'1b\');$(\'#3E\').f(\'F\',\'1b\');$(\'#2a\').f(\'F\',\'1b\')}m=init_editor(\'3F\');$.M({N:"1c",2E:1i,J:\'/G/get_sqlstr/?q=\'+q+\'&u=\'+u,I:d(6){m.setValue(6[\'O\']);S=6[\'2b\'];$(\'#1S\').K(\'#\'+Q+":"+q+S);$(\'#1R\').K(6[\'2F\']);E=6[\'E\'];W=6[\'conntype\'];2C()}});d save_title(){7(S===\'固定数据集\'){2c();R}9 2G=$(\'#3G\').B();9 3H=$(\'#3I\').B();9 3J=$(\'#3K\').B();9 3L=$(\'#3M\').B();$.M({N:"1c",J:\'/G/save_dstitle/\',6:{q:q,u:u,S:2G,drillparam:3H,drillchild:3J,drilldata:3L},I:d(6){7(6[\'2d\']===3N){S=2G;$(\'#1S\').K(\'#\'+Q+":"+q+S);7(u){P().1j();P().1g.1k()}}$(\'#z\').p(6[\'O\']);$(\'#3O\').f(\'F\',\'1z\')}})}d save_conn(){7(S===\'固定数据集\'){2c();R}E=parseInt($(\'#1l\').B());9 2F=$(\'#1l\').find("1T:selected").K();9 3P=2e($(\'#1U\').B());9 2H=$(\'#2f\').B();7(14===3P&&14>0){14=\'\'}l{14=2e($(\'#1U\').B())};7(u){7(T===2e($(\'#28\').B())){T=\'\'}l{T=2e($(\'#28\').B());7(T<0){2I(\'刷新时间小于0将不主动刷新\')}l{7(T!==0&&T<3){2I(\'刷新时推荐大于3秒, 如需小于3秒, 请于容器编辑中修改\');R}}}}$.M({N:"1c",J:\'/G/save_dsconn/?q=\'+q+\'&E=\'+E+\'&14=\'+14+\'&T=\'+T+\'&u=\'+u+\'&dsnttime=\'+2H,I:d(6){7(6.2d===\'I\'){$(\'#1R\').K(2F);W=6.W;2C();7(T!==\'\'){P().1j();P().1g.1k()}}$(\'#z\').p(6[\'O\']);$(\'#2J\').f(\'F\',\'1z\')}})}d 2K(3Q=\'\'){Q=$(\'#1y\').B();$.M({N:"1c",J:\'/G/set_dsseq/?c=\'+3Q+\'&u=\'+u+\'&Q=\'+Q,I:d(6){1A{P().1j();P().1g.1k()}1B(e){X.Y(\'Z 1V\')}u=6[\'u\'];Q=6[\'Q\'];$(\'#z\').p(6[\'O\']);$(\'#2L\').p(\'\');$(\'#1S\').K(\'#\'+Q+":"+q+S)}})}d 2c(){9 e=m.2M();X.Y(e);e=1C.1D(e);$.M({N:"1m",J:"/G/save_ds/",2E:1i,6:{q:q,1E:e,u:u},I:d(6){X.Y(6);$(\'#z\').p(6[\'O\']);$(\'#2N\').f(\'3R-15\',\'green\');27=1i;q=6[\'q\'];S=6[\'S\'];$(\'#1S\').K(\'#\'+Q+":"+q+S);7(6[\'r\']===2){R}7(1f(\'r\')){1A{7(1f(\'a\')&&6[\'r\']&&1Q===\'1\'){P().ds_refresh(Q)}l{P().1j();P().1g.1k()}}1B(e){X.Y(\'Z 1V\')}}}})}$(\'#2N\').C(2c);m.getSession().on(\'1W\',d(e){7(!gptlock){$("#z").p(\'\');27=1X}});$("#1y").1W(d(){7($("#1y").B()===Q){$(\'#2L\').p(\'\')}l{$(\'#2L\').p(\'<a o="y" D="2K()"  3S="15: 1F(3T, 3U, 60);">插入</a><a o="y" D="2K(\\\'1\\\')"  3S="15: 1F(3T, 3U, 60);">替换</a>\')}});$(\'#3D\').C(d(){11.1g.3V=\'/G/editor_min/?dataid=\'+q});d 2O(){$(\'#dsid_input\').K(\'#\'+q);$(\'#3G\').B(S);$.1c({J:\'/G/get_dsdrill/?u=\'+u,I:d(6){X.Y(6);7(6[\'2d\']===3N){$(\'#3I\').B(6.param);$(\'#3K\').B(6.child);$(\'#3M\').B(6.6)}$(\'#3O\').f(\'F\',\'2P\')}})}d 2Q(){$.M({N:"1c",J:\'/G/get_connlist/?q=\'+q+\'&u=\'+u,I:d(6){9 1l=$(\'#1l\');1l.empty();6[\'O\'].forEach(d(U){1l.2g(`<1T 2h=${U[0]}>${U[1]}</i></1T>`);7(U[1]===$(\'#1R\').K()){E=U[0];1l.B(E)}});14=6[\'14\'];$(\'#1U\').B(14);$(\'#2f\').B(6[\'2H\']);7(u){T=6[\'T\'];$(\'#28\').B(T)}$(\'#2J\').f(\'F\',\'2P\');2R()}})}d 3W(2S,2T){1a 2U=2S[0];1a 2V=2S.2i(1);1a 3X=/\\$(\\w+)/g;1a 2W=[];7(!2V){R 2T}1d(1a 2h of 2V){1a 2Y={};1d(9 i=0;i<2U.12;i++){2Y[2U[i]]=2h[i]}1a 3Y=2T.3Z(3X,(_,40)=>2Y[40]);2W.2j(3Y)}R 2W.41("\\n")}$(\'#42\').p(\'<s>修改名称</s><s>联动设定</s><s>权限设定</s>\');$(\'#43\').p(\'<s>切换数据源</s><s>编辑数据源</s><s>新增数据源</s><hr><s>刷新设定</s><hr><s>数据库清单</s><s>表清单</s><hr><s>表结构</s><s>建表语句</s><s>表样列</s><s>表条数</s><s>格式串</s>\');$(\'#43 s\').C(d(){9 L=$(H).K();9 c;7(L===\'切换数据源\'||L===\'刷新设定\'){2Q()}l 7(L===\'编辑数据源\'){7(!E){2Q();$(\'#2J\').f(\'F\',\'1z\')}11.30(`/31/G/44/${E}/1W/?32=1`,\'45\',\'33=Z,34=Z,2k=17,2l=17,18=2m,1G=46\')}l 7(L===\'新增数据源\'){11.30(\'/31/G/44/add/?32=1\',\'45\',\'33=Z,34=Z,2k=17,2l=17,18=2m,1G=46\')}l 7(L===\'数据库清单\'){47()}l{9 b=m.1n.1o(m.1p()).48();7(L===\'格式串\'){m.2n(3W(V,b));R}7(L===\'表条数\'){7(b.35(\' \')>0){b=\' (\'+b+\') t\'}c=\'1q count(*) 1r \'+b}l{7(b.35(\' \')!==-1){$("#z").p(\'请选中表名或数据库名\');R}7(L===\'表清单\'){7(b){1Y(b)}l{1Y()}R}l{7(b===\'\'){$("#z").p("请选中表名");R}7(L===\'建表语句\'){c=\'49 create x \'+b}l 7(L===\'表结构\'){7([\'3w\',\'3p\',\'3r\'].includes(W)){c=`1q TABLE_SCHEMA,COLUMN_NAME as 2b,COLUMN_TYPE,COLUMN_COMMENT as comment 1r information_schema.COLUMNS 4b table_name=\'${b}\'`}l{c=\'desc \'+b}}l 7(L===\'表样列\'){c=\'1q * 1r \'+b}}}}7(c){36(c)}});$(\'#42 s\').C(d(){9 L=$(H).K();7(L===\'修改名称\'){2O()}l 7(L===\'联动设定\'){7(u){2O()}l{2I(\'仅在仪表盘模式中可用\')}}l 7(L===\'权限设定\'){11.30(`/31/G/echartdataset/${q}/1W/?32=1&usr=1`,\'dsauth\',\'33=Z,34=Z,2k=17,2l=17,18=2m,1G=2m\')}});d 3C(4c){1d(9 i=0;i<4c;i++){$(\'#1y\').2g(`<1T 2h="${i}">${i}</1T>`)}$(\'#1y\').B(Q)}d 36(b,O=\'\'){$(\'#z\').p(\'查询中, 请等待...\');9 4d=4e 4f().4g();b=1C.1D(b);$.M({N:"1m",J:"/G/2o/",6:{q:q,1E:b,E:E},I:d(6){$(\'#z\').p(6.O+\' 耗时:\'+(4e 4f().4g()-4d)+\'ms\'+O);7(6.6 2p 2q){V=6.6;$(\'#1s .1e\').4h();7(O){$(\'#1s\').2r(`<k><k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a><a o=\'1e y 2s\'D="1Z()">下载</a><a o=\'1e y 4i\'D="37(H)">文本</a></k><k o="1J">${38(V)}</k></k>`)}l{$(\'#1s\').2r(`<k><k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a><a o=\'1e y 2s\'D="1Z()">下载</a><a o=\'1e y 4j-4k\'D="39(H)">表格</a></k><k o="1J">${1K.1L(V)}</k></k>`)}}l{$(\'#1s\').2r(`<k><k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a></k><k o="1J">${1K.1L(6.6)}</k></k>`)}7(27){$(\'#2N\').f(\'3R-15\',\'red\')}}})}$(\'#id_sqlstr\').C(()=>{9 b=m.1n.1o(m.1p());7(b.12<10){b=m.2M()}$(\'#z\').p(\'查询中, 请等待...\');b=1C.1D(b);$.M({N:"1m",J:"/G/get_run_str/",6:{1E:b},I:d(6){$(\'#z\').p(6.O);$(\'#1s\').2r(`<k><k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a></k><k o="1J">${6.6}</k></k>`)}})});$(\'#runsql\').C(d(){9 b=m.1n.1o(m.1p());7(b.12<10){b=m.2M()}36(b)});$(\'#3E\').C(d(){$.M({N:"GET",J:"/G/copy_ds?u="+1f(\'u\'),I:d(6){$(\'#z\').p(6[\'O\']);7(6[\'2d\']===\'I\'){1A{P().1j();P().1g.1k()}1B(e){X.Y(\'Z 1V\')}}}})});$("#29").C(d(){$.M({N:"1c",J:\'/G/set_chartonoff/?common=2&u=\'+u,I:d(6){1A{P().1j();P().1g.1k()}1B(e){X.Y(\'Z 1V\')}$(\'#z\').p(6[\'O\']);3a()}})});3a();d 3a(){7(1Q===\'2\'){$(\'#29\').f(\'15\',\'1F(63,65,65)\');1Q=\'1\'}l{$(\'#29\').f(\'15\',\'1F(4l,4m,87)\');1Q=\'2\'}}$("#2a").C(d(){$.M({N:"1c",J:\'/G/set_dsonoff/?u=\'+u,I:d(6){1A{P().1j();P().1g.1k()}1B(e){X.Y(\'Z 1V\')}$(\'#z\').p(6[\'O\']);3b()}})});d 3b(){7(on===\'1\'){$(\'#2a\').f(\'15\',\'1F(4l,4m,87)\');on=\'2\'}l{$(\'#2a\').f(\'15\',\'1F(63,65,65)\');on=\'1\'}}3b();d 2R(){7($(\'#1U\').B()!==\'-1\'){$(\'#2f\').2D(\'3c\',\'3c\')}l{$(\'#2f\').removeAttr(\'3c\')}}$(\'#1U\').1W(2R);d 39(13){$(13).1v().1v().p(`<k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a><a o=\'1e y 2s\'D="1Z()">下载</a><a o=\'1e y 4i\'D="37(H)">文本</a></k><k o="1J">${38(V)}</k>`)}d 37(13){$(13).1v().1v().p(`<k><a o="y 1H"D="1t(H)">删除</a><a o="y 1I"D="1u(H)">收缩</a><a o=\'1e y 2s\'D="1Z()">下载</a><a o=\'1e y 4j-4k\'D="39(H)">表格</a></k><k o="1J">${1K.1L(V)}</k></k>`)}d 1u(13){9 3d=$(13).1v().next();7($(13).K()===\'展开\'){3d.f(\'2t-1G\',\'600px\');$(13).K(\'收缩\')}l{3d.f(\'2t-1G\',\'40px\');$(13).K(\'展开\')}}d 1t(13){$(13).1v().1v().4h()}d 38(1w){9 x=\'\';1d(9 j=0;j<1w[0].12;j++){x=x+"<th>"+1w[0][j]+"</th>"}x="<x o=\'gridtable\'><4p ><tr>"+x+"</tr></4p><4q>";1d(9 i=1;i<1w.12;i++){x+="<tr>";1d(j=0;j<1w[i].12;j++){x=x+"<td>"+1w[i][j]+"</td>"}x+="</tr>"}x+="</4q></x>";R x}d 1Z(){9 3e=[];1d(9 i=0;i<V.12;i++){3e.2j(V[i].toString())}9 4s=\'6:K/csv; charset=utf-8,\\ufeff\'+encodeURIComponent(3e.41(\'\\n\'));9 2v=3f.createElement("a");2v.3V=4s;2v.download=\'ds\';2v.C()}9 2w=0;9 2x=0;4t();d 4t(){$("#v-1M").4u(d(){2w=!0}),$("#h-1M").4u(d(){2x=!0}),$(11).mousemove(d(e){7(2w){9 t=e.clientY/11.4v;2y(t)}l 7(2x){9 t=e.clientX/11.3g;3h(t)}}).mouseup(d(){2w=!1;2x=!1})}d 2y(e){e=2z.4w(.98,2z.2t(.1,e));9 t=17*e;$("#21-22").f("1G",(t-2100/11.4v)+"%"),$("#v-1M").f("2k",t+"%"),m.23()}d 3h(e){e=2z.4w(.98,2z.2t(.1,e));9 t=17*e;$("#21-22").f("18",t+"%"),$("#1s").f("18",(98-t)+"%"),$("#h-1M").f("2l",t+"%"),m.23()}9 24=1X;$(11).23(()=>{7(11.3g>4x&&24){2y(1);3h(0.5);$(\'#h-1M\').f(\'F\',\'2P\');24=1i}l 7(11.3g<4x&&24===1i){$(\'#h-1M\').f(\'F\',\'1z\');2y(0.85);$("#21-22").f(\'18\',\'17%\');$("#1s").f(\'18\',\'99%\');24=1X}});d 47(){7(!3f.4y(\'19\')){$(\'#21-22\').2g(\'<k id="19">\')}$(\'#19\').f(\'F\',\'4A\');$(\'#m\').f(\'18\',\'75%\');m.23();9 U,b,x=\'\';7(W in[\'3x\',\'mssqlpool\']){b="1q 2b 1r sysdatabase"}l 7(W in[\'3s\',\'3v\']){b=\'1q distinct OWNER 1r all_tables\'}l 7(W in[\'gp\',\'gppool\']){b="SELECT datname FROM pg_database"}l{b=\'49 databases\'}$.M({N:"1m",J:"/G/2o/",6:{q:q,1E:1C.1D(b),E:E},I:d(6){7(6.6 2p 2q){9 1N=[];1d(U of 6.6.2i(1)){x=`${x}<k><2A o="y 3A-3B 1O">${U[0]}</2A></k>`;1N.2j(U[0])}3k(1N)}l{X.Y(6.6);x=\'查询错误\'}$(\'#19\').p(x);$(\'.1O\').4C(\'C\');$(\'.1O\').C(d(){9 25=$(H);9 db=25.K();1Y(db)})}})}$(\'#1R\').C(()=>{1Y()});d 1Y(db=\'\'){7(!3f.4y(\'19\')){$(\'#21-22\').2g(\'<k id="19">\')}7($(\'#19\').f(\'F\')===\'1z\'||db){$(\'#19\').f(\'F\',\'4A\');$(\'#m\').f(\'18\',\'75%\');9 U,x=\'\';$.M({N:"1m",J:"/G/get_conn_table/",6:{q:q,db:db,E:E},I:d(6){7(6.6 2p 2q){9 1N=[];1d(U of 6.6.2i(1)){x=`${x}<k><2A o="1O">${U[0]}</2A></k>`;1N.2j(U[0])}3k(1N)}l{X.Y(6.6);x=6.O}$(\'#19\').p(x);$(\'.1O\').4C(\'C\');$(\'.1O\').C(d(){9 25=$(H);9 x=25.K();7(db){x=`${db}.${x}`}9 b=\'1q * 1r \'+x;m.2n(b);b=1C.1D(b+\' 4b 1=2\');$.M({N:"1m",J:"/G/2o/",6:{q:q,1E:b,E:E},I:d(6){3k(6.6[0]);25.2D(\'1S\',6.6[0])}})})}})}l{$(\'#19\').f(\'F\',\'1z\');$(\'#m\').f(\'18\',\'17%\')}m.23()}$(\'#id_sqlformat\').C(()=>{7(typeof 4D===\'undefined\'){$.1c({2E:1i,cache:1X,J:\'/static/smartchart/opt/smt_sqlformatter.js\',dataType:"script",})}1A{9 b=m.1n.1o(m.1p());7(b.12<20){$(\'#z\').p(\'请选中需要格式化的代码段\');R}1a 4E=4D.format(b,{language:\'3F\',uppercase:1X,linesBetweenQueries:2,});m.2n(4E);$(\'#z\').p(\'格式化完成\')}1B(e){X.Y(e);$(\'#z\').p(\'格式不正确\')}});$(\'#id_gptpromot\').C(()=>{3l=0;9 b=m.1n.1o(m.1p()).48();7(!b){26=\'\';$(\'.3m\').f(\'15\',\'\');$(\'#z\').p(\'已关闭1P场景\');m.2B.removeCommand(\'3n\');R}7(b.35(\' \')<1){b=\'1q * 1r \'+b}$.M({N:"1m",J:"/G/2o/",6:{q:q,1E:1C.1D(b),E:E},I:d(6){7(6.6 2p 2q){26=`你是专业${W}开发,这是${b}中查询的一条样列数据:${1K.1L(6.6.2i(0,2))},提供SQL实现以下需求:{c}`;$(\'.3m\').f(\'15\',\'#1c0dd9\');$(\'.3m\').addClass(\'rotateIcon\');$(\'#z\').p(\'加入1P场景完成, 请开始提问\');9 4F=m.2B.2B.hasOwnProperty("3n");7(!4F){m.2B.addCommand({2b:"3n",bindKey:{win:"4G",mac:"4G"},exec:d(4H){7(m.renderer.$size.scrollerHeight<150){1P()}4H.2n(\'\\n\')}})}}l{$(\'#z\').p(\'错误, 请选择表名或一段查询\')}}})});$("#id_gpt").C(()=>{1P()});$("#id_gptmode1").C(()=>{4I(1)});$("#id_gptmode2").C(()=>{7(V){9 4J=1K.1L(V).3Z(\'"\',\'\');7(4J.12>4K){$(\'#z\').p(\'数据token超出4K,请减少数据量\');R}4I(2);26=`基于数据:${1K.1L(V)}\\n{c}`}l{$(\'#z\').p(\'请先查询数据\')}});$("#id_gptsample").C(()=>{26=4L;3l=0;9 b=m.1n.1o(m.1p());7(b.12<4){b=\'维度,维度,值\'}b=`给一段10行样列数据,需求为${b},如:1w=[["产品","类别","销量"]["A","XX",16]]`;1P(b)});$("#id_gptcreatetable").C(()=>{26=4L;3l=0;9 b=m.1n.1o(m.1p());7(b.12<4){$(\'#z\').p(\'请选择需参考的数据\')}b=`请基于下生成${W}的建表语句,要求字段名用英文,字段需要加上备注,建表语句小写\\n${b}`;1P(b)});',[],296,'||||||data|if||let||sText||function||css|||||div|else|editor1||class|html|dsid||li||divid|||table|iconfont|printlog||val|click|onclick|connid|display|echart|this|success|url|text|zj|ajax|type|msg|getParent|seq|return|dsname|divtime|item|tmpds|dbtype|console|log|no||window|length|_this|dstime|color||100|width|tablelist|const|None|get|for|tbbt|GetQueryString|location||false|dev_smartcss|reload|connselect|POST|session|getTextRange|getSelectionRange|select|from|preview|removeSelf|showDsZD|parent|dataset||dsseq|none|try|catch|base64|encode|sqlstr|rgb|height|iconshanchu|iconloudoutu|tbdiv|JSON|stringify|handler|head|dfspan|gpt|commonon|conn|title|option|dstime_input|opener|change|true|show_tablelist|downloadDs||code|container|resize|wmode|self|gptpromote|mflag|divtime_input|onoffcommon|onoff|name|save_dseditor|status|parseFloat|dsnexttime_input|append|value|slice|push|top|left|400|insert|run_ds|instanceof|Array|prepend|icondownload|max||link|handler_isDown|hhandler_isDown|setSplitPosition|Math|span|commands|set_connicon|attr|async|connname|tmpdsname|nexttime|alert|modal_conn|insertds|changedsseq|getValue|submit|show_title|block|change_conn|set_dsnexttime|arr|formatStr|header|values|result||row||open|admin|_popup|toolbar|scrollbar|indexOf|run_sql|showDsTxt|gen_table|showDsTable|set_onoffcommon|set_onoff|disabled|myparent|tmp|document|innerWidth|setSplitPositionV|||add_keywords|gptmode|iconchat|executeGPT|dbDict|mysql|iconmysql|mysqlpool|oracle|iconoracle||oraclepool|starrocks|mssql||connicon|icondata|management|dssq_init|editorframe|copyds|sql|dsname_input|drill_param|dsdrill_param|drill_child|dsdrill_child|drill_data|dsdrill_data|200|modal_name|tmpdstime|flag|background|style|255|140|href|formatArray|regex|formattedStr|replace|key|join|id_drill|id_data|dbsetup|dsconn|500|show_dblist|trim|show||where|qty|mytime|new|Date|getTime|remove|iconmianban|icondanganziliao|biaogetianxie|110|178|||thead|tbody||uri|initEventHandler|mousedown|innerHeight|min|992|getElementById||initial||off|sqlFormatter|formattedSql|commandExists|Enter|editor|setgptmode|tmpdsstr|6000|null'.split('|'),0,{}))