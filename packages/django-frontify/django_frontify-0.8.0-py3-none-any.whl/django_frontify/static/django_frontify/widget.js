(()=>{"use strict";var e,n;e=function(e,n,t,r){return new(t||(t=Promise))((function(o,i){function l(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,a)}c((r=r.apply(e,n||[])).next())}))},n=function(e,n){var t,r,o,i,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(l=0)),l;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,r=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!((o=(o=l.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){l.label=a[1];break}if(6===a[0]&&l.label<o[1]){l.label=o[1],o=a;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(a);break}o[2]&&l.ops.pop(),l.trys.pop();continue}a=n.call(e,l)}catch(e){a=[6,e],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},window.addEventListener("load",(function(){for(var t="frontify-image-field--selected",r=document.querySelectorAll(".frontify-image-field"),o=function(o){var i=r[o],l=i.getAttribute("data-id"),a=i.getAttribute("data-domain"),c=i.getAttribute("data-client-id"),s=i.querySelector(".frontify-button"),u=i.querySelector(".frontify-preview__image"),f=i.querySelector(".frontify-preview__name"),d=i.querySelector("#"+l),y=i.querySelector(".frontify-remove-selection"),p=i.getAttribute("data-finder-version"),v=function(){return e(void 0,void 0,void 0,(function(){return n(this,(function(e){switch(p){case"1":g();break;case"2":m();break;default:alert("Invalid Finder version specified in DJANGO_FRONTIFY_FINDER_VERSION")}return[2]}))}))},g=function(){FrontifyFinder.open({domain:a,success:function(e){var n=e[0];console.log(n),i.classList.add(t),u.src=n.generic_url.split("?")[0]+"?height=36",f.innerHTML=n.name||n.title,d.innerHTML=JSON.stringify(n,null,4)},cancel:function(){console.log("Selection cancelled!")},error:function(e){if(console.log("Error:",e),"ERR_FINDER_MESSAGE"===e.code){var n=JSON.parse(e.message);4===n.readyState&&n.responseJSON.error.includes("Access token expired")&&(console.warn("Access Token expired"),console.log(localStorage.getItem("FrontifyFinder_token")),localStorage.getItem("FrontifyFinder_token")&&(console.log("Token found. Clear token and start finder again."),FrontifyFinder.close(),localStorage.removeItem("FrontifyFinder_token"),v()))}},warning:function(e){console.log("Warning:",e),"WARN_AUTH_OPTIONS"===e.code&&(console.log("WARN_AUTH_OPTIONS ..."),localStorage.getItem("FrontifyFinder_token")&&(console.log("Token found. Clear token and start finder again."),FrontifyFinder.close(),localStorage.removeItem("FrontifyFinder_token"),v()))},settings:{multiSelect:!1,filters:[{key:"object_type",values:["IMAGE"],inverted:!1},{key:"ext",values:["eps","ai"],inverted:!0}],popup:{title:"My Company's Frontify Assets",size:{width:600,height:400},position:{x:50,y:50}}}})},m=function(){return e(void 0,void 0,void 0,(function(){var e,r;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,window.FrontifyFinder.create({clientId:c,domain:a,options:{allowMultiSelect:!1,permanentDownloadUrls:!0}})];case 1:return(e=n.sent()).onAssetsChosen((function(n){var r=n[0];i.classList.add(t),u.src=r.previewUrl.split("?")[0]+"?height=36",f.innerHTML=r.name||r.title,d.innerHTML=JSON.stringify(r,null,4),e.close(),i.parentElement.classList.remove("frontify-modal-open")})),e.onCancel((function(){e.close(),i.parentElement.classList.remove("frontify-modal-open")})),e.mount(i.parentElement.querySelector(".frontify-modal")),i.parentElement.classList.add("frontify-modal-open"),[3,3];case 2:return r=n.sent(),console.log(r),[3,3];case 3:return[2]}}))}))};y.addEventListener("click",(function(e){e.preventDefault(),i.classList.remove(t),u.src="",f.innerHTML="",d.innerHTML=""})),s.addEventListener("click",(function(e){e.preventDefault(),v()}))},i=0;i<r.length;i++)o(i)}))})();